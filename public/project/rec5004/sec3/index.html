<!DOCTYPE html>
<!-- This site was created with Wowchemy. https://www.wowchemy.com -->
<!-- Last Published: July 24, 2023 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.7.0 for Hugo" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css" integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.0f229d4b7ebad1917a9a357cba2effab.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  


























  
  
  






  <meta name="author" content="Fábio Nishida" />





  

<meta name="description" content="It covers topics such as data manipulation, apply functions, etc. Also provides an introduction to the dplyr package and its functions for column manipulation (select, rename, mutate), row manipulation (filter, arrange), and grouping of rows (summarize). The page also includes examples of using these functions with the Star Wars dataset. Additionally, the page discusses the use of the pipe operator (%&gt;%) and join functions for merging data frames." />



<link rel="alternate" hreflang="en-us" href="https://fhnishida.netlify.app/project/rec5004/sec3/" />
<link rel="canonical" href="https://fhnishida.netlify.app/project/rec5004/sec3/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#1565c0" />










  
  






<meta property="twitter:card" content="summary" />

  <meta property="twitter:site" content="@wowchemy" />
  <meta property="twitter:creator" content="@wowchemy" />
<meta property="twitter:image" content="https://fhnishida.netlify.app/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_512x512_fill_lanczos_center_3.png" />
<meta property="og:site_name" content="Fábio Nishida" />
<meta property="og:url" content="https://fhnishida.netlify.app/project/rec5004/sec3/" />
<meta property="og:title" content="Data Manipulation | Fábio Nishida" />
<meta property="og:description" content="It covers topics such as data manipulation, apply functions, etc. Also provides an introduction to the dplyr package and its functions for column manipulation (select, rename, mutate), row manipulation (filter, arrange), and grouping of rows (summarize). The page also includes examples of using these functions with the Star Wars dataset. Additionally, the page discusses the use of the pipe operator (%&gt;%) and join functions for merging data frames." /><meta property="og:image" content="https://fhnishida.netlify.app/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />

  
    <meta property="og:updated_time" content="2018-09-09T00:00:00&#43;00:00" />
  










  
  
  

  
  
    <link rel="alternate" href="/project/rec5004/sec3/index.xml" type="application/rss+xml" title="Fábio Nishida" />
  

  


  
  <title>Data Manipulation | Fábio Nishida</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="db4fdb7340c6e26622e1762f8d2f668b" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Fábio Nishida</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Fábio Nishida</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Teaching Assistance</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#featured"><span>Publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="/#contact"  aria-label="envelope">
                <i class="fas fa-envelope" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
        
          Main
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      <ul class="nav docs-sidenav">
        <li><a href="/project/"><i class="fas fa-arrow-left pr-1"></i>Projects</a></li>
      </ul>

      
      
        
          
        
      


  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/"><i class="fas fa-book pr-1"></i>Main</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/project/rec5004/">----------------------</a></li>



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec1/">R Toolkit</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec2/">Programming</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link  active" href="/project/rec5004/sec3/">Manipulation</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec4/">Visualization</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec5/">Distributions</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec6/">Simple Regression</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec7/">Optimization</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec8/">Multiple Regression</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec9/">Hypothesis Testing</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec10/">GLS/WLS/FGLS</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec11/">IV/2SLS</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec12/">----------------</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec13/">Panel Data</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec5004/sec14/">Manipulation</a>
    

    
      </div>
    

      
        </ul>
      
    

    
      </div>
    

    
  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      












      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#pacote-base">Pacote <code>base</code></a>
      <ul>
        <li><a href="#resumo-dos-dados">Resumo dos dados</a></li>
        <li><a href="#filtro-de-linhas">Filtro de linhas</a></li>
        <li><a href="#ordenação-de-linhas">Ordenação de linhas</a></li>
        <li><a href="#seleção-de-colunas">Seleção de colunas</a></li>
        <li><a href="#renomeação-de-colunas">Renomeação de colunas</a></li>
        <li><a href="#modificação-de-colunas">Modificação de colunas</a></li>
        <li><a href="#junção-de-bases">Junção de bases</a></li>
      </ul>
    </li>
    <li><a href="#pacote-dplyr">Pacote <code>dplyr</code></a>
      <ul>
        <li><a href="#filtro-via-filter">Filtro via <code>filter()</code></a></li>
        <li><a href="#ordenação-via-arrange">Ordenação via <code>arrange()</code></a></li>
        <li><a href="#seleção-via-select">Seleção via <code>select()</code></a></li>
        <li><a href="#renomeação-via-rename">Renomeação via <code>rename()</code></a></li>
        <li><a href="#modificação-via-mutate">Modificação via <code>mutate()</code></a></li>
        <li><a href="#operador-pipe-">Operador Pipe <code>%&gt;%</code></a></li>
        <li><a href="#resumo-via-summarise">Resumo via <code>summarise()</code></a></li>
        <li><a href="#agrupamento-via-group_by">Agrupamento via <code>group_by()</code></a></li>
        <li><a href="#resumo-por-grupo-via-group_by-e-summarise">Resumo por grupo via <code>group_by()</code> e <code>summarise()</code></a></li>
        <li><a href="#junção-via-__join_">Junção via <em>_join()</em></a></li>
      </ul>
    </li>
  </ul>
</nav>

      











    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <div class="docs-article-container">
        
      </div>

      
      
      

      <div class="docs-article-container">
        
        <h1>Data Manipulation</h1>

        <article class="article-style">

          
          

          <blockquote>
<p>“Between 30% to 80% of the data analysis task is spent on cleaning and understanding the data.” (Dasu &amp; Johnson, 2003)</p>
</blockquote>
<p>Para esta seção, usaremos a base de dados <code>starwars</code> do pacote de manipulação de dados <code>dplyr</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Vamos chamar a base de dados starwars de sw</span>
</span></span><span class="line"><span class="cl"><span class="n">sw</span> <span class="o">=</span> <span class="n">starwars</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># vamos retirar as últimas 3 colunas para facilitar a manipulação.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># São colunas da classe list</span>
</span></span><span class="line"><span class="cl"><span class="n">sw[</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;films&#34;</span><span class="p">,</span> <span class="s">&#34;vehicles&#34;</span><span class="p">,</span> <span class="s">&#34;starships&#34;</span><span class="p">)</span><span class="n">]</span> <span class="o">=</span> <span class="kc">NULL</span>
</span></span></code></pre></div></br>
<h2 id="pacote-base">Pacote <code>base</code></h2>
<ul>
<li>Nesta seção, vamos manipular bases de dados usando as funções pré-carregadas no R (pacote <code>base</code>)</li>
</ul>
<h3 id="resumo-dos-dados">Resumo dos dados</h3>
<h4 id="funções-básicas">Funções básicas</h4>
<ul>
<li><a href="https://www.coursera.org/learn/data-cleaning/lecture/e5qVi/summarizing-data" target="_blank" rel="noopener">Summarizing data (John Hopkins/Coursera)</a></li>
<li>Verificaremos:
<ul>
<li>as <strong>dimensões</strong> da base via <code>dim()</code></li>
<li>as 6 <strong>primeiras</strong> linhas da base via <code>head()</code></li>
<li>as 6 <strong>últimas</strong> linhas da base via <code>tail()</code></li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">dim</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span> <span class="c1"># Verificar tamanho da base (linhas x colunas)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 87 11
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span> <span class="c1"># Visualizando as 6 primeiras linhas</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 11
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">## 2 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
</span></span><span class="line"><span class="cl">## 3 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
</span></span><span class="line"><span class="cl">## 4 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
</span></span><span class="line"><span class="cl">## 5 Leia Org…    150    49 brown      light      brown           19   fema… femin…
</span></span><span class="line"><span class="cl">## 6 Owen Lars    178   120 brown, gr… light      blue            52   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">tail</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span> <span class="c1"># Visualizando as 6 últimas linhas</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 11
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Finn          NA    NA black      dark       dark              NA male  mascu…
</span></span><span class="line"><span class="cl">## 2 Rey           NA    NA brown      light      hazel             NA fema… femin…
</span></span><span class="line"><span class="cl">## 3 Poe Dame…     NA    NA brown      light      brown             NA male  mascu…
</span></span><span class="line"><span class="cl">## 4 BB8           NA    NA none       none       black             NA none  mascu…
</span></span><span class="line"><span class="cl">## 5 Captain …     NA    NA unknown    unknown    unknown           NA &lt;NA&gt;  &lt;NA&gt;  
</span></span><span class="line"><span class="cl">## 6 Padmé Am…    165    45 brown      light      brown             46 fema… femin…
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><ul>
<li>Usando <code>str()</code>, podemos visualizar a <strong>estrutura</strong> (<em>structure</em>) da base:
<ul>
<li>todas a variáveis (colunas),</li>
<li>a classe de cada uma delas e</li>
<li>algumas de suas observações.</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">str</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## tibble [87 × 11] (S3: tbl_df/tbl/data.frame)
</span></span><span class="line"><span class="cl">##  $ name      : chr [1:87] &#34;Luke Skywalker&#34; &#34;C-3PO&#34; &#34;R2-D2&#34; &#34;Darth Vader&#34; ...
</span></span><span class="line"><span class="cl">##  $ height    : int [1:87] 172 167 96 202 150 178 165 97 183 182 ...
</span></span><span class="line"><span class="cl">##  $ mass      : num [1:87] 77 75 32 136 49 120 75 32 84 77 ...
</span></span><span class="line"><span class="cl">##  $ hair_color: chr [1:87] &#34;blond&#34; NA NA &#34;none&#34; ...
</span></span><span class="line"><span class="cl">##  $ skin_color: chr [1:87] &#34;fair&#34; &#34;gold&#34; &#34;white, blue&#34; &#34;white&#34; ...
</span></span><span class="line"><span class="cl">##  $ eye_color : chr [1:87] &#34;blue&#34; &#34;yellow&#34; &#34;red&#34; &#34;yellow&#34; ...
</span></span><span class="line"><span class="cl">##  $ birth_year: num [1:87] 19 112 33 41.9 19 52 47 NA 24 57 ...
</span></span><span class="line"><span class="cl">##  $ sex       : chr [1:87] &#34;male&#34; &#34;none&#34; &#34;none&#34; &#34;male&#34; ...
</span></span><span class="line"><span class="cl">##  $ gender    : chr [1:87] &#34;masculine&#34; &#34;masculine&#34; &#34;masculine&#34; &#34;masculine&#34; ...
</span></span><span class="line"><span class="cl">##  $ homeworld : chr [1:87] &#34;Tatooine&#34; &#34;Tatooine&#34; &#34;Naboo&#34; &#34;Tatooine&#34; ...
</span></span><span class="line"><span class="cl">##  $ species   : chr [1:87] &#34;Human&#34; &#34;Droid&#34; &#34;Droid&#34; &#34;Human&#34; ...
</span></span></code></pre></div><ul>
<li>Para fazer um <strong>resumo</strong> de todas as variáveis da base, podemos usar a função <code>summary()</code> que, para variáveis numéricas, calcula a média e os quartis, e mostra a quantidade de <code>NA</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##      name               height           mass          hair_color       
</span></span><span class="line"><span class="cl">##  Length:87          Min.   : 66.0   Min.   :  15.00   Length:87         
</span></span><span class="line"><span class="cl">##  Class :character   1st Qu.:167.0   1st Qu.:  55.60   Class :character  
</span></span><span class="line"><span class="cl">##  Mode  :character   Median :180.0   Median :  79.00   Mode  :character  
</span></span><span class="line"><span class="cl">##                     Mean   :174.4   Mean   :  97.31                     
</span></span><span class="line"><span class="cl">##                     3rd Qu.:191.0   3rd Qu.:  84.50                     
</span></span><span class="line"><span class="cl">##                     Max.   :264.0   Max.   :1358.00                     
</span></span><span class="line"><span class="cl">##                     NA&#39;s   :6       NA&#39;s   :28                          
</span></span><span class="line"><span class="cl">##   skin_color         eye_color           birth_year         sex           
</span></span><span class="line"><span class="cl">##  Length:87          Length:87          Min.   :  8.00   Length:87         
</span></span><span class="line"><span class="cl">##  Class :character   Class :character   1st Qu.: 35.00   Class :character  
</span></span><span class="line"><span class="cl">##  Mode  :character   Mode  :character   Median : 52.00   Mode  :character  
</span></span><span class="line"><span class="cl">##                                        Mean   : 87.57                     
</span></span><span class="line"><span class="cl">##                                        3rd Qu.: 72.00                     
</span></span><span class="line"><span class="cl">##                                        Max.   :896.00                     
</span></span><span class="line"><span class="cl">##                                        NA&#39;s   :44                         
</span></span><span class="line"><span class="cl">##     gender           homeworld           species         
</span></span><span class="line"><span class="cl">##  Length:87          Length:87          Length:87         
</span></span><span class="line"><span class="cl">##  Class :character   Class :character   Class :character  
</span></span><span class="line"><span class="cl">##  Mode  :character   Mode  :character   Mode  :character  
</span></span><span class="line"><span class="cl">##                                                          
</span></span><span class="line"><span class="cl">##                                                          
</span></span><span class="line"><span class="cl">##                                                          
</span></span><span class="line"><span class="cl">## 
</span></span></code></pre></div><ul>
<li>Note que, para variáveis lógicas, de texto (character) ou categóricas (factor), aparecem poucas informações.</li>
<li>Logo, pode ser interessante fazer uma <strong>tabela com a contagem</strong> de com as categorias de uma variável. Isto é possível por meio da função <code>table()</code> e aplicaremos <code>prop.table(table())</code> para visualizar em <strong>percentuais</strong>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">table</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">hair_color</span><span class="p">)</span> <span class="c1"># contagem</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">##        auburn  auburn, grey auburn, white         black         blond 
</span></span><span class="line"><span class="cl">##             1             1             1            13             3 
</span></span><span class="line"><span class="cl">##        blonde         brown   brown, grey          grey          none 
</span></span><span class="line"><span class="cl">##             1            18             1             1            37 
</span></span><span class="line"><span class="cl">##       unknown         white 
</span></span><span class="line"><span class="cl">##             1             4
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">prop.table</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">hair_color</span><span class="p">))</span> <span class="c1"># percentual</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">##        auburn  auburn, grey auburn, white         black         blond 
</span></span><span class="line"><span class="cl">##    0.01219512    0.01219512    0.01219512    0.15853659    0.03658537 
</span></span><span class="line"><span class="cl">##        blonde         brown   brown, grey          grey          none 
</span></span><span class="line"><span class="cl">##    0.01219512    0.21951220    0.01219512    0.01219512    0.45121951 
</span></span><span class="line"><span class="cl">##       unknown         white 
</span></span><span class="line"><span class="cl">##    0.01219512    0.04878049
</span></span></code></pre></div><ul>
<li>Também podemos fazer uma &ldquo;contagem cruzada&rdquo; incluindo mais uma variável em <code>table()</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">table</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">hair_color</span><span class="p">,</span> <span class="n">sw</span><span class="o">$</span><span class="n">gender</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##                
</span></span><span class="line"><span class="cl">##                 feminine masculine
</span></span><span class="line"><span class="cl">##   auburn               1         0
</span></span><span class="line"><span class="cl">##   auburn, grey         0         1
</span></span><span class="line"><span class="cl">##   auburn, white        0         1
</span></span><span class="line"><span class="cl">##   black                3         9
</span></span><span class="line"><span class="cl">##   blond                0         3
</span></span><span class="line"><span class="cl">##   blonde               1         0
</span></span><span class="line"><span class="cl">##   brown                6        11
</span></span><span class="line"><span class="cl">##   brown, grey          0         1
</span></span><span class="line"><span class="cl">##   grey                 0         1
</span></span><span class="line"><span class="cl">##   none                 5        31
</span></span><span class="line"><span class="cl">##   unknown              0         0
</span></span><span class="line"><span class="cl">##   white                1         3
</span></span></code></pre></div><h4 id="família-de-funções-_apply_">Família de funções <em>apply</em></h4>
<p>Veremos uma família de funções <em>apply</em> que permitem executar comandos em loop de maneira compacta:</p>
<ul>
<li><code>apply</code>: aplica uma função sobre as margens (linha ou coluna) de uma matrix/array</li>
<li><code>lapply</code>: loop sobre uma lista e avalia uma função em cada elemento
<ul>
<li>função auxiliar <code>split</code> é útil ao ser utilizada em conjunto da <code>lapply</code></li>
</ul>
</li>
<li><code>sapply</code>: mesmo que o <code>lapply</code>, mas simplifica o resultado</li>
</ul>
<h5 id="função-apply">Função <code>apply()</code></h5>
<ul>
<li><a href="https://www.coursera.org/learn/r-programming/lecture/IUUhK/loop-functions-apply" target="_blank" rel="noopener">Loop functions - apply (John Hopkins/Coursera)</a></li>
<li>Usado para avaliar, por meio de uma função, margens de uma matriz/array</li>
<li>Frequentemente é utilizado para aplicar uma função a linhas ou a colunas de uma matriz</li>
<li>Não é mais rápido do que escrever um loop, mas funciona em uma única linha</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">apply(X, MARGIN, FUN, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">X: an array, including a matrix.MARGIN</span><span class="p">:</span><span class="w"> </span><span class="l">a vector giving the subscripts which the function will be applied over. E.g., for a matrix 1 indicates rows, 2 indicates columns, c(1, 2) indicates rows and columns.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">FUN</span><span class="p">:</span><span class="w"> </span><span class="l">the function to be applied</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##      [,1] [,2] [,3] [,4]
</span></span><span class="line"><span class="cl">## [1,]    1    6   11   16
</span></span><span class="line"><span class="cl">## [2,]    2    7   12   17
</span></span><span class="line"><span class="cl">## [3,]    3    8   13   18
</span></span><span class="line"><span class="cl">## [4,]    4    9   14   19
</span></span><span class="line"><span class="cl">## [5,]    5   10   15   20
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">apply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span> <span class="c1"># médias das linhas</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1]  8.5  9.5 10.5 11.5 12.5
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">apply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span> <span class="c1"># médias das colunas</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1]  3  8 13 18
</span></span></code></pre></div><ul>
<li>Há funções pré-definidas que aplicam <code>apply</code> com soma e com média:
<ul>
<li><code>rowSums = apply(x, 1, sum)</code></li>
<li><code>rowMeans = apply(x, 1, mean)</code></li>
<li><code>colSums = apply(x, 2, sum)</code></li>
<li><code>colMeans = apply(x, 2, mean)</code></li>
</ul>
</li>
</ul>
<h5 id="função-lapply">Função <code>lapply()</code></h5>
<ul>
<li><a href="https://www.coursera.org/learn/r-programming/lecture/t5iuo/loop-functions-lapply" target="_blank" rel="noopener">Loop functions - lapply (John Hopkins/Coursera)</a></li>
<li><code>lapply</code> usa três argumentos: uma <strong>lista</strong>, o nome de uma função e outros argumentos (incluindo os argumentos da função inserida)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">lapply(X, FUN, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">X</span><span class="p">:</span><span class="w"> </span><span class="l">a vector (atomic or list) or an expression object.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">FUN</span><span class="p">:</span><span class="w"> </span><span class="l">the function to be applied to each element of X.</span><span class="w">
</span></span></span></code></pre></div><!-- ```{r} -->
<!-- # Criando uma lista com vetor de dimensões distintas -->
<!-- x = list(a=1:5, b=45:38, c=c(1, 4, 65, 6, 78)) -->
<!-- x -->
<!-- lapply(x, mean) # retorna médias de cada vetor dentro da lista -->
<!-- lapply(x, summary) # retorna 6 estatísticas de cada vetor dentro da lista -->
<!-- class(lapply(x, mean)) # classe do objeto retornado pelo lapply -->
<!-- ``` -->
<ul>
<li>A função <code>lapply()</code> aplica uma função em cada um de seus elementos.</li>
<li>Um tipo especial de lista é o data frame, cujos elementos são suas colunas (variáveis).</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">lapply</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># valores únicos</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## $name
</span></span><span class="line"><span class="cl">## [1] NA
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $height
</span></span><span class="line"><span class="cl">## [1] 174.358
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $mass
</span></span><span class="line"><span class="cl">## [1] 97.31186
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $hair_color
</span></span><span class="line"><span class="cl">## [1] NA
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $skin_color
</span></span><span class="line"><span class="cl">## [1] NA
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $eye_color
</span></span><span class="line"><span class="cl">## [1] NA
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $birth_year
</span></span><span class="line"><span class="cl">## [1] 87.56512
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $sex
</span></span><span class="line"><span class="cl">## [1] NA
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $gender
</span></span><span class="line"><span class="cl">## [1] NA
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $homeworld
</span></span><span class="line"><span class="cl">## [1] NA
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $species
</span></span><span class="line"><span class="cl">## [1] NA
</span></span></code></pre></div><ul>
<li>
<p>Note que as variáveis não numérica retornaram <code>NA</code> e o 3º argumento é um arguemento da própria função <code>mean()</code></p>
</li>
<li>
<p>Podemos verificar quais são os valores únicos de cada variável (um item da lista) usando <code>unique()</code></p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">lapply</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="n">unique</span><span class="p">)</span> <span class="c1"># valores únicos</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## $name
</span></span><span class="line"><span class="cl">##  [1] &#34;Luke Skywalker&#34;        &#34;C-3PO&#34;                 &#34;R2-D2&#34;                
</span></span><span class="line"><span class="cl">##  [4] &#34;Darth Vader&#34;           &#34;Leia Organa&#34;           &#34;Owen Lars&#34;            
</span></span><span class="line"><span class="cl">##  [7] &#34;Beru Whitesun lars&#34;    &#34;R5-D4&#34;                 &#34;Biggs Darklighter&#34;    
</span></span><span class="line"><span class="cl">## [10] &#34;Obi-Wan Kenobi&#34;        &#34;Anakin Skywalker&#34;      &#34;Wilhuff Tarkin&#34;       
</span></span><span class="line"><span class="cl">## [13] &#34;Chewbacca&#34;             &#34;Han Solo&#34;              &#34;Greedo&#34;               
</span></span><span class="line"><span class="cl">## [16] &#34;Jabba Desilijic Tiure&#34; &#34;Wedge Antilles&#34;        &#34;Jek Tono Porkins&#34;     
</span></span><span class="line"><span class="cl">## [19] &#34;Yoda&#34;                  &#34;Palpatine&#34;             &#34;Boba Fett&#34;            
</span></span><span class="line"><span class="cl">## [22] &#34;IG-88&#34;                 &#34;Bossk&#34;                 &#34;Lando Calrissian&#34;     
</span></span><span class="line"><span class="cl">## [25] &#34;Lobot&#34;                 &#34;Ackbar&#34;                &#34;Mon Mothma&#34;           
</span></span><span class="line"><span class="cl">## [28] &#34;Arvel Crynyd&#34;          &#34;Wicket Systri Warrick&#34; &#34;Nien Nunb&#34;            
</span></span><span class="line"><span class="cl">## [31] &#34;Qui-Gon Jinn&#34;          &#34;Nute Gunray&#34;           &#34;Finis Valorum&#34;        
</span></span><span class="line"><span class="cl">## [34] &#34;Jar Jar Binks&#34;         &#34;Roos Tarpals&#34;          &#34;Rugor Nass&#34;           
</span></span><span class="line"><span class="cl">## [37] &#34;Ric Olié&#34;              &#34;Watto&#34;                 &#34;Sebulba&#34;              
</span></span><span class="line"><span class="cl">## [40] &#34;Quarsh Panaka&#34;         &#34;Shmi Skywalker&#34;        &#34;Darth Maul&#34;           
</span></span><span class="line"><span class="cl">## [43] &#34;Bib Fortuna&#34;           &#34;Ayla Secura&#34;           &#34;Dud Bolt&#34;             
</span></span><span class="line"><span class="cl">## [46] &#34;Gasgano&#34;               &#34;Ben Quadinaros&#34;        &#34;Mace Windu&#34;           
</span></span><span class="line"><span class="cl">## [49] &#34;Ki-Adi-Mundi&#34;          &#34;Kit Fisto&#34;             &#34;Eeth Koth&#34;            
</span></span><span class="line"><span class="cl">## [52] &#34;Adi Gallia&#34;            &#34;Saesee Tiin&#34;           &#34;Yarael Poof&#34;          
</span></span><span class="line"><span class="cl">## [55] &#34;Plo Koon&#34;              &#34;Mas Amedda&#34;            &#34;Gregar Typho&#34;         
</span></span><span class="line"><span class="cl">## [58] &#34;Cordé&#34;                 &#34;Cliegg Lars&#34;           &#34;Poggle the Lesser&#34;    
</span></span><span class="line"><span class="cl">## [61] &#34;Luminara Unduli&#34;       &#34;Barriss Offee&#34;         &#34;Dormé&#34;                
</span></span><span class="line"><span class="cl">## [64] &#34;Dooku&#34;                 &#34;Bail Prestor Organa&#34;   &#34;Jango Fett&#34;           
</span></span><span class="line"><span class="cl">## [67] &#34;Zam Wesell&#34;            &#34;Dexter Jettster&#34;       &#34;Lama Su&#34;              
</span></span><span class="line"><span class="cl">## [70] &#34;Taun We&#34;               &#34;Jocasta Nu&#34;            &#34;Ratts Tyerell&#34;        
</span></span><span class="line"><span class="cl">## [73] &#34;R4-P17&#34;                &#34;Wat Tambor&#34;            &#34;San Hill&#34;             
</span></span><span class="line"><span class="cl">## [76] &#34;Shaak Ti&#34;              &#34;Grievous&#34;              &#34;Tarfful&#34;              
</span></span><span class="line"><span class="cl">## [79] &#34;Raymus Antilles&#34;       &#34;Sly Moore&#34;             &#34;Tion Medon&#34;           
</span></span><span class="line"><span class="cl">## [82] &#34;Finn&#34;                  &#34;Rey&#34;                   &#34;Poe Dameron&#34;          
</span></span><span class="line"><span class="cl">## [85] &#34;BB8&#34;                   &#34;Captain Phasma&#34;        &#34;Padmé Amidala&#34;        
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $height
</span></span><span class="line"><span class="cl">##  [1] 172 167  96 202 150 178 165  97 183 182 188 180 228 173 175 170  66 200 190
</span></span><span class="line"><span class="cl">## [20] 177  NA  88 160 193 191 196 224 206 137 112 163  94 122 198 171 184 264 185
</span></span><span class="line"><span class="cl">## [39] 157 166 168 229 213  79 216 234
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $mass
</span></span><span class="line"><span class="cl">##  [1]   77.0   75.0   32.0  136.0   49.0  120.0   84.0     NA  112.0   80.0
</span></span><span class="line"><span class="cl">## [11]   74.0 1358.0  110.0   17.0   78.2  140.0  113.0   79.0   83.0   20.0
</span></span><span class="line"><span class="cl">## [21]   68.0   89.0   90.0   66.0   82.0   40.0   55.0   45.0   65.0   87.0
</span></span><span class="line"><span class="cl">## [31]   50.0   85.0   56.2  102.0   88.0   15.0   48.0   57.0  159.0
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $hair_color
</span></span><span class="line"><span class="cl">##  [1] &#34;blond&#34;         NA              &#34;none&#34;          &#34;brown&#34;        
</span></span><span class="line"><span class="cl">##  [5] &#34;brown, grey&#34;   &#34;black&#34;         &#34;auburn, white&#34; &#34;auburn, grey&#34; 
</span></span><span class="line"><span class="cl">##  [9] &#34;white&#34;         &#34;grey&#34;          &#34;auburn&#34;        &#34;blonde&#34;       
</span></span><span class="line"><span class="cl">## [13] &#34;unknown&#34;      
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $skin_color
</span></span><span class="line"><span class="cl">##  [1] &#34;fair&#34;                &#34;gold&#34;                &#34;white, blue&#34;        
</span></span><span class="line"><span class="cl">##  [4] &#34;white&#34;               &#34;light&#34;               &#34;white, red&#34;         
</span></span><span class="line"><span class="cl">##  [7] &#34;unknown&#34;             &#34;green&#34;               &#34;green-tan, brown&#34;   
</span></span><span class="line"><span class="cl">## [10] &#34;pale&#34;                &#34;metal&#34;               &#34;dark&#34;               
</span></span><span class="line"><span class="cl">## [13] &#34;brown mottle&#34;        &#34;brown&#34;               &#34;grey&#34;               
</span></span><span class="line"><span class="cl">## [16] &#34;mottled green&#34;       &#34;orange&#34;              &#34;blue, grey&#34;         
</span></span><span class="line"><span class="cl">## [19] &#34;grey, red&#34;           &#34;red&#34;                 &#34;blue&#34;               
</span></span><span class="line"><span class="cl">## [22] &#34;grey, green, yellow&#34; &#34;yellow&#34;              &#34;tan&#34;                
</span></span><span class="line"><span class="cl">## [25] &#34;fair, green, yellow&#34; &#34;grey, blue&#34;          &#34;silver, red&#34;        
</span></span><span class="line"><span class="cl">## [28] &#34;green, grey&#34;         &#34;red, blue, white&#34;    &#34;brown, white&#34;       
</span></span><span class="line"><span class="cl">## [31] &#34;none&#34;               
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $eye_color
</span></span><span class="line"><span class="cl">##  [1] &#34;blue&#34;          &#34;yellow&#34;        &#34;red&#34;           &#34;brown&#34;        
</span></span><span class="line"><span class="cl">##  [5] &#34;blue-gray&#34;     &#34;black&#34;         &#34;orange&#34;        &#34;hazel&#34;        
</span></span><span class="line"><span class="cl">##  [9] &#34;pink&#34;          &#34;unknown&#34;       &#34;red, blue&#34;     &#34;gold&#34;         
</span></span><span class="line"><span class="cl">## [13] &#34;green, yellow&#34; &#34;white&#34;         &#34;dark&#34;         
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $birth_year
</span></span><span class="line"><span class="cl">##  [1]  19.0 112.0  33.0  41.9  52.0  47.0    NA  24.0  57.0  64.0 200.0  29.0
</span></span><span class="line"><span class="cl">## [13]  44.0 600.0  21.0 896.0  82.0  31.5  15.0  53.0  31.0  37.0  41.0  48.0
</span></span><span class="line"><span class="cl">## [25]   8.0  92.0  91.0  62.0  72.0  54.0  22.0  58.0  40.0 102.0  67.0  66.0
</span></span><span class="line"><span class="cl">## [37]  46.0
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $sex
</span></span><span class="line"><span class="cl">## [1] &#34;male&#34;           &#34;none&#34;           &#34;female&#34;         &#34;hermaphroditic&#34;
</span></span><span class="line"><span class="cl">## [5] NA              
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $gender
</span></span><span class="line"><span class="cl">## [1] &#34;masculine&#34; &#34;feminine&#34;  NA         
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $homeworld
</span></span><span class="line"><span class="cl">##  [1] &#34;Tatooine&#34;       &#34;Naboo&#34;          &#34;Alderaan&#34;       &#34;Stewjon&#34;       
</span></span><span class="line"><span class="cl">##  [5] &#34;Eriadu&#34;         &#34;Kashyyyk&#34;       &#34;Corellia&#34;       &#34;Rodia&#34;         
</span></span><span class="line"><span class="cl">##  [9] &#34;Nal Hutta&#34;      &#34;Bestine IV&#34;     NA               &#34;Kamino&#34;        
</span></span><span class="line"><span class="cl">## [13] &#34;Trandosha&#34;      &#34;Socorro&#34;        &#34;Bespin&#34;         &#34;Mon Cala&#34;      
</span></span><span class="line"><span class="cl">## [17] &#34;Chandrila&#34;      &#34;Endor&#34;          &#34;Sullust&#34;        &#34;Cato Neimoidia&#34;
</span></span><span class="line"><span class="cl">## [21] &#34;Coruscant&#34;      &#34;Toydaria&#34;       &#34;Malastare&#34;      &#34;Dathomir&#34;      
</span></span><span class="line"><span class="cl">## [25] &#34;Ryloth&#34;         &#34;Vulpter&#34;        &#34;Troiken&#34;        &#34;Tund&#34;          
</span></span><span class="line"><span class="cl">## [29] &#34;Haruun Kal&#34;     &#34;Cerea&#34;          &#34;Glee Anselm&#34;    &#34;Iridonia&#34;      
</span></span><span class="line"><span class="cl">## [33] &#34;Iktotch&#34;        &#34;Quermia&#34;        &#34;Dorin&#34;          &#34;Champala&#34;      
</span></span><span class="line"><span class="cl">## [37] &#34;Geonosis&#34;       &#34;Mirial&#34;         &#34;Serenno&#34;        &#34;Concord Dawn&#34;  
</span></span><span class="line"><span class="cl">## [41] &#34;Zolan&#34;          &#34;Ojom&#34;           &#34;Aleen Minor&#34;    &#34;Skako&#34;         
</span></span><span class="line"><span class="cl">## [45] &#34;Muunilinst&#34;     &#34;Shili&#34;          &#34;Kalee&#34;          &#34;Umbara&#34;        
</span></span><span class="line"><span class="cl">## [49] &#34;Utapau&#34;        
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $species
</span></span><span class="line"><span class="cl">##  [1] &#34;Human&#34;          &#34;Droid&#34;          &#34;Wookiee&#34;        &#34;Rodian&#34;        
</span></span><span class="line"><span class="cl">##  [5] &#34;Hutt&#34;           &#34;Yoda&#39;s species&#34; &#34;Trandoshan&#34;     &#34;Mon Calamari&#34;  
</span></span><span class="line"><span class="cl">##  [9] &#34;Ewok&#34;           &#34;Sullustan&#34;      &#34;Neimodian&#34;      &#34;Gungan&#34;        
</span></span><span class="line"><span class="cl">## [13] NA               &#34;Toydarian&#34;      &#34;Dug&#34;            &#34;Zabrak&#34;        
</span></span><span class="line"><span class="cl">## [17] &#34;Twi&#39;lek&#34;        &#34;Vulptereen&#34;     &#34;Xexto&#34;          &#34;Toong&#34;         
</span></span><span class="line"><span class="cl">## [21] &#34;Cerean&#34;         &#34;Nautolan&#34;       &#34;Tholothian&#34;     &#34;Iktotchi&#34;      
</span></span><span class="line"><span class="cl">## [25] &#34;Quermian&#34;       &#34;Kel Dor&#34;        &#34;Chagrian&#34;       &#34;Geonosian&#34;     
</span></span><span class="line"><span class="cl">## [29] &#34;Mirialan&#34;       &#34;Clawdite&#34;       &#34;Besalisk&#34;       &#34;Kaminoan&#34;      
</span></span><span class="line"><span class="cl">## [33] &#34;Aleena&#34;         &#34;Skakoan&#34;        &#34;Muun&#34;           &#34;Togruta&#34;       
</span></span><span class="line"><span class="cl">## [37] &#34;Kaleesh&#34;        &#34;Pau&#39;an&#34;
</span></span></code></pre></div><ul>
<li>Um uso interessante é para a verificação do <strong>número de NA&rsquo;s de um data frame</strong>. No entanto, ao transformar uma variável com <code>is.na()</code>, ela se torna uma matriz e, portanto, é necessário usar função <code>apply()</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span> <span class="nf">is.na</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># 6 primeiras linhas aplicando is.na()</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##       name height  mass hair_color skin_color eye_color birth_year   sex gender
</span></span><span class="line"><span class="cl">## [1,] FALSE  FALSE FALSE      FALSE      FALSE     FALSE      FALSE FALSE  FALSE
</span></span><span class="line"><span class="cl">## [2,] FALSE  FALSE FALSE       TRUE      FALSE     FALSE      FALSE FALSE  FALSE
</span></span><span class="line"><span class="cl">## [3,] FALSE  FALSE FALSE       TRUE      FALSE     FALSE      FALSE FALSE  FALSE
</span></span><span class="line"><span class="cl">## [4,] FALSE  FALSE FALSE      FALSE      FALSE     FALSE      FALSE FALSE  FALSE
</span></span><span class="line"><span class="cl">## [5,] FALSE  FALSE FALSE      FALSE      FALSE     FALSE      FALSE FALSE  FALSE
</span></span><span class="line"><span class="cl">## [6,] FALSE  FALSE FALSE      FALSE      FALSE     FALSE      FALSE FALSE  FALSE
</span></span><span class="line"><span class="cl">##      homeworld species
</span></span><span class="line"><span class="cl">## [1,]     FALSE   FALSE
</span></span><span class="line"><span class="cl">## [2,]     FALSE   FALSE
</span></span><span class="line"><span class="cl">## [3,]     FALSE   FALSE
</span></span><span class="line"><span class="cl">## [4,]     FALSE   FALSE
</span></span><span class="line"><span class="cl">## [5,]     FALSE   FALSE
</span></span><span class="line"><span class="cl">## [6,]     FALSE   FALSE
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span> <span class="nf">is.na</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># tipo de objeto</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] &#34;matrix&#34; &#34;array&#34;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">apply</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">sw</span><span class="p">),</span> <span class="m">2</span><span class="p">,</span> <span class="n">sum</span><span class="p">)</span> <span class="c1"># somando cada coluna de TRUE/FALSE</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##       name     height       mass hair_color skin_color  eye_color birth_year 
</span></span><span class="line"><span class="cl">##          0          6         28          5          0          0         44 
</span></span><span class="line"><span class="cl">##        sex     gender  homeworld    species 
</span></span><span class="line"><span class="cl">##          4          4         10          4
</span></span></code></pre></div><h5 id="função-sapply">Função <code>sapply()</code></h5>
<p>Similar ao <code>lapply</code>, mas <code>sapply</code> tenta simplificar o output:</p>
<ul>
<li>Se o resultado for uma lista em seus elementos têm o mesmo comprimento, retorna um vetor (ou matriz)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sapply</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># retorna um vetor</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##       name     height       mass hair_color skin_color  eye_color birth_year 
</span></span><span class="line"><span class="cl">##         NA  174.35802   97.31186         NA         NA         NA   87.56512 
</span></span><span class="line"><span class="cl">##        sex     gender  homeworld    species 
</span></span><span class="line"><span class="cl">##         NA         NA         NA         NA
</span></span></code></pre></div><h3 id="filtro-de-linhas">Filtro de linhas</h3>
<ul>
<li><a href="https://www.coursera.org/learn/data-cleaning/lecture/aqd2Y/subsetting-and-sorting" target="_blank" rel="noopener">Subsetting and sorting (John Hopkins/Coursera)</a></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># vetor lógico de cabelo loiro</span>
</span></span><span class="line"><span class="cl"><span class="n">sw</span><span class="o">$</span><span class="n">hair_color</span> <span class="o">==</span> <span class="s">&#34;blond&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##  [1]  TRUE    NA    NA FALSE FALSE FALSE FALSE    NA FALSE FALSE  TRUE FALSE
</span></span><span class="line"><span class="cl">## [13] FALSE FALSE    NA    NA FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
</span></span><span class="line"><span class="cl">## [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE
</span></span><span class="line"><span class="cl">## [37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
</span></span><span class="line"><span class="cl">## [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
</span></span><span class="line"><span class="cl">## [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
</span></span><span class="line"><span class="cl">## [73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
</span></span><span class="line"><span class="cl">## [85] FALSE FALSE FALSE
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Extraindo linhas com cabelo loiro</span>
</span></span><span class="line"><span class="cl"><span class="n">sw[sw</span><span class="o">$</span><span class="n">hair_color</span> <span class="o">==</span> <span class="s">&#34;blond&#34;</span><span class="p">,</span> <span class="n">]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 8 × 11
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">## 2 &lt;NA&gt;          NA    NA &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;            NA   &lt;NA&gt;  &lt;NA&gt;  
</span></span><span class="line"><span class="cl">## 3 &lt;NA&gt;          NA    NA &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;            NA   &lt;NA&gt;  &lt;NA&gt;  
</span></span><span class="line"><span class="cl">## 4 &lt;NA&gt;          NA    NA &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;            NA   &lt;NA&gt;  &lt;NA&gt;  
</span></span><span class="line"><span class="cl">## 5 Anakin S…    188    84 blond      fair       blue            41.9 male  mascu…
</span></span><span class="line"><span class="cl">## 6 &lt;NA&gt;          NA    NA &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;            NA   &lt;NA&gt;  &lt;NA&gt;  
</span></span><span class="line"><span class="cl">## 7 &lt;NA&gt;          NA    NA &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;            NA   &lt;NA&gt;  &lt;NA&gt;  
</span></span><span class="line"><span class="cl">## 8 Finis Va…    170    NA blond      fair       blue            91   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><ul>
<li>Podemos usar expressões lógicas (vetor com <code>TRUE</code> e <code>FALSE</code>) para extrair/filtrar uma parte do data frame. Por exemplo, queremos filtrar &ldquo;Droid&rdquo; <strong>E</strong> (<code>&amp;</code>) que não seja <code>NA</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw[sw</span><span class="o">$</span><span class="n">hair_color</span> <span class="o">==</span> <span class="s">&#34;blond&#34;</span> <span class="o">&amp;</span> <span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">hair_color</span><span class="p">),</span> <span class="n">]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 3 × 11
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">## 2 Anakin S…    188    84 blond      fair       blue            41.9 male  mascu…
</span></span><span class="line"><span class="cl">## 3 Finis Va…    170    NA blond      fair       blue            91   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><ul>
<li>Para não ter que ficar escrevendo <code>sw</code> antes de cada variáveis, podemos usar função <code>with()</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">with</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">sw[hair_color</span> <span class="o">==</span> <span class="s">&#34;blond&#34;</span> <span class="o">&amp;</span> <span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">hair_color</span><span class="p">),</span><span class="n">]</span>
</span></span><span class="line"><span class="cl">     <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 3 × 11
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">## 2 Anakin S…    188    84 blond      fair       blue            41.9 male  mascu…
</span></span><span class="line"><span class="cl">## 3 Finis Va…    170    NA blond      fair       blue            91   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><ul>
<li>Poderíamos também obter cabelo loiro <strong>OU</strong> (<code>|</code>) branco:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Extraindo linhas em que cabelo é loiro ou branco</span>
</span></span><span class="line"><span class="cl"><span class="n">sw[sw</span><span class="o">$</span><span class="n">hair_color</span> <span class="o">==</span> <span class="s">&#34;blond&#34;</span> <span class="o">|</span> <span class="n">sw</span><span class="o">$</span><span class="n">hair_color</span> <span class="o">==</span> <span class="s">&#34;white&#34;</span><span class="p">,</span> <span class="n">]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 12 × 11
</span></span><span class="line"><span class="cl">##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">##  2 &lt;NA&gt;         NA    NA &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;            NA   &lt;NA&gt;  &lt;NA&gt;  
</span></span><span class="line"><span class="cl">##  3 &lt;NA&gt;         NA    NA &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;            NA   &lt;NA&gt;  &lt;NA&gt;  
</span></span><span class="line"><span class="cl">##  4 &lt;NA&gt;         NA    NA &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;            NA   &lt;NA&gt;  &lt;NA&gt;  
</span></span><span class="line"><span class="cl">##  5 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
</span></span><span class="line"><span class="cl">##  6 &lt;NA&gt;         NA    NA &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;            NA   &lt;NA&gt;  &lt;NA&gt;  
</span></span><span class="line"><span class="cl">##  7 &lt;NA&gt;         NA    NA &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;            NA   &lt;NA&gt;  &lt;NA&gt;  
</span></span><span class="line"><span class="cl">##  8 Yoda         66    17 white      green      brown          896   male  mascu…
</span></span><span class="line"><span class="cl">##  9 Finis V…    170    NA blond      fair       blue            91   male  mascu…
</span></span><span class="line"><span class="cl">## 10 Ki-Adi-…    198    82 white      pale       yellow          92   male  mascu…
</span></span><span class="line"><span class="cl">## 11 Dooku       193    80 white      fair       brown          102   male  mascu…
</span></span><span class="line"><span class="cl">## 12 Jocasta…    167    NA white      fair       blue            NA   fema… femin…
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><ul>
<li>Também podemos verificar se determinados valores estão contidos em um vetor específico (equivale a <code>==</code> com mais de um valor)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw</span><span class="o">$</span><span class="n">hair_color</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;blond&#34;</span><span class="p">,</span> <span class="s">&#34;white&#34;</span><span class="p">)</span> <span class="c1"># T/F cabelo loiro ou branco</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##  [1]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE
</span></span><span class="line"><span class="cl">## [13] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE
</span></span><span class="line"><span class="cl">## [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE
</span></span><span class="line"><span class="cl">## [37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
</span></span><span class="line"><span class="cl">## [49]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
</span></span><span class="line"><span class="cl">## [61] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE
</span></span><span class="line"><span class="cl">## [73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
</span></span><span class="line"><span class="cl">## [85] FALSE FALSE FALSE
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw</span> <span class="o">=</span> <span class="n">sw[sw</span><span class="o">$</span><span class="n">hair_color</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;blond&#34;</span><span class="p">,</span> <span class="s">&#34;white&#34;</span><span class="p">),</span> <span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 11
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">## 2 Anakin S…    188    84 blond      fair       blue            41.9 male  mascu…
</span></span><span class="line"><span class="cl">## 3 Yoda          66    17 white      green      brown          896   male  mascu…
</span></span><span class="line"><span class="cl">## 4 Finis Va…    170    NA blond      fair       blue            91   male  mascu…
</span></span><span class="line"><span class="cl">## 5 Ki-Adi-M…    198    82 white      pale       yellow          92   male  mascu…
</span></span><span class="line"><span class="cl">## 6 Dooku        193    80 white      fair       brown          102   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><h3 id="ordenação-de-linhas">Ordenação de linhas</h3>
<ul>
<li>
<p><a href="https://www.coursera.org/learn/data-cleaning/lecture/aqd2Y/subsetting-and-sorting" target="_blank" rel="noopener">Subsetting and sorting (John Hopkins/Coursera)</a></p>
</li>
<li>
<p>Podemos usar a função <code>sort()</code> para ordenar um vetor de maneira crescente (padrão) ou decrescente:</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sort</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">height</span><span class="p">)</span> <span class="c1"># ordenando de maneira crescente</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1]  66 167 170 172 188 193 198
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sort</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">height</span><span class="p">,</span> <span class="n">decreasing</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># ordenando de maneira decrescente</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 198 193 188 172 170 167  66
</span></span></code></pre></div><ul>
<li>Note que não podemos usar a função <code>sort()</code> para ordenar um data frame, pois a função retorna um vetor com os valores da base de dados.</li>
<li>Para <strong>ordenar data frames</strong>, precisamos utilizar a função <code>order()</code> que, retorna os índices dos menores valores aos maiores (ou decrescente com <code>decreasing = TRUE</code>):</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">order</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">height</span><span class="p">)</span> <span class="c1"># índices na forma crescente de altura</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 3 7 4 1 2 6 5
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw</span> <span class="o">=</span> <span class="n">sw</span><span class="nf">[order</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">height</span><span class="p">),</span> <span class="n">]</span> <span class="c1"># reordenando data frame</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 11
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Yoda          66    17 white      green      brown          896   male  mascu…
</span></span><span class="line"><span class="cl">## 2 Jocasta …    167    NA white      fair       blue            NA   fema… femin…
</span></span><span class="line"><span class="cl">## 3 Finis Va…    170    NA blond      fair       blue            91   male  mascu…
</span></span><span class="line"><span class="cl">## 4 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">## 5 Anakin S…    188    84 blond      fair       blue            41.9 male  mascu…
</span></span><span class="line"><span class="cl">## 6 Dooku        193    80 white      fair       brown          102   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><h3 id="seleção-de-colunas">Seleção de colunas</h3>
<ul>
<li>Podemos selecionar colunas usando <code>[,]</code> e incluindo um vetor de nomes/índices das colunas que quer manter (ou retirar usando <code>!</code>)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Selecionando 3 primeiras colunas</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span> <span class="n">sw[</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">,</span><span class="s">&#34;height&#34;</span><span class="p">,</span> <span class="s">&#34;mass&#34;</span><span class="p">)</span><span class="n">]</span> <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 3
</span></span><span class="line"><span class="cl">##   name             height  mass
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;             &lt;int&gt; &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1 Yoda                 66    17
</span></span><span class="line"><span class="cl">## 2 Jocasta Nu          167    NA
</span></span><span class="line"><span class="cl">## 3 Finis Valorum       170    NA
</span></span><span class="line"><span class="cl">## 4 Luke Skywalker      172    77
</span></span><span class="line"><span class="cl">## 5 Anakin Skywalker    188    84
</span></span><span class="line"><span class="cl">## 6 Dooku               193    80
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Selecionando 6 primeiras colunas</span>
</span></span><span class="line"><span class="cl"><span class="n">sw</span> <span class="o">=</span> <span class="n">sw[</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 6
</span></span><span class="line"><span class="cl">##   name             height  mass hair_color skin_color eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;             &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 Yoda                 66    17 white      green      brown    
</span></span><span class="line"><span class="cl">## 2 Jocasta Nu          167    NA white      fair       blue     
</span></span><span class="line"><span class="cl">## 3 Finis Valorum       170    NA blond      fair       blue     
</span></span><span class="line"><span class="cl">## 4 Luke Skywalker      172    77 blond      fair       blue     
</span></span><span class="line"><span class="cl">## 5 Anakin Skywalker    188    84 blond      fair       blue     
</span></span><span class="line"><span class="cl">## 6 Dooku               193    80 white      fair       brown
</span></span></code></pre></div><h3 id="renomeação-de-colunas">Renomeação de colunas</h3>
<ul>
<li>Podemos alterar os nomes das variáveis usando <code>names()</code> ou <code>colnames()</code> e atribuindo um vetor de nomes</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">names</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span> <span class="c1"># nomes da base de dados</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] &#34;name&#34;       &#34;height&#34;     &#34;mass&#34;       &#34;hair_color&#34; &#34;skin_color&#34;
</span></span><span class="line"><span class="cl">## [6] &#34;eye_color&#34;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Retirando os underlines</span>
</span></span><span class="line"><span class="cl"><span class="nf">names</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span><span class="n">[4]</span> <span class="o">=</span> <span class="s">&#34;haircolor&#34;</span> <span class="c1"># alterando um único</span>
</span></span><span class="line"><span class="cl"><span class="nf">names</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span><span class="n">[5</span><span class="o">:</span><span class="m">6</span><span class="n">]</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;skincolor&#34;</span><span class="p">,</span> <span class="s">&#34;eyecolor&#34;</span><span class="p">)</span> <span class="c1"># alterando 2 nomes</span>
</span></span><span class="line"><span class="cl"><span class="nf">names</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span> <span class="c1"># vetor de nomes com alteração</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] &#34;name&#34;      &#34;height&#34;    &#34;mass&#34;      &#34;haircolor&#34; &#34;skincolor&#34; &#34;eyecolor&#34;
</span></span></code></pre></div><h3 id="modificação-de-colunas">Modificação de colunas</h3>
<ul>
<li>Para modificar variáveis, podemos usar <code>$&lt;novo_nome_var&gt;</code> e atribuir um vetor de mesmo tamanho (mesma quantidade de linhas):</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw</span><span class="o">$</span><span class="n">height</span> <span class="o">=</span> <span class="n">sw</span><span class="o">$</span><span class="n">height</span> <span class="o">/</span> <span class="m">100</span> <span class="c1"># de cm para metro</span>
</span></span></code></pre></div><ul>
<li>Se incluir um escalar, vai repetir o valor para todas as linhas</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw</span><span class="o">$</span><span class="n">const</span> <span class="o">=</span> <span class="m">1</span>
</span></span></code></pre></div><ul>
<li>Também é possível criar uma nova variável:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw</span><span class="o">$</span><span class="n">BMI</span> <span class="o">=</span> <span class="n">sw</span><span class="o">$</span><span class="n">mass</span> <span class="o">/</span> <span class="n">sw</span><span class="o">$</span><span class="n">height^2</span> <span class="c1"># índice de massa corpórea</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">sw</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 8
</span></span><span class="line"><span class="cl">##   name             height  mass haircolor skincolor eyecolor const   BMI
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1 Yoda               0.66    17 white     green     brown        1  39.0
</span></span><span class="line"><span class="cl">## 2 Jocasta Nu         1.67    NA white     fair      blue         1  NA  
</span></span><span class="line"><span class="cl">## 3 Finis Valorum      1.7     NA blond     fair      blue         1  NA  
</span></span><span class="line"><span class="cl">## 4 Luke Skywalker     1.72    77 blond     fair      blue         1  26.0
</span></span><span class="line"><span class="cl">## 5 Anakin Skywalker   1.88    84 blond     fair      blue         1  23.8
</span></span><span class="line"><span class="cl">## 6 Dooku              1.93    80 white     fair      brown        1  21.5
</span></span></code></pre></div><ul>
<li><a href="https://www.coursera.org/learn/data-cleaning/lecture/r6VHJ/creating-new-variables" target="_blank" rel="noopener">Algumas transformações comuns de variáveis (John Hopkins/Coursera)</a></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">abs</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">BMI[1</span><span class="o">:</span><span class="m">4</span><span class="n">]</span><span class="p">)</span> <span class="c1"># valor absoluto</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 39.02663       NA       NA 26.02758
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sqrt</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">BMI[1</span><span class="o">:</span><span class="m">4</span><span class="n">]</span><span class="p">)</span> <span class="c1"># raiz quadrada</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 6.247130       NA       NA 5.101723
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ceiling</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">BMI[1</span><span class="o">:</span><span class="m">4</span><span class="n">]</span><span class="p">)</span> <span class="c1"># valor inteiro acima</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 40 NA NA 27
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">floor</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">BMI[1</span><span class="o">:</span><span class="m">4</span><span class="n">]</span><span class="p">)</span> <span class="c1"># valor inteiro abaixo</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 39 NA NA 26
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">round</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">BMI[1</span><span class="o">:</span><span class="m">4</span><span class="n">]</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="m">1</span><span class="p">)</span> <span class="c1"># arred com 1 dígito</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 39 NA NA 26
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">cos</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">BMI[1</span><span class="o">:</span><span class="m">4</span><span class="n">]</span><span class="p">)</span> <span class="c1"># cosseno</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 0.2408856        NA        NA 0.6256427
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sin</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">BMI[1</span><span class="o">:</span><span class="m">4</span><span class="n">]</span><span class="p">)</span> <span class="c1"># seno</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 0.9705535        NA        NA 0.7801098
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">log</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">BMI[1</span><span class="o">:</span><span class="m">4</span><span class="n">]</span><span class="p">)</span> <span class="c1"># logaritmo natural</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 3.664244       NA       NA 3.259157
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">log10</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">BMI[1</span><span class="o">:</span><span class="m">4</span><span class="n">]</span><span class="p">)</span> <span class="c1"># logaritmo base 10</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 1.591361       NA       NA 1.415434
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">exp</span><span class="p">(</span><span class="n">sw</span><span class="o">$</span><span class="n">BMI[1</span><span class="o">:</span><span class="m">4</span><span class="n">]</span><span class="p">)</span> <span class="c1"># exponencial</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 8.893036e+16           NA           NA 2.012035e+11
</span></span></code></pre></div><h3 id="junção-de-bases">Junção de bases</h3>
<ul>
<li>
<p><a href="https://www.coursera.org/learn/data-cleaning/lecture/pVV6K/merging-data" target="_blank" rel="noopener">Merging data (John Hopkins/Coursera)</a></p>
</li>
<li>
<p><a href="https://rforhr.com/join.html" target="_blank" rel="noopener">Joining (Merging) Data (David E. Caughlin)</a></p>
</li>
<li>
<p>Uma junção é o processo de correspondência de casos (ou seja, linhas ou observações) entre dois bases de dados usando uma oou mais variáveis-chave:</p>
</li>
</ul>
<center><img src="../merge.webp"></center>
<ul>
<li>Para isto, vamos usar a função <code>merge()</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">merge(x, y, by = intersect(names(x), names(y)),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">by.x = by, by.y = by, all = FALSE, all.x = all, all.y = all,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">suffixes = c(&#34;.x&#34;,&#34;.y&#34;), ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">x, y</span><span class="p">:</span><span class="w"> </span><span class="l">data frames, or objects to be coerced to one.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">by, by.x, by.y</span><span class="p">:</span><span class="w"> </span><span class="l">specifications of the columns used for merging.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">all</span><span class="p">:</span><span class="w"> </span><span class="l">logical; all = L is shorthand for all.x = L and all.y = L, where L is either TRUE or FALSE.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">all.x</span><span class="p">:</span><span class="w"> </span><span class="l">logical; if TRUE, then extra rows will be added to the output, one for each row in x that has no matching row in y. These rows will have NAs in those columns that are usually filled with values from y.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">all.y</span><span class="p">:</span><span class="w"> </span><span class="l">logical; analogous to all.x.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">sort</span><span class="p">:</span><span class="w"> </span><span class="l">logical. Should the result be sorted on the by columns?</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">suffixes</span><span class="p">:</span><span class="w"> </span><span class="l">a character vector of length 2 specifying the suffixes to be used for making unique the names of columns.</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Vamos criar duas bases de dados, sendo que existem indivíduos presentes em uma base que não está na outra:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Extraindo data frames menores de &#39;starwars&#39; (original)</span>
</span></span><span class="line"><span class="cl"><span class="n">bd1</span> <span class="o">=</span> <span class="n">starwars[1</span><span class="o">:</span><span class="m">6</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">11</span><span class="p">)</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bd1</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 3
</span></span><span class="line"><span class="cl">##   name            mass species
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;  
</span></span><span class="line"><span class="cl">## 1 Luke Skywalker    77 Human  
</span></span><span class="line"><span class="cl">## 2 C-3PO             75 Droid  
</span></span><span class="line"><span class="cl">## 3 R2-D2             32 Droid  
</span></span><span class="line"><span class="cl">## 4 Darth Vader      136 Human  
</span></span><span class="line"><span class="cl">## 5 Leia Organa       49 Human  
</span></span><span class="line"><span class="cl">## 6 Owen Lars        120 Human
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">bd2</span> <span class="o">=</span> <span class="n">starwars</span><span class="nf">[c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">7</span><span class="o">:</span><span class="m">10</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span> <span class="m">6</span><span class="p">)</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bd2</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 3
</span></span><span class="line"><span class="cl">##   name               height eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;               &lt;int&gt; &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 C-3PO                 167 yellow   
</span></span><span class="line"><span class="cl">## 2 Darth Vader           202 yellow   
</span></span><span class="line"><span class="cl">## 3 Beru Whitesun lars    165 blue     
</span></span><span class="line"><span class="cl">## 4 R5-D4                  97 red      
</span></span><span class="line"><span class="cl">## 5 Biggs Darklighter     183 brown    
</span></span><span class="line"><span class="cl">## 6 Obi-Wan Kenobi        182 blue-gray
</span></span></code></pre></div><ul>
<li>Note que há 12 personagens únicos em ambas bases, mas apenas “C-3PO” e “Darth Vader” são observações comuns.</li>
<li>Para verificar as colunas com mesmos nomes em duas bases, podemos usar a função <code>intersect()</code> em conjunto com a função <code>names()</code> ou <code>colnames()</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">intersect</span><span class="p">(</span> <span class="nf">names</span><span class="p">(</span><span class="n">bd1</span><span class="p">),</span> <span class="nf">names</span><span class="p">(</span><span class="n">bd2</span><span class="p">)</span> <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] &#34;name&#34;
</span></span></code></pre></div><ul>
<li>Caso não especifiquemos nenhuma variável-chave, a função <code>merge()</code> utiliza como variável-chave todas as colunas com nomes iguais.</li>
</ul>
<h5 id="inner-join">Inner-join</h5>
<center><img src="../inner_join.png"></center>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">merge</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">all</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##          name mass species height eye_color
</span></span><span class="line"><span class="cl">## 1       C-3PO   75   Droid    167    yellow
</span></span><span class="line"><span class="cl">## 2 Darth Vader  136   Human    202    yellow
</span></span></code></pre></div><h5 id="full-join">Full-join</h5>
<center><img src="../full_join.png"></center>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">merge</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">all</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##                  name mass species height eye_color
</span></span><span class="line"><span class="cl">## 1  Beru Whitesun lars   NA    &lt;NA&gt;    165      blue
</span></span><span class="line"><span class="cl">## 2   Biggs Darklighter   NA    &lt;NA&gt;    183     brown
</span></span><span class="line"><span class="cl">## 3               C-3PO   75   Droid    167    yellow
</span></span><span class="line"><span class="cl">## 4         Darth Vader  136   Human    202    yellow
</span></span><span class="line"><span class="cl">## 5         Leia Organa   49   Human     NA      &lt;NA&gt;
</span></span><span class="line"><span class="cl">## 6      Luke Skywalker   77   Human     NA      &lt;NA&gt;
</span></span><span class="line"><span class="cl">## 7      Obi-Wan Kenobi   NA    &lt;NA&gt;    182 blue-gray
</span></span><span class="line"><span class="cl">## 8           Owen Lars  120   Human     NA      &lt;NA&gt;
</span></span><span class="line"><span class="cl">## 9               R2-D2   32   Droid     NA      &lt;NA&gt;
</span></span><span class="line"><span class="cl">## 10              R5-D4   NA    &lt;NA&gt;     97       red
</span></span></code></pre></div><h5 id="left-join">Left-join</h5>
<center><img src="../left_join.png"></center>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">merge</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">all.x</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##             name mass species height eye_color
</span></span><span class="line"><span class="cl">## 1          C-3PO   75   Droid    167    yellow
</span></span><span class="line"><span class="cl">## 2    Darth Vader  136   Human    202    yellow
</span></span><span class="line"><span class="cl">## 3    Leia Organa   49   Human     NA      &lt;NA&gt;
</span></span><span class="line"><span class="cl">## 4 Luke Skywalker   77   Human     NA      &lt;NA&gt;
</span></span><span class="line"><span class="cl">## 5      Owen Lars  120   Human     NA      &lt;NA&gt;
</span></span><span class="line"><span class="cl">## 6          R2-D2   32   Droid     NA      &lt;NA&gt;
</span></span></code></pre></div><h5 id="right-join">Right-join</h5>
<center><img src="../right_join.png"></center>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">merge</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">all.y</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##                 name mass species height eye_color
</span></span><span class="line"><span class="cl">## 1 Beru Whitesun lars   NA    &lt;NA&gt;    165      blue
</span></span><span class="line"><span class="cl">## 2  Biggs Darklighter   NA    &lt;NA&gt;    183     brown
</span></span><span class="line"><span class="cl">## 3              C-3PO   75   Droid    167    yellow
</span></span><span class="line"><span class="cl">## 4        Darth Vader  136   Human    202    yellow
</span></span><span class="line"><span class="cl">## 5     Obi-Wan Kenobi   NA    &lt;NA&gt;    182 blue-gray
</span></span><span class="line"><span class="cl">## 6              R5-D4   NA    &lt;NA&gt;     97       red
</span></span></code></pre></div></br>
<h2 id="pacote-dplyr">Pacote <code>dplyr</code></h2>
<ul>
<li><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html" target="_blank" rel="noopener">Vignette - Introduction to <em>dplyr</em></a></li>
<li>O pacote <code>dplyr</code> facilita a manipulação dos dados por meio de funções simples e computacionalmente eficientes</li>
<li>As funções pode, ser organizadas em três categorias:
<ul>
<li>Colunas:
<ul>
<li><code>select()</code>: seleciona (ou retira) as colunas do data frame</li>
<li><code>rename()</code>: muda os nomes das colunas</li>
<li><code>mutate()</code>: cria ou muda os valores nas colunas</li>
</ul>
</li>
<li>Linhas:
<ul>
<li><code>filter()</code>: seleciona linhas de acordo com valores das colunas</li>
<li><code>arrange()</code>: organiza a ordem das linhas</li>
</ul>
</li>
<li>Grupo de linhas:
<ul>
<li><code>summarise()</code>: colapsa um grupo em uma única linha</li>
<li><code>group_by()</code>: agrupa base de dados a partir de uma variável categórica</li>
</ul>
</li>
</ul>
</li>
<li>Nesta subseção, continuaremos utilizando a base de dados de Star Wars (<code>starwars</code>), utilizada na subseção anterior.</li>
<li>Você irá notar que, ao usar essas funções, o data frame é transformado em um <em>tibble</em> que é um formato mais eficiente para tratar dados tabulares, mas que funciona de forma igual a um data frame.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw</span> <span class="o">=</span> <span class="n">starwars</span> <span class="c1"># &#34;limpando&#34; sw com a base original</span>
</span></span></code></pre></div><h3 id="filtro-via-filter">Filtro via <code>filter()</code></h3>
<ul>
<li>Permite selecionar um subconjunto de linhas de um data frame</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">filter(.data, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">.data</span><span class="p">:</span><span class="w"> </span><span class="l">A data frame, data frame extension (e.g. a tibble).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">...	</span><span class="p">:</span><span class="w"> </span><span class="l">Expressions that return a logical value, and are defined in terms of the variables in .data. If multiple expressions are included, they are combined with the &amp; operator. Only rows for which all conditions evaluate to TRUE are kept.</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw1</span> <span class="o">=</span> <span class="nf">filter</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="n">species</span> <span class="o">==</span> <span class="s">&#34;Human&#34;</span><span class="p">,</span> <span class="n">height</span> <span class="o">&gt;=</span> <span class="m">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sw1</span> <span class="c1"># já filtra os NA&#39;s</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 14
</span></span><span class="line"><span class="cl">##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">##  2 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
</span></span><span class="line"><span class="cl">##  3 Leia Or…    150    49 brown      light      brown           19   fema… femin…
</span></span><span class="line"><span class="cl">##  4 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
</span></span><span class="line"><span class="cl">##  5 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
</span></span><span class="line"><span class="cl">##  6 Biggs D…    183    84 black      light      brown           24   male  mascu…
</span></span><span class="line"><span class="cl">##  7 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
</span></span><span class="line"><span class="cl">##  8 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
</span></span><span class="line"><span class="cl">##  9 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
</span></span><span class="line"><span class="cl">## 10 Han Solo    180    80 brown      fair       brown           29   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><h3 id="ordenação-via-arrange">Ordenação via <code>arrange()</code></h3>
<ul>
<li>Reordena as linhas a partir de um conjunto de nomes de coluna</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">arrange(.data, ..., .by_group = FALSE)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">.data</span><span class="p">:</span><span class="w"> </span><span class="l">A data frame, data frame extension (e.g. a tibble).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">... </span><span class="p">:</span><span class="w"> </span><span class="l">Variables, or functions of variables. Use desc() to sort a variable in descending order.</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Se for inserido mais de um nome de variável, organiza de acordo com a 1ª variável e, em caso de ter linhas com o mesmo valor na 1ª variável, ordena estas linhas de mesmo valor de acordo com a 2ª variável</li>
<li>Para usar a ordem decrescente, temos a função <code>desc()</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw2</span> <span class="o">=</span> <span class="nf">arrange</span><span class="p">(</span><span class="n">sw1</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="nf">desc</span><span class="p">(</span><span class="n">mass</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sw2</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 14
</span></span><span class="line"><span class="cl">##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1 Leia Or…    150    49 brown      light      brown             19 fema… femin…
</span></span><span class="line"><span class="cl">##  2 Mon Mot…    150    NA auburn     fair       blue              48 fema… femin…
</span></span><span class="line"><span class="cl">##  3 Cordé       157    NA brown      light      brown             NA fema… femin…
</span></span><span class="line"><span class="cl">##  4 Shmi Sk…    163    NA black      fair       brown             72 fema… femin…
</span></span><span class="line"><span class="cl">##  5 Beru Wh…    165    75 brown      light      blue              47 fema… femin…
</span></span><span class="line"><span class="cl">##  6 Padmé A…    165    45 brown      light      brown             46 fema… femin…
</span></span><span class="line"><span class="cl">##  7 Dormé       165    NA brown      light      brown             NA fema… femin…
</span></span><span class="line"><span class="cl">##  8 Jocasta…    167    NA white      fair       blue              NA fema… femin…
</span></span><span class="line"><span class="cl">##  9 Wedge A…    170    77 brown      fair       hazel             21 male  mascu…
</span></span><span class="line"><span class="cl">## 10 Palpati…    170    75 grey       pale       yellow            82 male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><h3 id="seleção-via-select">Seleção via <code>select()</code></h3>
<ul>
<li>Seleciona colunas que são de interesse.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">select(.data, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">... </span><span class="p">:</span><span class="w"> </span><span class="l">variables in a data frame</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="p">:</span><span class="w"> </span><span class="l">for selecting a range of consecutive variables.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- !<span class="w"> </span><span class="l">for taking the complement of a set of variables.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">c() for combining selections.</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Coloca-se os nomes das colunas desejadas para selecioná-las.</li>
<li>Também é possível selecionar um intervalo de variáveis usando <code>var1:var2</code></li>
<li>Caso queira tirar apenas algumas colunas, basta informar o nome delas precedidas pelo sinal de subtração (<code>-var</code>)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw3</span> <span class="o">=</span> <span class="nf">select</span><span class="p">(</span><span class="n">sw2</span><span class="p">,</span> <span class="n">name</span><span class="o">:</span><span class="n">eye_color</span><span class="p">,</span> <span class="n">sex</span><span class="o">:</span><span class="n">species</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sw3</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 10
</span></span><span class="line"><span class="cl">##    name      height  mass hair_color skin_color eye_color sex   gender homeworld
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    
</span></span><span class="line"><span class="cl">##  1 Leia Org…    150    49 brown      light      brown     fema… femin… Alderaan 
</span></span><span class="line"><span class="cl">##  2 Mon Moth…    150    NA auburn     fair       blue      fema… femin… Chandrila
</span></span><span class="line"><span class="cl">##  3 Cordé        157    NA brown      light      brown     fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  4 Shmi Sky…    163    NA black      fair       brown     fema… femin… Tatooine 
</span></span><span class="line"><span class="cl">##  5 Beru Whi…    165    75 brown      light      blue      fema… femin… Tatooine 
</span></span><span class="line"><span class="cl">##  6 Padmé Am…    165    45 brown      light      brown     fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  7 Dormé        165    NA brown      light      brown     fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  8 Jocasta …    167    NA white      fair       blue      fema… femin… Coruscant
</span></span><span class="line"><span class="cl">##  9 Wedge An…    170    77 brown      fair       hazel     male  mascu… Corellia 
</span></span><span class="line"><span class="cl">## 10 Palpatine    170    75 grey       pale       yellow    male  mascu… Naboo    
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 1 more variable: species &lt;chr&gt;
</span></span></code></pre></div><ul>
<li>Note que o <code>select()</code> pode não funcionar corretamente se o pacote <code>MASS</code> estiver ativo. Caso esteja, retire a seleção do pacote <code>MASS</code> no quadrante inferior/direito em &lsquo;Packages&rsquo; (ou digite <code>detach(&quot;package:MASS&quot;, unload = TRUE)</code>)</li>
<li>Uma outra forma de fazer a seleção de coluna é combinando com <code>starts_with()</code> e <code>ends_with()</code>, que resulta na seleção de colunas que se iniciam e terminam com um texto dado</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span> <span class="nf">select</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="nf">ends_with</span><span class="p">(</span><span class="s">&#34;color&#34;</span><span class="p">))</span> <span class="p">)</span> <span class="c1"># colunas que terminam com color</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 3
</span></span><span class="line"><span class="cl">##   hair_color  skin_color  eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 blond       fair        blue     
</span></span><span class="line"><span class="cl">## 2 &lt;NA&gt;        gold        yellow   
</span></span><span class="line"><span class="cl">## 3 &lt;NA&gt;        white, blue red      
</span></span><span class="line"><span class="cl">## 4 none        white       yellow   
</span></span><span class="line"><span class="cl">## 5 brown       light       brown    
</span></span><span class="line"><span class="cl">## 6 brown, grey light       blue
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span> <span class="nf">select</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="nf">starts_with</span><span class="p">(</span><span class="s">&#34;s&#34;</span><span class="p">))</span> <span class="p">)</span> <span class="c1"># colunas que iniciam com a letra &#34;s&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 4
</span></span><span class="line"><span class="cl">##   skin_color  sex    species starships
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;   &lt;list&gt;   
</span></span><span class="line"><span class="cl">## 1 fair        male   Human   &lt;chr [2]&gt;
</span></span><span class="line"><span class="cl">## 2 gold        none   Droid   &lt;chr [0]&gt;
</span></span><span class="line"><span class="cl">## 3 white, blue none   Droid   &lt;chr [0]&gt;
</span></span><span class="line"><span class="cl">## 4 white       male   Human   &lt;chr [1]&gt;
</span></span><span class="line"><span class="cl">## 5 light       female Human   &lt;chr [0]&gt;
</span></span><span class="line"><span class="cl">## 6 light       male   Human   &lt;chr [0]&gt;
</span></span></code></pre></div><h3 id="renomeação-via-rename">Renomeação via <code>rename()</code></h3>
<ul>
<li>Renomeia colunas usando <code>novo_nome = velho_nome</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">rename(.data, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">.data</span><span class="p">:</span><span class="w"> </span><span class="l">A data frame, data frame extension (e.g. a tibble).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">...	</span><span class="p">:</span><span class="w"> </span><span class="l">Use new_name = old_name to rename selected variables.</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw4</span> <span class="o">=</span> <span class="nf">rename</span><span class="p">(</span><span class="n">sw3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">haircolor</span> <span class="o">=</span> <span class="n">hair_color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">skincolor</span> <span class="o">=</span> <span class="n">skin_color</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">             <span class="n">eyecolor</span> <span class="o">=</span> <span class="n">eye_color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sw4</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 10
</span></span><span class="line"><span class="cl">##    name         height  mass haircolor skincolor eyecolor sex   gender homeworld
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    
</span></span><span class="line"><span class="cl">##  1 Leia Organa     150    49 brown     light     brown    fema… femin… Alderaan 
</span></span><span class="line"><span class="cl">##  2 Mon Mothma      150    NA auburn    fair      blue     fema… femin… Chandrila
</span></span><span class="line"><span class="cl">##  3 Cordé           157    NA brown     light     brown    fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  4 Shmi Skywal…    163    NA black     fair      brown    fema… femin… Tatooine 
</span></span><span class="line"><span class="cl">##  5 Beru Whites…    165    75 brown     light     blue     fema… femin… Tatooine 
</span></span><span class="line"><span class="cl">##  6 Padmé Amida…    165    45 brown     light     brown    fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  7 Dormé           165    NA brown     light     brown    fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  8 Jocasta Nu      167    NA white     fair      blue     fema… femin… Coruscant
</span></span><span class="line"><span class="cl">##  9 Wedge Antil…    170    77 brown     fair      hazel    male  mascu… Corellia 
</span></span><span class="line"><span class="cl">## 10 Palpatine       170    75 grey      pale      yellow   male  mascu… Naboo    
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 1 more variable: species &lt;chr&gt;
</span></span></code></pre></div><h3 id="modificação-via-mutate">Modificação via <code>mutate()</code></h3>
<ul>
<li>Modifica uma coluna se ela já existir</li>
<li>Cria uma coluna se ela não existir</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">mutate(.data, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">.data</span><span class="p">:</span><span class="w"> </span><span class="l">A data frame, data frame extension (e.g. a tibble).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">...	</span><span class="p">:</span><span class="w"> </span><span class="l">Name-value pairs. The name gives the name of the column in the output.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">A vector of length 1, which will be recycled to the correct length.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">A vector the same length as the current group (or the whole data frame if ungrouped).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">NULL, to remove the column.</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw5</span> <span class="o">=</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">sw4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">/</span><span class="m">100</span><span class="p">,</span> <span class="c1"># transf cm p/ metro</span>
</span></span><span class="line"><span class="cl">             <span class="n">BMI</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">/</span> <span class="n">height^2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">dummy</span> <span class="o">=</span> <span class="m">1</span> <span class="c1"># se não for vetor, tudo fica igual</span>
</span></span><span class="line"><span class="cl">             <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sw5</span> <span class="o">=</span> <span class="nf">select</span><span class="p">(</span><span class="n">sw5</span><span class="p">,</span> <span class="n">BMI</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="nf">everything</span><span class="p">())</span> <span class="c1"># reordenação colunas</span>
</span></span><span class="line"><span class="cl"><span class="n">sw5</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 12
</span></span><span class="line"><span class="cl">##      BMI dummy name       height  mass haircolor skincolor eyecolor sex   gender
</span></span><span class="line"><span class="cl">##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1  21.8     1 Leia Orga…   1.5     49 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  2  NA       1 Mon Mothma   1.5     NA auburn    fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  3  NA       1 Cordé        1.57    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  4  NA       1 Shmi Skyw…   1.63    NA black     fair      brown    fema… femin…
</span></span><span class="line"><span class="cl">##  5  27.5     1 Beru Whit…   1.65    75 brown     light     blue     fema… femin…
</span></span><span class="line"><span class="cl">##  6  16.5     1 Padmé Ami…   1.65    45 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  7  NA       1 Dormé        1.65    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  8  NA       1 Jocasta Nu   1.67    NA white     fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  9  26.6     1 Wedge Ant…   1.7     77 brown     fair      hazel    male  mascu…
</span></span><span class="line"><span class="cl">## 10  26.0     1 Palpatine    1.7     75 grey      pale      yellow   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><h3 id="operador-pipe-">Operador Pipe <code>%&gt;%</code></h3>
<ul>
<li>Note que todas as funções do pacote <code>dyplr</code> anteriores têm como 1º argumento a base de dados (<code>.data</code>), e isto não é por acaso.</li>
<li>O operador pipe <code>%&gt;%</code> joga um data frame (escrito à sua esquerda) no 1º argumento da função seguinte (à sua direita).</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">filter</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="n">species</span><span class="o">==</span><span class="s">&#34;Droid&#34;</span><span class="p">)</span> <span class="c1"># sem operador pipe</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 14
</span></span><span class="line"><span class="cl">##   name   height  mass hair_color skin_color  eye_color birth_year sex   gender  
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;   
</span></span><span class="line"><span class="cl">## 1 C-3PO     167    75 &lt;NA&gt;       gold        yellow           112 none  masculi…
</span></span><span class="line"><span class="cl">## 2 R2-D2      96    32 &lt;NA&gt;       white, blue red               33 none  masculi…
</span></span><span class="line"><span class="cl">## 3 R5-D4      97    32 &lt;NA&gt;       white, red  red               NA none  masculi…
</span></span><span class="line"><span class="cl">## 4 IG-88     200   140 none       metal       red               15 none  masculi…
</span></span><span class="line"><span class="cl">## 5 R4-P17     96    NA none       silver, red red, blue         NA none  feminine
</span></span><span class="line"><span class="cl">## 6 BB8        NA    NA none       none        black             NA none  masculi…
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw</span> <span class="o">%&gt;%</span> <span class="nf">filter</span><span class="p">(</span><span class="n">species</span><span class="o">==</span><span class="s">&#34;Droid&#34;</span><span class="p">)</span> <span class="c1"># com operador pipe</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 14
</span></span><span class="line"><span class="cl">##   name   height  mass hair_color skin_color  eye_color birth_year sex   gender  
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;   
</span></span><span class="line"><span class="cl">## 1 C-3PO     167    75 &lt;NA&gt;       gold        yellow           112 none  masculi…
</span></span><span class="line"><span class="cl">## 2 R2-D2      96    32 &lt;NA&gt;       white, blue red               33 none  masculi…
</span></span><span class="line"><span class="cl">## 3 R5-D4      97    32 &lt;NA&gt;       white, red  red               NA none  masculi…
</span></span><span class="line"><span class="cl">## 4 IG-88     200   140 none       metal       red               15 none  masculi…
</span></span><span class="line"><span class="cl">## 5 R4-P17     96    NA none       silver, red red, blue         NA none  feminine
</span></span><span class="line"><span class="cl">## 6 BB8        NA    NA none       none        black             NA none  masculi…
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><ul>
<li>Observe que, ao usar o operador pipe, o 1º argumento com a base de dados não deve ser preenchida (já está sendo aplicada automaticamente via <code>%&gt;%</code>).</li>
<li>Note que, desde a subseção com a função <code>filter()</code> até <code>mutate()</code> fomos &ldquo;acumulando&rdquo; as alterações em novos data frames, ou seja, o último data frame <code>starwars5</code> é a base original <code>starwars</code> que foi alterada por <code>filter()</code>, <code>arrange()</code>, <code>select()</code>, <code>rename()</code> e <code>mutate()</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw1</span> <span class="o">=</span> <span class="nf">filter</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="n">species</span> <span class="o">==</span> <span class="s">&#34;Human&#34;</span><span class="p">,</span> <span class="n">height</span> <span class="o">&gt;=</span> <span class="m">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sw2</span> <span class="o">=</span> <span class="nf">arrange</span><span class="p">(</span><span class="n">sw1</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="nf">desc</span><span class="p">(</span><span class="n">mass</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sw3</span> <span class="o">=</span> <span class="nf">select</span><span class="p">(</span><span class="n">sw2</span><span class="p">,</span> <span class="n">name</span><span class="o">:</span><span class="n">eye_color</span><span class="p">,</span> <span class="n">sex</span><span class="o">:</span><span class="n">species</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sw4</span> <span class="o">=</span> <span class="nf">rename</span><span class="p">(</span><span class="n">sw3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">haircolor</span> <span class="o">=</span> <span class="n">hair_color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">skincolor</span> <span class="o">=</span> <span class="n">skin_color</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">             <span class="n">eyecolor</span> <span class="o">=</span> <span class="n">eye_color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sw5</span> <span class="o">=</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">sw4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">/</span><span class="m">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">BMI</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">/</span> <span class="n">height^2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">dummy</span> <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">             <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sw5</span> <span class="o">=</span> <span class="nf">select</span><span class="p">(</span><span class="n">sw5</span><span class="p">,</span> <span class="n">BMI</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="nf">everything</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">sw5</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 12
</span></span><span class="line"><span class="cl">##      BMI dummy name       height  mass haircolor skincolor eyecolor sex   gender
</span></span><span class="line"><span class="cl">##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1  21.8     1 Leia Orga…   1.5     49 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  2  NA       1 Mon Mothma   1.5     NA auburn    fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  3  NA       1 Cordé        1.57    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  4  NA       1 Shmi Skyw…   1.63    NA black     fair      brown    fema… femin…
</span></span><span class="line"><span class="cl">##  5  27.5     1 Beru Whit…   1.65    75 brown     light     blue     fema… femin…
</span></span><span class="line"><span class="cl">##  6  16.5     1 Padmé Ami…   1.65    45 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  7  NA       1 Dormé        1.65    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  8  NA       1 Jocasta Nu   1.67    NA white     fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  9  26.6     1 Wedge Ant…   1.7     77 brown     fair      hazel    male  mascu…
</span></span><span class="line"><span class="cl">## 10  26.0     1 Palpatine    1.7     75 grey      pale      yellow   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><ul>
<li>Usando o operador pipe <code>%&gt;%</code> várias vezes, podemos ir pegando o output resultante da aplicação de uma função e jogar como input da função seguinte. Reescreveremos o código acima &ldquo;em única linha&rdquo; com <code>%&gt;%</code>, chegando ao mesmo data frame de <code>starwars5</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sw_pipe</span> <span class="o">=</span> <span class="n">sw</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">filter</span><span class="p">(</span><span class="n">species</span> <span class="o">==</span> <span class="s">&#34;Human&#34;</span><span class="p">,</span> <span class="n">height</span> <span class="o">&gt;=</span> <span class="m">100</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">arrange</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="nf">desc</span><span class="p">(</span><span class="n">mass</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="n">name</span><span class="o">:</span><span class="n">eye_color</span><span class="p">,</span> <span class="n">sex</span><span class="o">:</span><span class="n">species</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">rename</span><span class="p">(</span><span class="n">haircolor</span> <span class="o">=</span> <span class="n">hair_color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">skincolor</span> <span class="o">=</span> <span class="n">skin_color</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">           <span class="n">eyecolor</span> <span class="o">=</span> <span class="n">eye_color</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">/</span><span class="m">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">BMI</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">/</span> <span class="n">height^2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">dummy</span> <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">           <span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="n">BMI</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="nf">everything</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">sw_pipe</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 12
</span></span><span class="line"><span class="cl">##      BMI dummy name       height  mass haircolor skincolor eyecolor sex   gender
</span></span><span class="line"><span class="cl">##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1  21.8     1 Leia Orga…   1.5     49 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  2  NA       1 Mon Mothma   1.5     NA auburn    fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  3  NA       1 Cordé        1.57    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  4  NA       1 Shmi Skyw…   1.63    NA black     fair      brown    fema… femin…
</span></span><span class="line"><span class="cl">##  5  27.5     1 Beru Whit…   1.65    75 brown     light     blue     fema… femin…
</span></span><span class="line"><span class="cl">##  6  16.5     1 Padmé Ami…   1.65    45 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  7  NA       1 Dormé        1.65    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  8  NA       1 Jocasta Nu   1.67    NA white     fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  9  26.6     1 Wedge Ant…   1.7     77 brown     fair      hazel    male  mascu…
</span></span><span class="line"><span class="cl">## 10  26.0     1 Palpatine    1.7     75 grey      pale      yellow   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">all</span><span class="p">(</span><span class="n">sw_pipe</span> <span class="o">==</span> <span class="n">sw5</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># verificando se todos elementos são iguais</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] TRUE
</span></span></code></pre></div><h3 id="resumo-via-summarise">Resumo via <code>summarise()</code></h3>
<ul>
<li>Podemos usar a função <code>summarise()</code> para gerar alguma estatística acerca de uma ou mais variáveis:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">n_obs</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="n">height_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">mass_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 1 × 3
</span></span><span class="line"><span class="cl">##   n_obs height_mean mass_mean
</span></span><span class="line"><span class="cl">##   &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1    87        174.      97.3
</span></span></code></pre></div><ul>
<li>No caso acima, gerou simplesmente o tamanho da amostra e as médias de altura e de massa considerando a amostra inteira de <code>starwars</code> (o que não foi muito útil).</li>
</ul>
<h3 id="agrupamento-via-group_by">Agrupamento via <code>group_by()</code></h3>
<ul>
<li>Diferente das outras funções do <code>dplyr</code> mostradas até agora, o output do <code>group_by</code> não altera conteúdo do data frame, apenas <strong>transforma em uma base de dados agrupada</strong> em categorias de uma dada variável</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">grouped_sw</span> <span class="o">=</span> <span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">sex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">grouped_sw</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] &#34;grouped_df&#34; &#34;tbl_df&#34;     &#34;tbl&#34;        &#34;data.frame&#34;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">starwars</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 14
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">## 2 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
</span></span><span class="line"><span class="cl">## 3 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
</span></span><span class="line"><span class="cl">## 4 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
</span></span><span class="line"><span class="cl">## 5 Leia Org…    150    49 brown      light      brown           19   fema… femin…
</span></span><span class="line"><span class="cl">## 6 Owen Lars    178   120 brown, gr… light      blue            52   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">grouped_sw</span><span class="p">)</span> <span class="c1"># agrupado por sexo</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 14
</span></span><span class="line"><span class="cl">## # Groups:   sex [3]
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">## 2 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
</span></span><span class="line"><span class="cl">## 3 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
</span></span><span class="line"><span class="cl">## 4 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
</span></span><span class="line"><span class="cl">## 5 Leia Org…    150    49 brown      light      brown           19   fema… femin…
</span></span><span class="line"><span class="cl">## 6 Owen Lars    178   120 brown, gr… light      blue            52   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><ul>
<li>O <code>group_by()</code> prepara o data frame para operações que consideram várias linhas. Como exemplo, vamos criar uma coluna com a soma de <code>mass</code> de todas observações</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">mass_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="n">mass_mean</span><span class="p">,</span> <span class="n">sex</span><span class="p">,</span> <span class="nf">everything</span><span class="p">())</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">head</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 10 × 15
</span></span><span class="line"><span class="cl">##    mass_mean sex   name  height  mass hair_color skin_color eye_color birth_year
</span></span><span class="line"><span class="cl">##        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1      97.3 male  Luke…    172    77 blond      fair       blue            19  
</span></span><span class="line"><span class="cl">##  2      97.3 none  C-3PO    167    75 &lt;NA&gt;       gold       yellow         112  
</span></span><span class="line"><span class="cl">##  3      97.3 none  R2-D2     96    32 &lt;NA&gt;       white, bl… red             33  
</span></span><span class="line"><span class="cl">##  4      97.3 male  Dart…    202   136 none       white      yellow          41.9
</span></span><span class="line"><span class="cl">##  5      97.3 fema… Leia…    150    49 brown      light      brown           19  
</span></span><span class="line"><span class="cl">##  6      97.3 male  Owen…    178   120 brown, gr… light      blue            52  
</span></span><span class="line"><span class="cl">##  7      97.3 fema… Beru…    165    75 brown      light      blue            47  
</span></span><span class="line"><span class="cl">##  8      97.3 none  R5-D4     97    32 &lt;NA&gt;       white, red red             NA  
</span></span><span class="line"><span class="cl">##  9      97.3 male  Bigg…    183    84 black      light      brown           24  
</span></span><span class="line"><span class="cl">## 10      97.3 male  Obi-…    182    77 auburn, w… fair       blue-gray       57  
</span></span><span class="line"><span class="cl">## # ℹ 6 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
</span></span><span class="line"><span class="cl">## #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><ul>
<li>Note que todos os valores de <code>mass_mean</code> são iguais. Agora, agruparemos por <code>sex</code> antes de fazer a soma:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">group_by</span><span class="p">(</span><span class="n">sex</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">mass_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">ungroup</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="c1"># Lembre-se sempre de desagrupar depois!</span>
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="n">mass_mean</span><span class="p">,</span> <span class="n">sex</span><span class="p">,</span> <span class="nf">everything</span><span class="p">())</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">head</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 10 × 15
</span></span><span class="line"><span class="cl">##    mass_mean sex   name  height  mass hair_color skin_color eye_color birth_year
</span></span><span class="line"><span class="cl">##        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1      81.0 male  Luke…    172    77 blond      fair       blue            19  
</span></span><span class="line"><span class="cl">##  2      69.8 none  C-3PO    167    75 &lt;NA&gt;       gold       yellow         112  
</span></span><span class="line"><span class="cl">##  3      69.8 none  R2-D2     96    32 &lt;NA&gt;       white, bl… red             33  
</span></span><span class="line"><span class="cl">##  4      81.0 male  Dart…    202   136 none       white      yellow          41.9
</span></span><span class="line"><span class="cl">##  5      54.7 fema… Leia…    150    49 brown      light      brown           19  
</span></span><span class="line"><span class="cl">##  6      81.0 male  Owen…    178   120 brown, gr… light      blue            52  
</span></span><span class="line"><span class="cl">##  7      54.7 fema… Beru…    165    75 brown      light      blue            47  
</span></span><span class="line"><span class="cl">##  8      69.8 none  R5-D4     97    32 &lt;NA&gt;       white, red red             NA  
</span></span><span class="line"><span class="cl">##  9      81.0 male  Bigg…    183    84 black      light      brown           24  
</span></span><span class="line"><span class="cl">## 10      81.0 male  Obi-…    182    77 auburn, w… fair       blue-gray       57  
</span></span><span class="line"><span class="cl">## # ℹ 6 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
</span></span><span class="line"><span class="cl">## #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><ul>
<li>Note que, agora, a coluna <code>mass_mean</code> tem valores diferentes de acordo com o sexo da observação.</li>
<li>Isso é útil em algumas aplicações econômicas em que consideramos variáveis a nível de grupo (e.g. domicílio) a qual uma observação (e.g. morador) pertence.</li>
</ul>
<blockquote>
<p><strong>Evite potenciais erros</strong>: Sempre que usar <code>group_by()</code>, não se esqueça de desagrupar o data frame via função <code>ungroup()</code> após realizar a operações desejadas.</p>
</blockquote>
<h3 id="resumo-por-grupo-via-group_by-e-summarise">Resumo por grupo via <code>group_by()</code> e <code>summarise()</code></h3>
<ul>
<li>A função <code>summarise()</code> é de fato útil quando combinada com a função <code>group_by()</code>, pois conseguimos obter as estatísticas de grupos:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">summary_sw</span> <span class="o">=</span> <span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">sex</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">n_obs</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">height_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">mass_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">summary_sw</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 5 × 4
</span></span><span class="line"><span class="cl">##   sex            n_obs height_mean mass_mean
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;          &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1 female            16        169.      54.7
</span></span><span class="line"><span class="cl">## 2 hermaphroditic     1        175     1358  
</span></span><span class="line"><span class="cl">## 3 male              60        179.      81.0
</span></span><span class="line"><span class="cl">## 4 none               6        131.      69.8
</span></span><span class="line"><span class="cl">## 5 &lt;NA&gt;               4        181.      48
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">summary_sw</span><span class="p">)</span> <span class="c1"># ao usar summary, deixa de ser agrupada</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] &#34;tbl_df&#34;     &#34;tbl&#34;        &#34;data.frame&#34;
</span></span></code></pre></div><ul>
<li>Note que, ao usar <code>summarise()</code>, o data frame resultante não é agrupado e, portanto, não é necessário usar <code>ungroup()</code> neste caso.</li>
<li>Também é possível adicionar mais de uma variável para agrupar:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">sex</span><span class="p">,</span> <span class="n">hair_color</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">n_obs</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">height_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">mass_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## `summarise()` has grouped output by &#39;sex&#39;. You can override using the `.groups`
</span></span><span class="line"><span class="cl">## argument.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 23 × 5
</span></span><span class="line"><span class="cl">## # Groups:   sex [5]
</span></span><span class="line"><span class="cl">##    sex            hair_color    n_obs height_mean mass_mean
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;          &lt;chr&gt;         &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1 female         auburn            1        150      NaN  
</span></span><span class="line"><span class="cl">##  2 female         black             3        166.      53.1
</span></span><span class="line"><span class="cl">##  3 female         blonde            1        168       55  
</span></span><span class="line"><span class="cl">##  4 female         brown             6        160.      56.3
</span></span><span class="line"><span class="cl">##  5 female         none              4        188.      54  
</span></span><span class="line"><span class="cl">##  6 female         white             1        167      NaN  
</span></span><span class="line"><span class="cl">##  7 hermaphroditic &lt;NA&gt;              1        175     1358  
</span></span><span class="line"><span class="cl">##  8 male           auburn, grey      1        180      NaN  
</span></span><span class="line"><span class="cl">##  9 male           auburn, white     1        182       77  
</span></span><span class="line"><span class="cl">## 10 male           black             9        176.      81.0
</span></span><span class="line"><span class="cl">## # ℹ 13 more rows
</span></span></code></pre></div><ul>
<li>Para agrupar variáveis <strong>contínuas</strong>, precisamos definir intervalos usando a função <code>cut()</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">cut(x, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="l">a numeric vector which is to be converted to a factor by cutting.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">breaks</span><span class="p">:</span><span class="w"> </span><span class="l">either a numeric vector of two or more unique cut points or a single number (greater than or equal to 2) giving the number of intervals into which x is to be cut.</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># breaks com um integer = qtd desejada de grupos</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="nf">cut</span><span class="p">(</span><span class="n">birth_year</span><span class="p">,</span> <span class="n">breaks</span><span class="o">=</span><span class="m">5</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">n_obs</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">height_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 5 × 3
</span></span><span class="line"><span class="cl">##   `cut(birth_year, breaks = 5)` n_obs height_mean
</span></span><span class="line"><span class="cl">##   &lt;fct&gt;                         &lt;int&gt;       &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1 (7.11,186]                       40        175.
</span></span><span class="line"><span class="cl">## 2 (186,363]                         1        228 
</span></span><span class="line"><span class="cl">## 3 (541,718]                         1        175 
</span></span><span class="line"><span class="cl">## 4 (718,897]                         1         66 
</span></span><span class="line"><span class="cl">## 5 &lt;NA&gt;                             44        176.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># breaks com um vetor = quebras dos intervalos dos grupos</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">birth_year</span><span class="o">=</span><span class="nf">cut</span><span class="p">(</span><span class="n">birth_year</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                          <span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">40</span><span class="p">,</span> <span class="m">90</span><span class="p">,</span> <span class="m">200</span><span class="p">,</span> <span class="m">900</span><span class="p">)))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">n_obs</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">height_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 5 × 3
</span></span><span class="line"><span class="cl">##   birth_year n_obs height_mean
</span></span><span class="line"><span class="cl">##   &lt;fct&gt;      &lt;int&gt;       &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1 (0,40]        13        164.
</span></span><span class="line"><span class="cl">## 2 (40,90]       22        179.
</span></span><span class="line"><span class="cl">## 3 (90,200]       6        192.
</span></span><span class="line"><span class="cl">## 4 (200,900]      2        120.
</span></span><span class="line"><span class="cl">## 5 &lt;NA&gt;          44        176.
</span></span></code></pre></div><ul>
<li>Note que inserimos <code>birth_year=cut(birth_year, ...)</code> para que o nome da coluna ficasse <code>birth_year</code>, caso contrário a coluna ficaria com o nome <code>cut(birth_year, ...)</code>.</li>
</ul>
<h3 id="junção-via-__join_">Junção via <em>_join()</em></h3>
<ul>
<li>Vimos anteriormente que, para agrupar bases de dados a partir de variáveis-chave, podemos usar a função <code>merge()</code>.</li>
<li>O pacote <code>dplyr</code> fornece uma família de funções <em>join</em> que executam o mesmo comando que <code>merge()</code>, porém, ao invés de alterar o valor de um argumento, você precisa escolher uma das funções <em>join</em> que podem ser resumidas na seguinte figura:</li>
</ul>
<center><img src="../dplyr-data-join-functions.png"></center>
<ul>
<li>Todas as funções possuem a mesma sintaxe:
<ul>
<li><code>x</code>: base 1</li>
<li><code>y</code>: base 2</li>
<li><code>by</code>: vetor de variáveis-chave</li>
<li><code>suffix</code>: vetor de 2 sufixos para incluir em colunas de mesmos nomes</li>
</ul>
</li>
<li>Como exemplo, usaremos subconjuntos da base de dados <code>starwars</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">bd1</span> <span class="o">=</span> <span class="n">starwars[1</span><span class="o">:</span><span class="m">6</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">11</span><span class="p">)</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bd1</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 3
</span></span><span class="line"><span class="cl">##   name            mass species
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;  
</span></span><span class="line"><span class="cl">## 1 Luke Skywalker    77 Human  
</span></span><span class="line"><span class="cl">## 2 C-3PO             75 Droid  
</span></span><span class="line"><span class="cl">## 3 R2-D2             32 Droid  
</span></span><span class="line"><span class="cl">## 4 Darth Vader      136 Human  
</span></span><span class="line"><span class="cl">## 5 Leia Organa       49 Human  
</span></span><span class="line"><span class="cl">## 6 Owen Lars        120 Human
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">bd2</span> <span class="o">=</span> <span class="n">starwars</span><span class="nf">[c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">7</span><span class="o">:</span><span class="m">10</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span> <span class="m">6</span><span class="p">)</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bd2</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 3
</span></span><span class="line"><span class="cl">##   name               height eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;               &lt;int&gt; &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 C-3PO                 167 yellow   
</span></span><span class="line"><span class="cl">## 2 Darth Vader           202 yellow   
</span></span><span class="line"><span class="cl">## 3 Beru Whitesun lars    165 blue     
</span></span><span class="line"><span class="cl">## 4 R5-D4                  97 red      
</span></span><span class="line"><span class="cl">## 5 Biggs Darklighter     183 brown    
</span></span><span class="line"><span class="cl">## 6 Obi-Wan Kenobi        182 blue-gray
</span></span></code></pre></div><ul>
<li>Note que há 12 personagens únicos em ambas bases, mas apenas &ldquo;C-3PO&rdquo; e &ldquo;Darth Vader&rdquo; são observações comuns.</li>
<li><code>inner_join()</code>: mantém apenas ID&rsquo;s presentes simultaneamente em ambas bases</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">inner_join</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 2 × 5
</span></span><span class="line"><span class="cl">##   name         mass species height eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 C-3PO          75 Droid      167 yellow   
</span></span><span class="line"><span class="cl">## 2 Darth Vader   136 Human      202 yellow
</span></span></code></pre></div><ul>
<li><code>full_join()</code>: mantém todas ID&rsquo;s, mesmo que estejam em apenas em um das bases</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">full_join</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 10 × 5
</span></span><span class="line"><span class="cl">##    name                mass species height eye_color
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    
</span></span><span class="line"><span class="cl">##  1 Luke Skywalker        77 Human       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">##  2 C-3PO                 75 Droid      167 yellow   
</span></span><span class="line"><span class="cl">##  3 R2-D2                 32 Droid       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">##  4 Darth Vader          136 Human      202 yellow   
</span></span><span class="line"><span class="cl">##  5 Leia Organa           49 Human       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">##  6 Owen Lars            120 Human       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">##  7 Beru Whitesun lars    NA &lt;NA&gt;       165 blue     
</span></span><span class="line"><span class="cl">##  8 R5-D4                 NA &lt;NA&gt;        97 red      
</span></span><span class="line"><span class="cl">##  9 Biggs Darklighter     NA &lt;NA&gt;       183 brown    
</span></span><span class="line"><span class="cl">## 10 Obi-Wan Kenobi        NA &lt;NA&gt;       182 blue-gray
</span></span></code></pre></div><ul>
<li><code>left_join()</code>: mantém apenas ID&rsquo;s presentes na base 1 (informada como <code>x</code>)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">left_join</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 5
</span></span><span class="line"><span class="cl">##   name            mass species height eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 Luke Skywalker    77 Human       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">## 2 C-3PO             75 Droid      167 yellow   
</span></span><span class="line"><span class="cl">## 3 R2-D2             32 Droid       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">## 4 Darth Vader      136 Human      202 yellow   
</span></span><span class="line"><span class="cl">## 5 Leia Organa       49 Human       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">## 6 Owen Lars        120 Human       NA &lt;NA&gt;
</span></span></code></pre></div><ul>
<li><code>right_join()</code>: mantém apenas ID&rsquo;s presentes na base 2 (informada como <code>y</code>)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">right_join</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 5
</span></span><span class="line"><span class="cl">##   name                mass species height eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 C-3PO                 75 Droid      167 yellow   
</span></span><span class="line"><span class="cl">## 2 Darth Vader          136 Human      202 yellow   
</span></span><span class="line"><span class="cl">## 3 Beru Whitesun lars    NA &lt;NA&gt;       165 blue     
</span></span><span class="line"><span class="cl">## 4 R5-D4                 NA &lt;NA&gt;        97 red      
</span></span><span class="line"><span class="cl">## 5 Biggs Darklighter     NA &lt;NA&gt;       183 brown    
</span></span><span class="line"><span class="cl">## 6 Obi-Wan Kenobi        NA &lt;NA&gt;       182 blue-gray
</span></span></code></pre></div></br>


<ul class="cta-group">
  
  <li>
    <a href="../sec4"  class="btn btn-primary px-3 py-3">👉 Proceed to Data Visualization</a>
  </li>
  
  
</ul>



        </article>

        





        



        
        
        <div class="article-widget">
          
<div class="post-nav">
  
  
</div>

        </div>
        
      </div>

      <div class="body-footer">
        <p>Last updated on Sep 9, 2018</p>

        




        




        


      </div>

      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2023 Me. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  


<script src="/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js"></script>




  

  
  

  









<script src="https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
<script>
  anchors.add();
</script>





  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  







<script id="page-data" type="application/json">{"use_headroom":false}</script>












  
  


<script src="/en/js/wowchemy.min.e8ee06ba8371980ffde659871dd593b0.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>


















</body>
</html>
