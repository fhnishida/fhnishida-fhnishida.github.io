<!DOCTYPE html>
<!-- This site was created with Wowchemy. https://www.wowchemy.com -->
<!-- Last Published: July 24, 2023 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.7.0 for Hugo" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css" integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.0f229d4b7ebad1917a9a357cba2effab.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  


























  
  
  






  <meta name="author" content="Fábio Nishida" />





  

<meta name="description" content="The author covers topics such as grid search and steepest ascent methods for optimization to show three approaches to reach the OLS estimation formula. The page also includes examples and code snippets to illustrate the concepts discussed." />



<link rel="alternate" hreflang="en-us" href="https://fhnishida.netlify.app/project/rec2301/sec10/" />
<link rel="canonical" href="https://fhnishida.netlify.app/project/rec2301/sec10/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#1565c0" />










  
  






<meta property="twitter:card" content="summary" />

  <meta property="twitter:site" content="@wowchemy" />
  <meta property="twitter:creator" content="@wowchemy" />
<meta property="twitter:image" content="https://fhnishida.netlify.app/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_512x512_fill_lanczos_center_3.png" />
<meta property="og:site_name" content="Fábio Nishida" />
<meta property="og:url" content="https://fhnishida.netlify.app/project/rec2301/sec10/" />
<meta property="og:title" content="(Extra) Otimização Numérica | Fábio Nishida" />
<meta property="og:description" content="The author covers topics such as grid search and steepest ascent methods for optimization to show three approaches to reach the OLS estimation formula. The page also includes examples and code snippets to illustrate the concepts discussed." /><meta property="og:image" content="https://fhnishida.netlify.app/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />

  
    <meta property="og:updated_time" content="2018-09-09T00:00:00&#43;00:00" />
  










  
  
  

  
  
    <link rel="alternate" href="/project/rec2301/sec10/index.xml" type="application/rss+xml" title="Fábio Nishida" />
  

  


  
  <title>(Extra) Otimização Numérica | Fábio Nishida</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="9b82f56b956679f748ad872e7c5ffac8" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Fábio Nishida</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Fábio Nishida</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Teaching Assistance</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#featured"><span>Publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="/#contact"  aria-label="envelope">
                <i class="fas fa-envelope" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
        
          Principal
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      <ul class="nav docs-sidenav">
        <li><a href="/project/"><i class="fas fa-arrow-left pr-1"></i>Projects</a></li>
      </ul>

      
      
        
          
        
      


  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/"><i class="fas fa-book pr-1"></i>Principal</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/project/rec2301/">----------------------</a></li>



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec1/">Ferramentas do R</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec2/">Programação em R</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec3/">Manipulação de Dados</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec4/">Manipulação via dplyr</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec6/">Distribuições</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec5/">Visualização de Dados</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec7/">Regressão Simples</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec8/">Regressão Múltipla</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec9/">Testes de Hipótese</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link  active" href="/project/rec2301/sec10/">Otimização Numérica</a>
    

    
      </div>
    

      
        </ul>
      
    

    
      </div>
    

    
  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      












      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#otimização-numérica">Otimização numérica</a>
      <ul>
        <li><a href="#_grid-search_"><em>Grid Search</em></a></li>
        <li><a href="#_gradient-ascent-descent_"><em>Gradient Ascent (Descent)</em></a></li>
      </ul>
    </li>
    <li><a href="#encontrando-mqo-por-diferentes-estratégias">Encontrando MQO por diferentes estratégias</a>
      <ul>
        <li><a href="#base-mtcars">Base <code>mtcars</code></a></li>
        <li><a href="#a-minimização-da-função-perda">(a) Minimização da função perda</a></li>
        <li><a href="#b-máxima-verossimilhança">(b) Máxima Verossimilhança</a></li>
        <li><a href="#c-método-dos-momentos">(c) Método dos Momentos</a></li>
      </ul>
    </li>
  </ul>
</nav>

      











    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <div class="docs-article-container">
        
      </div>

      
      
      

      <div class="docs-article-container">
        
        <h1>(Extra) Otimização Numérica</h1>

        <article class="article-style">

          
          

          <h2 id="otimização-numérica">Otimização numérica</h2>
<ul>
<li>Essa seção tem o objetivo para dar uma intuição sobre métodos de otimização.</li>
<li>Veremos os métodos de <em>grid search</em> e <em>gradient ascent</em> (<em>descent</em>) que representam famílias de métodos de otimização.</li>
</ul>
<h3 id="_grid-search_"><em>Grid Search</em></h3>
<ul>
<li>O método mais simples de otimização numérica é o <em>grid search</em> (discretização).</li>
<li>Como o R não lida com problemas com infinitos valores, uma forma lidar com isso é discretizando diversos possíveis valores dos parâmetros de escolha dentro de intervalos.</li>
<li>Para cada possível combinação de parâmetros, calculam-se diversos valores a partir da função objetivo. De todos os valores calculados, escolhe-se a combinação de parâmetros que maximizam (ou minimizam) a função objetivo.</li>
<li>O exemplo abaixo considera apenas um parâmetro de escolha 

$\theta$ e, para cada ponto escolhido dentro do intervalo 

$[-1, 1]$, calcula-se a função objetivo:</li>
</ul>
<center><img src="../grid_search.png"></center>
<ul>
<li>Este é um método robusto a funções com descontinuidades e quinas (não diferenciáveis), e menos sensível a chutes de valores iniciais. (ver método abaixo)</li>
<li>Porém, este método fica preciso apenas com maiores quantidades de pontos e, como é necessário fazer o cálculo da função objetivo para cada ponto, o <em>grid search</em> tende a ser menos eficiente computacionalmente (demora mais tempo para calcular).</li>
</ul>
<h3 id="_gradient-ascent-descent_"><em>Gradient Ascent (Descent)</em></h3>
<ul>
<li>Conforme o número de parâmetros do modelo cresce, aumenta o número de possíveis combinações entre parâmetros e torna o processo computacional cada vez mais lento.</li>
<li>Uma forma mais eficiente de encontrar o conjunto de parâmetros que otimizam a função objetivo é por meio do método <em>gradient ascent</em> (<em>descent</em>).</li>
<li>Queremos encontrar o 

${\theta}^{**}$ que é o parâmetro que maximiza globalmente a função objetivo</li>
<li>Passos para encontrar um máximo:
<ol>
<li>Comece com algum valor inicial de parâmetro, 

${\theta}^0$</li>
<li>Calcula-se a derivada e avalia-se a possibilidade de &ldquo;andar para cima&rdquo; a um valor mais alto</li>
<li>Caso possa, ande na direção correta a 

${\theta}^1$</li>
<li>Repita os passos (2) e (3), andando para um novo 

${\theta}^2, {\theta}^3, ...$ até atingir um ponto máximo cuja derivada é igual a zero.</li>
</ol>
</li>
</ul>
<center><img src="../steepest_ascent.png"></center>
<ul>
<li>Note que esse método de otimização é sensível ao parâmetro inicial e às descontinuidades da função objetivo.
<ul>
<li>No exemplo, se os chutes iniciais forem 

${\theta}^0_A$ ou 

${\theta}^0_B$, então consegue atingir o máximo global.</li>
<li>Já se o chute inicial for 

${\theta}^0_C$, então ele acaba atingindo um máximo local com 

${\theta}^*$ (menor do que o máximo global em 

${\theta}^{**}$).</li>
</ul>
</li>
</ul>
<video width="500px" height="500px" controls="controls"/>
    <source src="../local-maxima.mp4" type="video/mp4">
</video>
<ul>
<li>Por outro lado, é um método mais eficiente, pois calcula-se a função objetivo uma vez a cada passo, além de ser mais preciso nas estimações.</li>
</ul>
</br>
<h2 id="encontrando-mqo-por-diferentes-estratégias">Encontrando MQO por diferentes estratégias</h2>
<ul>
<li>Nesta seção, encontraremos as estimativas de MQO usando as estratégias da (a) minimização da função perda, de (b) máxima verossimilhança e de (c) método dos momentos.</li>
<li>Em cada uma delas, usaremos uma função objetivo distinta para encontrar o vetor com dois parâmetros, 

$ \boldsymbol{\theta} = \{ \beta_0, \beta_1 \} $, que a otimiza. No R, vamos chamar esse vetor de <code>params</code>.</li>
</ul>
<h3 id="base-mtcars">Base <code>mtcars</code></h3>
<p>É necessário carregar o pacote <code>dplyr</code> para manipulação da base de dados abaixo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
</span></span></code></pre></div><p>Usaremos dados extraídos da <em>Motor Trend</em> US magazine de 1974, que analisa o
consumo de combustível e 10 aspectos técnicos de 32 automóveis.</p>
<p>No <em>R</em>, a base de dados já está incorporada ao programa e pode ser acessada pelo código <code>mtcars</code>, contendo a seguinte estrutura:</p>
<blockquote>
<ul>
<li><em>mpg</em>: milhas por galão</li>
<li><em>hp</em>: cavalos-vapor bruto</li>
</ul>
</blockquote>
<p>Queremos estimar o seguinte modelo:


 $$ \text{mpg} = \beta_0 + \beta_1 \text{hp} + \varepsilon $$ </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">## Regressao MQO</span>
</span></span><span class="line"><span class="cl"><span class="n">reg</span> <span class="o">=</span> <span class="nf">lm</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">mpg</span> <span class="o">~</span> <span class="n">hp</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span><span class="o">$</span><span class="n">coef</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##                Estimate Std. Error   t value     Pr(&gt;|t|)
</span></span><span class="line"><span class="cl">## (Intercept) 30.09886054  1.6339210 18.421246 6.642736e-18
</span></span><span class="line"><span class="cl">## hp          -0.06822828  0.0101193 -6.742389 1.787835e-07
</span></span></code></pre></div><h3 id="a-minimização-da-função-perda">(a) Minimização da função perda</h3>
<ul>
<li>A função perda adotada pela Teoria da Decisão é a <strong>função de soma dos quadrados dos resíduos</strong></li>
<li>Por essa estratégia, queremos encontrar as estimativas, 

$\boldsymbol{\theta} = \{ \hat{\beta}_0,\ \hat{\beta}_1 \}$, que <strong>minimizam</strong> essa função.</li>
</ul>
<h4 id="1-criar-função-perda-que-calcula-a-soma-dos-resíduos-quadráticos">1. Criar função perda que calcula a soma dos resíduos quadráticos</h4>
<ul>
<li>A função para calcular a soma dos resíduos quadráticos recebe como inputs:
<ul>
<li>um <strong>vetor</strong> de possíveis valores 

$\boldsymbol{\theta} = \{ \hat{\beta}_0,\ \hat{\beta}_1 \}$</li>
<li>um <strong>texto</strong> com o nome da variável dependente</li>
<li>um <strong>vetor de texto</strong> com os nomes dos regressores</li>
<li>uma base de dados</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">resid_quad</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">yname</span><span class="p">,</span> <span class="n">xname</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Extraindo as variáveis da base em vetores</span>
</span></span><span class="line"><span class="cl">  <span class="n">y</span> <span class="o">=</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data[yname]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">=</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data[xname]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># Extraindo os parâmetros de params</span>
</span></span><span class="line"><span class="cl">  <span class="n">b0</span> <span class="o">=</span> <span class="n">params[1]</span>
</span></span><span class="line"><span class="cl">  <span class="n">b1</span> <span class="o">=</span> <span class="n">params[2]</span>
</span></span><span class="line"><span class="cl">  <span class="n">sig2</span> <span class="o">=</span> <span class="n">params[3]</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="n">yhat</span> <span class="o">=</span> <span class="n">b0</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">x</span> <span class="c1"># valores ajustados</span>
</span></span><span class="line"><span class="cl">  <span class="n">e_hat</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">yhat</span> <span class="c1"># desvios = observados - ajustados</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sum</span><span class="p">(</span><span class="n">e_hat^2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="2-otimização">2. Otimização</h4>
<ul>
<li>Agora encontraremos os parâmetros que minimizam a função perda</li>
</ul>


$$ \underset{\hat{\beta}_0, \hat{\beta}_1}{\text{argmin}} \sum_{i=1}^{N}\hat{u}^2 \quad = \quad \underset{\hat{\beta}_0, \hat{\beta}_1}{\text{argmin}} \sum_{i=1}^{N}\left( \text{mpg}_i - \widehat{\text{mpg}}_i \right)^2 $$
<ul>
<li>Para isto usaremos a função <code>optim()</code> que retorna os parâmetros que minimizam uma função (equivalente ao <em>argmin</em>):</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">optim(par, fn, gr = NULL, ...,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">method = c(&#34;Nelder-Mead&#34;, &#34;BFGS&#34;, &#34;CG&#34;, &#34;L-BFGS-B&#34;, &#34;SANN&#34;, &#34;Brent&#34;),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">lower = -Inf, upper = Inf,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">control = list(), hessian = FALSE)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">par</span><span class="p">:</span><span class="w"> </span><span class="l">Initial values for the parameters to be optimized over.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">fn</span><span class="p">:</span><span class="w"> </span><span class="l">A function to be minimized (or maximized), with first argument the vector of parameters over which minimization is to take place. It should return a scalar result.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l">The method to be used. See ‘Details’. Can be abbreviated.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">hessian</span><span class="p">:</span><span class="w"> </span><span class="l">Logical. Should a numerically differentiated Hessian matrix be returned?</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Colocaremos como input:
<ul>
<li>a função perda criada <code>resid_quad()</code></li>
<li>um chute inicial dos parâmetros
<ul>
<li>Note que a estimação pode ser mais ou menos sensível ao valores iniciais, dependendo do método de otimização utilizado</li>
<li>O mais comum é encontrar como chute inicial um vetor de zeros <code>c(0, 0, 0)</code>, por ser mais neutro em relação ao sinal das estimativas</li>
<li>Em Econometria III, prof. Laurini recomendou usar método &ldquo;Nelder-Mead&rdquo; (padrão) com um chute inicial de zeros e, depois, usar suas estimativas como chute inicial para o método &ldquo;BFGS&rdquo;.</li>
</ul>
</li>
<li>Por padrão, temos o argumento <code>hessian = FALSE</code>, coloque <code>TRUE</code> para calcularmos o erro padrão, estatística t e p-valor das estimativas</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Estimação por BFGS</span>
</span></span><span class="line"><span class="cl"><span class="n">theta_ini</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span> <span class="c1"># Chute inicial de b0, b1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fit_ols2</span> <span class="o">=</span> <span class="nf">optim</span><span class="p">(</span><span class="n">par</span><span class="o">=</span><span class="n">theta_ini</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="n">resid_quad</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                 <span class="n">yname</span><span class="o">=</span><span class="s">&#34;mpg&#34;</span><span class="p">,</span> <span class="n">xname</span><span class="o">=</span><span class="s">&#34;hp&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">method</span><span class="o">=</span><span class="s">&#34;BFGS&#34;</span><span class="p">,</span> <span class="n">hessian</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">fit_ols2</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## $par
</span></span><span class="line"><span class="cl">## [1] 30.09886054 -0.06822828
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $value
</span></span><span class="line"><span class="cl">## [1] 447.6743
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $counts
</span></span><span class="line"><span class="cl">## function gradient 
</span></span><span class="line"><span class="cl">##       31        5 
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $convergence
</span></span><span class="line"><span class="cl">## [1] 0
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $message
</span></span><span class="line"><span class="cl">## NULL
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $hessian
</span></span><span class="line"><span class="cl">##      [,1]    [,2]
</span></span><span class="line"><span class="cl">## [1,]   64    9388
</span></span><span class="line"><span class="cl">## [2,] 9388 1668556
</span></span></code></pre></div><h3 id="b-máxima-verossimilhança">(b) Máxima Verossimilhança</h3>
<ul>
<li><a href="https://github.com/woerman/ResEcon703" target="_blank" rel="noopener">ResEcon 703</a> - Week 6 (University of Massachusetts Amherst)</li>
<li>A função objetivo é a função de verossimilhança e, ao contrário da função de soma de quadrado dos resíduos, queremos maximizá-la</li>
<li>Em nosso exemplo, temos que estimar 3 parâmetros</li>
</ul>


$$ \boldsymbol{\theta} = \left\{ \beta_0, \beta_1, \sigma^2 \right\}. $$
<h4 id="otimização-numérica-para-máxima-verossimilhança">Otimização Numérica para Máxima Verossimilhança</h4>
<p>A função <code>optim()</code> do R será usada novamente para desempenhar a otimização numérica. Precisamos usar como input:</p>
<ul>
<li>Alguns valores inicias dos parâmetros, 

$\boldsymbol{\theta}^0 = \{ \beta_0, \beta_1, \sigma^2 \}$</li>
<li>Uma função que tome esses parâmetros como um argumento e calcule a
log-verossimilhança, 

$\ln{L(\boldsymbol{\theta})}$.</li>
</ul>
<blockquote>
<p>Como <code>optim()</code> irá encontrar os parâmetros que minimizem a função objetivo, precisamos adaptar o output da função de log-verossimilhança (minimizaremos o negativo da log-lik).</p>
</blockquote>
<p>A função log-verossimilhança é dada por


$$ \ln{L(\beta_0, \beta_1, \sigma^2 | y, x)} = \sum^n_{i=1}{\ln{f(y_i | x_i, \beta_0, \beta_1, \sigma^2)}}, $$</p>
<p>em que a distribuição condicional de cada 

$y_i$ é</p>


$$ y_i | x_i \sim \mathcal{N}(\beta_0 + \beta_1 x_i, \sigma^2) $$
<p>o que implica que</p>


$$\varepsilon_i | x_i \sim N(0, \sigma^2)$$
<center><img src="../mle.jpg"></center>
<ul>
<li>Acima, podemos ver que, para cada 

$x$, temos um valor ajustado 

$\hat{y} = \beta_0 + \beta_1 x$ e seus desvios 

$\varepsilon$ são normalmente distribuídos com a mesma variância 

$\sigma^2$</li>
</ul>
<p>Passos para estimar uma regressão por máxima verossimilhança:</p>
<ol>
<li>Chutar valores iniciais de</li>
<li>Calcular os valores ajustados, 

$\hat{y}$</li>
<li>Calcular a densidade para cada 

$y_i$, 

$f(y_i | x_i, \beta_0, \beta_1, \sigma^2)$</li>
<li>Calcular a log-verossimilhança, 

$\ln{L(\beta_0, \beta_1, \sigma^2 | y, x)} = \sum^n_{i=1}{\ln{f(y_i | x_i, \beta_0, \beta_1, \sigma^2)}}$</li>
</ol>
<h5 id="1-chute-de-valores-iniciais-para-hahahugoshortcode-s31-hbhb-e-hahahugoshortcode-s32-hbhb">1. Chute de valores iniciais para 

$\beta_0, \beta_1$ e 

$\sigma^2$</h5>
<ul>
<li>Note que, diferente da estimação por MQO, um dos parâmetros a ser estimado via MLE é a variância (

$\sigma^2$).</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">params</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">30</span><span class="p">,</span> <span class="m">-0.06</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># (b0, b1 , sig2)</span>
</span></span></code></pre></div><h5 id="2-seleção-da-base-de-dados-e-variáveis">2. Seleção da base de dados e variáveis</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">## Inicializando</span>
</span></span><span class="line"><span class="cl"><span class="n">yname</span> <span class="o">=</span> <span class="s">&#34;mpg&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">xname</span> <span class="o">=</span> <span class="s">&#34;hp&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Extraindo as variáveis da base em vetores</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data[yname]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data[xname]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Extraindo os parâmetros de params</span>
</span></span><span class="line"><span class="cl"><span class="n">b0</span> <span class="o">=</span> <span class="n">params[1]</span>
</span></span><span class="line"><span class="cl"><span class="n">b1</span> <span class="o">=</span> <span class="n">params[2]</span>
</span></span><span class="line"><span class="cl"><span class="n">sig2</span> <span class="o">=</span> <span class="n">params[3]</span>
</span></span></code></pre></div><h5 id="3-cálculo-dos-valores-ajustados-e-das-densidades">3. Cálculo dos valores ajustados e das densidades</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">## Calculando valores ajustados de y</span>
</span></span><span class="line"><span class="cl"><span class="n">yhat</span> <span class="o">=</span> <span class="n">b0</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">yhat</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##                      hp
</span></span><span class="line"><span class="cl">## Mazda RX4         23.40
</span></span><span class="line"><span class="cl">## Mazda RX4 Wag     23.40
</span></span><span class="line"><span class="cl">## Datsun 710        24.42
</span></span><span class="line"><span class="cl">## Hornet 4 Drive    23.40
</span></span><span class="line"><span class="cl">## Hornet Sportabout 19.50
</span></span><span class="line"><span class="cl">## Valiant           23.70
</span></span></code></pre></div><h5 id="4-cálculo-das-densidades">4. Cálculo das densidades</h5>


$$ f(y_i | x_i, \beta_0, \beta_1, \sigma^2) $$
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">## Calculando os pdf&#39;s de cada linha</span>
</span></span><span class="line"><span class="cl"><span class="n">ypdf</span> <span class="o">=</span> <span class="nf">dnorm</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">yhat</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">sig2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">ypdf</span><span class="p">,</span> <span class="m">4</span><span class="p">))</span> <span class="c1"># Primeiros valores da densidade</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##                      mpg
</span></span><span class="line"><span class="cl">## Mazda RX4         0.0224
</span></span><span class="line"><span class="cl">## Mazda RX4 Wag     0.0224
</span></span><span class="line"><span class="cl">## Datsun 710        0.1074
</span></span><span class="line"><span class="cl">## Hornet 4 Drive    0.0540
</span></span><span class="line"><span class="cl">## Hornet Sportabout 0.2897
</span></span><span class="line"><span class="cl">## Valiant           0.0000
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sum</span><span class="p">(</span><span class="n">ypdf</span><span class="p">)</span> <span class="c1"># Verossimilhança</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 2.447628
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">prod</span><span class="p">(</span><span class="n">ypdf</span><span class="p">)</span> <span class="c1"># Log-Verossimilhança</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] 2.201994e-121
</span></span></code></pre></div><ul>
<li>Agora, vamos juntar visualizar os 6 primeiros elementos dos objetos trabalhados:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Juntando as bases e visualizando os primeiros valores</span>
</span></span><span class="line"><span class="cl"><span class="n">tab</span> <span class="o">=</span> <span class="nf">cbind</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">yhat</span><span class="p">,</span> <span class="nf">round</span><span class="p">(</span><span class="n">ypdf</span><span class="p">,</span> <span class="m">4</span><span class="p">))</span> <span class="c1"># arredondando ypdf (4 dígitos)</span>
</span></span><span class="line"><span class="cl"><span class="nf">colnames</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;y&#34;</span><span class="p">,</span> <span class="s">&#34;x&#34;</span><span class="p">,</span> <span class="s">&#34;yhat&#34;</span><span class="p">,</span> <span class="s">&#34;ypdf&#34;</span><span class="p">)</span> <span class="c1"># renomeando colunas</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##                      y   x  yhat   ypdf
</span></span><span class="line"><span class="cl">## Mazda RX4         21.0 110 23.40 0.0224
</span></span><span class="line"><span class="cl">## Mazda RX4 Wag     21.0 110 23.40 0.0224
</span></span><span class="line"><span class="cl">## Datsun 710        22.8  93 24.42 0.1074
</span></span><span class="line"><span class="cl">## Hornet 4 Drive    21.4 110 23.40 0.0540
</span></span><span class="line"><span class="cl">## Hornet Sportabout 18.7 175 19.50 0.2897
</span></span><span class="line"><span class="cl">## Valiant           18.1 105 23.70 0.0000
</span></span></code></pre></div><ul>
<li>Como pode ser visto na base de dados juntada e nos gráficos abaixo, quanto mais próximo o valor ajustado for do valor observado de cada observação, maior será a densidade/probabilidade.
<img src="/project/rec2301/sec10/_index_files/figure-html/unnamed-chunk-10-1.png" width="672" /><img src="/project/rec2301/sec10/_index_files/figure-html/unnamed-chunk-10-2.png" width="672" /><img src="/project/rec2301/sec10/_index_files/figure-html/unnamed-chunk-10-3.png" width="672" /></li>
<li>Logo, a verossimilhança (produto de todas probabilidades) será maior quanto mais próximos forem os valores ajustados dos seus respectivos valores observados.</li>
</ul>
<h5 id="5-calculando-a-log-verossimilhança">5. Calculando a Log-Verossimilhança</h5>
<p>A log-verossimilhança é a soma do log de todas probabilidades:</p>


$$ \mathcal{l}(\beta_0, \beta_1, \sigma^2) = \sum^{N}_{i=1}{\ln\left[ f(y_i | x_i, \beta_0, \beta_1, \sigma^2) \right]} $$
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">## Calculando a log-verossimilhanca</span>
</span></span><span class="line"><span class="cl"><span class="n">loglik</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">ypdf</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">loglik</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] -277.8234
</span></span></code></pre></div><h5 id="6-criando-a-função-de-log-verossimilhança">6. Criando a Função de Log-Verossimilhança</h5>
<p>Juntando tudo que fizemos anteriormente, podemos criar uma função no R que calcular a função de log-verossimilhança.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">## Criando funcao para calcular log-verossimilhanca MQO </span>
</span></span><span class="line"><span class="cl"><span class="n">loglik_lm</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">yname</span><span class="p">,</span> <span class="n">xname</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Extraindo as variáveis da base em vetores</span>
</span></span><span class="line"><span class="cl">  <span class="n">y</span> <span class="o">=</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data[yname]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">=</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data[xname]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># Extraindo os parâmetros de params</span>
</span></span><span class="line"><span class="cl">  <span class="n">b0</span> <span class="o">=</span> <span class="n">params[1]</span>
</span></span><span class="line"><span class="cl">  <span class="n">b1</span> <span class="o">=</span> <span class="n">params[2]</span>
</span></span><span class="line"><span class="cl">  <span class="n">sig2</span> <span class="o">=</span> <span class="n">params[3]</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">## Calculando valores ajustados de y</span>
</span></span><span class="line"><span class="cl">  <span class="n">yhat</span> <span class="o">=</span> <span class="n">b0</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">## Calculando os pdf&#39;s de cada linha</span>
</span></span><span class="line"><span class="cl">  <span class="n">ypdf</span> <span class="o">=</span> <span class="nf">dnorm</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">yhat</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">sig2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">## Calculando a log-verossimilhanca</span>
</span></span><span class="line"><span class="cl">  <span class="n">loglik</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">ypdf</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">## Retornando o negativo da log-verossimilanca</span>
</span></span><span class="line"><span class="cl">  <span class="o">-</span><span class="n">loglik</span> <span class="c1"># Negativo, pois optim() minimiza e queremos maximizar</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h5 id="7-otimização">7. Otimização</h5>
<p>Tendo a função objetivo, usaremos <code>optim()</code> para <em>minimizar</em></p>


$$ -\ln{L(\beta_0, \beta_1, \sigma^2 | y, X)} = -\sum^n_{i=1}{\ln{f(y_i | x_i, \beta_0, \beta_1, \sigma^2)}}. $$
<p>Aqui, <strong>minimizamos o negativo</strong> da log-Verossimilhança para <strong>maximizarmos</strong> (função<code>optim()</code> apenas minimiza).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">## Maximizando a função log-verossimilhança MQO</span>
</span></span><span class="line"><span class="cl"><span class="n">mle</span> <span class="o">=</span> <span class="nf">optim</span><span class="p">(</span><span class="n">par</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="n">fn</span> <span class="o">=</span> <span class="n">loglik_lm</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">yname</span> <span class="o">=</span> <span class="s">&#34;mpg&#34;</span><span class="p">,</span> <span class="n">xname</span> <span class="o">=</span> <span class="s">&#34;hp&#34;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">method</span> <span class="o">=</span> <span class="s">&#34;BFGS&#34;</span><span class="p">,</span> <span class="n">hessian</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Mostrando os resultados da otimização</span>
</span></span><span class="line"><span class="cl"><span class="n">mle</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## $par
</span></span><span class="line"><span class="cl">## [1] 30.09908613 -0.06822967 13.99015277
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $value
</span></span><span class="line"><span class="cl">## [1] 87.61931
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $counts
</span></span><span class="line"><span class="cl">## function gradient 
</span></span><span class="line"><span class="cl">##       84       28 
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $convergence
</span></span><span class="line"><span class="cl">## [1] 0
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $message
</span></span><span class="line"><span class="cl">## NULL
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## $hessian
</span></span><span class="line"><span class="cl">##               [,1]         [,2]          [,3]
</span></span><span class="line"><span class="cl">## [1,]  2.287323e+00 3.355217e+02 -3.520739e-06
</span></span><span class="line"><span class="cl">## [2,]  3.355217e+02 5.963323e+04  5.199112e-04
</span></span><span class="line"><span class="cl">## [3,] -3.520739e-06 5.199112e-04  8.174375e-02
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">## Calculando os erros padrão</span>
</span></span><span class="line"><span class="cl"><span class="c1"># hessiano &gt; inversa p/ V_bhat &gt; diagnonal &gt; raiz quadrada</span>
</span></span><span class="line"><span class="cl"><span class="n">mle_se</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span> <span class="nf">diag</span><span class="p">(</span> <span class="nf">solve</span><span class="p">(</span><span class="n">mle</span><span class="o">$</span><span class="n">hessian</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Visualizando as estimativas e os erros padrão</span>
</span></span><span class="line"><span class="cl"><span class="nf">cbind</span><span class="p">(</span><span class="n">mle</span><span class="o">$</span><span class="n">par</span><span class="p">,</span> <span class="n">mle_se</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##                      mle_se
</span></span><span class="line"><span class="cl">## [1,] 30.09908613 1.58205585
</span></span><span class="line"><span class="cl">## [2,] -0.06822967 0.00979809
</span></span><span class="line"><span class="cl">## [3,] 13.99015277 3.49762080
</span></span></code></pre></div><h3 id="c-método-dos-momentos">(c) Método dos Momentos</h3>
<ul>
<li>
<p><a href="https://cran.r-project.org/web/packages/gmm/vignettes/gmm_with_R.pdf" target="_blank" rel="noopener">Computing Generalized Method of Moments and Generalized Empirical Likelihood with R (Pierre Chaussé)</a></p>
</li>
<li>
<p><a href="https://medium.com/codex/generalized-method-of-moments-gmm-in-r-part-1-of-3-c65f41b6199" target="_blank" rel="noopener">Generalized Method of Moments (GMM) in R - Part 1 (Alfred F. SAM)</a></p>
</li>
<li>
<p>Para estimar via GMM precisamos construir vetores relacionados aos seguintes momentos:</p>
</li>
</ul>


$$ E(\boldsymbol{\varepsilon}) = 0 \qquad \text{ e } \qquad E(\boldsymbol{\varepsilon}' \boldsymbol{x}) = 0 $$
<p>Note que estes são os momentos relacionados ao MQO, dado que este é um caso particular do GMM. Os análogos amostrais são</p>


$$ \frac{1}{N} \sum^N_{i=1}{\hat{\varepsilon}_i} = 0 \qquad \text{ e } \qquad \frac{1}{N} \sum^N_{i=1}{\hat{\varepsilon}_i.x_i} = 0 $$
<p>Podemos calcular os dois momentos amostrais em uma única multiplicação matricial. Considere:</p>


$$ \hat{\boldsymbol{\varepsilon}} = \begin{bmatrix} \varepsilon_1 \\ \varepsilon_2 \\ \vdots \\ \varepsilon_N \end{bmatrix} \qquad \text{e} \qquad \boldsymbol{x} = \begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_N \end{bmatrix} $$
<p>Vamos juntar uma coluna de 1&rsquo;s com 

$\boldsymbol{x}$ e definir a matriz:


$$ \boldsymbol{X} = \begin{bmatrix} 1 & \varepsilon_1 \\ 1 & \varepsilon_2 \\ \vdots & \vdots \\ 1 & \varepsilon_N \end{bmatrix} $$</p>
<p>Fazendo a multiplicação matricia entre 

$\hat{\boldsymbol{\varepsilon}}$ e 

$\boldsymbol{X}$, temos:</p>


$$ \hat{\boldsymbol{\varepsilon}}' \boldsymbol{X}\ =\ \begin{bmatrix} \varepsilon_1 & \varepsilon_2 & \cdots & \varepsilon_N \end{bmatrix} \begin{bmatrix} 1 & x_1 \\ 1 & x_2 \\ \vdots & \vdots \\ 1 & x_N \end{bmatrix}\ =\ \begin{bmatrix}  \frac{1}{N} \sum^N_{i=1}{\hat{\varepsilon}} & \frac{1}{N} \sum^N_{i=1}{\hat{\varepsilon}.x_i} \end{bmatrix} $$
<p>Note que o vetor resultante são exatamente os momentos amostrais.</p>
<h4 id="otimização-numérica-para-gmm">Otimização Numérica para GMM</h4>
<h5 id="1-chute-de-valores-iniciais-para-hahahugoshortcode-s45-hbhb-e-hahahugoshortcode-s46-hbhb">1. Chute de valores iniciais para 

$\beta_0$ e 

$\beta_1$</h5>
<ul>
<li>Vamos criar um vetor com possíveis valores de 

$\beta_0, \beta_1$:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">params</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">30</span><span class="p">,</span> <span class="m">-0.06</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">yname</span> <span class="o">=</span> <span class="s">&#34;mpg&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">xname</span> <span class="o">=</span> <span class="s">&#34;hp&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span>
</span></span></code></pre></div><h5 id="2-seleção-da-base-de-dados-e-variáveis-1">2. Seleção da base de dados e variáveis</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Extraindo as variáveis da base em vetores</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data[yname]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data[xname]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">X</span> <span class="o">=</span> <span class="nf">cbind</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Extraindo os parâmetros de params</span>
</span></span><span class="line"><span class="cl"><span class="n">b0</span> <span class="o">=</span> <span class="n">params[1]</span>
</span></span><span class="line"><span class="cl"><span class="n">b1</span> <span class="o">=</span> <span class="n">params[2]</span>
</span></span><span class="line"><span class="cl"><span class="n">sig2</span> <span class="o">=</span> <span class="n">params[3]</span>
</span></span></code></pre></div><h5 id="3-cálculo-dos-valores-ajustados-e-dos-resíduos">3. Cálculo dos valores ajustados e dos resíduos</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">## Valores ajustados de y</span>
</span></span><span class="line"><span class="cl"><span class="n">yhat</span> <span class="o">=</span> <span class="n">b0</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Resíduos</span>
</span></span><span class="line"><span class="cl"><span class="n">e_hat</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">yhat</span>
</span></span></code></pre></div><h5 id="4-criação-da-matriz-de-momentos">4. Criação da matriz de momentos</h5>
<ul>
<li>Note que 

$\hat{\boldsymbol{\varepsilon}}' X$ um vetor dos momentos amostrais, mas a função <code>gmm()</code> exige uma matriz com <strong>multiplicação elemento a elemento</strong> do resíduo 

$\hat{\boldsymbol{\varepsilon}}$ com as covariadas 

$\boldsymbol{X}$ (neste caso: constante e hp), na forma:</li>
</ul>
<p>

$$ \hat{\boldsymbol{\varepsilon}} \times \boldsymbol{X}\ =\ \begin{bmatrix} \varepsilon_1 \\ \varepsilon_2 \\ \vdots \\ \varepsilon_N \end{bmatrix} \times \begin{bmatrix} 1 & x_1 \\ 1 & x_2 \\ \vdots & \vdots \\ 1 & x_N \end{bmatrix}\ =\ \begin{bmatrix} \varepsilon_1 & \varepsilon_1.x_1  \\ \varepsilon_2 & \varepsilon_2.x_2 \\ \vdots & \vdots \\ \varepsilon_N & \varepsilon_N.x_N \end{bmatrix} $$
Note que, para fazer o GMM no R, não devemos tirar a média de cada coluna (a própria função <code>gmm()</code> fará isso).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Matriz de momentos</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">e_hat</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span> 
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="c1"># 6 primeiras linhas</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##                              hp
</span></span><span class="line"><span class="cl">## Mazda RX4         -2.40 -264.00
</span></span><span class="line"><span class="cl">## Mazda RX4 Wag     -2.40 -264.00
</span></span><span class="line"><span class="cl">## Datsun 710        -1.62 -150.66
</span></span><span class="line"><span class="cl">## Hornet 4 Drive    -2.00 -220.00
</span></span><span class="line"><span class="cl">## Hornet Sportabout -0.80 -140.00
</span></span><span class="line"><span class="cl">## Valiant           -5.60 -588.00
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">apply</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="n">sum</span><span class="p">)</span> <span class="c1"># média de cada coluna</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##                hp 
</span></span><span class="line"><span class="cl">##   -35.46 -6400.62
</span></span></code></pre></div><ul>
<li>Note que, como multiplicamos a constante igual a 1 com os desvios 

$\varepsilon$, a 1ª coluna corresponde ao momento 

$E(\varepsilon)=0$ (mas sem tomar a esperança).</li>
<li>Já as colunas 2 e 3 correspodem ao momento 

$E(\varepsilon'X)=0$ para as variáveis <em>hp</em> e <em>wt</em> (também sem tomar a esperança).</li>
<li>Logicamente, para estimar por GMM, precisamos escolher os parâmetros 

$\theta = \{ \beta_0, \beta_1 \}$ que, ao tomar a esperança em cada um destas colunas, se aproximem ao máximo de zero. Isso será feito via função <code>gmm()</code> (semelhante à função <code>optim()</code>)</li>
</ul>
<h5 id="5-criação-de-função-com-os-momentos">5. Criação de função com os momentos</h5>
<ul>
<li>Vamos criar uma função que tem como input um vetor de parâmetros (<code>params</code>) e uma base de dados (<code>data</code>), e que retorna uma matriz em que cada coluna representa um momento.</li>
<li>Essa função incluirá todos os comandos descritos nos itens 1 a 4 (que, na verdade, apenas foram feitos por didática).</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">mom_ols</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">list</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># No GMM, só pode ter 1 input que não sejam os parâmetros</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Por isso, foi incluído uma lista com 3 argumentos</span>
</span></span><span class="line"><span class="cl">  <span class="n">yname</span> <span class="o">=</span> <span class="n">list[[1]]</span>
</span></span><span class="line"><span class="cl">  <span class="n">xname</span> <span class="o">=</span> <span class="n">list[[2]]</span>
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">=</span> <span class="n">list[[3]]</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># Extraindo as variáveis da base em vetores</span>
</span></span><span class="line"><span class="cl">  <span class="n">y</span> <span class="o">=</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data[yname]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">=</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data[xname]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">X</span> <span class="o">=</span> <span class="nf">cbind</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># Extraindo os parâmetros de params</span>
</span></span><span class="line"><span class="cl">  <span class="n">b0</span> <span class="o">=</span> <span class="n">params[1]</span>
</span></span><span class="line"><span class="cl">  <span class="n">b1</span> <span class="o">=</span> <span class="n">params[2]</span>
</span></span><span class="line"><span class="cl">  <span class="n">sig2</span> <span class="o">=</span> <span class="n">params[3]</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">## Valores ajustados de y</span>
</span></span><span class="line"><span class="cl">  <span class="n">yhat</span> <span class="o">=</span> <span class="n">b0</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">## Resíduos</span>
</span></span><span class="line"><span class="cl">  <span class="n">e_hat</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">yhat</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">## Matriz de momentos</span>
</span></span><span class="line"><span class="cl">  <span class="n">m</span> <span class="o">=</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">e_hat</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span>
</span></span><span class="line"><span class="cl">  <span class="n">m</span> <span class="c1"># output da função</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h5 id="6-otimização-via-função-gmm">6. Otimização via função <code>gmm()</code></h5>
<ul>
<li>A função <code>gmm()</code>, assim como a <code>optim()</code>, recebe uma função como argumento.</li>
<li>No entanto, ao invés de retornar um valor, a função que entra no <code>gmm()</code> retorna uma matriz, cujas médias das colunas queremos aproximar de zero.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">gmm</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## Carregando pacotes exigidos: sandwich
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">gmm_lm</span> <span class="o">=</span> <span class="nf">gmm</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="n">mom_ols</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">             <span class="n">x</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">yname</span><span class="o">=</span><span class="s">&#34;mpg&#34;</span><span class="p">,</span> <span class="n">xname</span><span class="o">=</span><span class="s">&#34;hp&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">),</span> <span class="c1"># argumentos função</span>
</span></span><span class="line"><span class="cl">             <span class="n">t0</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">),</span> <span class="c1"># chute inicial de params</span>
</span></span><span class="line"><span class="cl">             <span class="n">wmatrix</span> <span class="o">=</span> <span class="s">&#34;optimal&#34;</span><span class="p">,</span> <span class="c1"># matriz de ponderação</span>
</span></span><span class="line"><span class="cl">             <span class="n">optfct</span> <span class="o">=</span> <span class="s">&#34;nlminb&#34;</span> <span class="c1"># função de otimização</span>
</span></span><span class="line"><span class="cl">             <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">gmm_lm</span><span class="p">)</span><span class="o">$</span><span class="n">coefficients</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##             Estimate Std. Error   t value     Pr(&gt;|t|)
</span></span><span class="line"><span class="cl">## Theta[1] 30.09886038 2.53115147 11.891371 1.312350e-32
</span></span><span class="line"><span class="cl">## Theta[2] -0.06822828 0.01540378 -4.429319 9.453096e-06
</span></span></code></pre></div>

        </article>

        





        



        
        
        <div class="article-widget">
          
<div class="post-nav">
  
  
</div>

        </div>
        
      </div>

      <div class="body-footer">
        <p>Last updated on Sep 9, 2018</p>

        




        




        


      </div>

      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2023 Me. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  


<script src="/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js"></script>




  

  
  

  









<script src="https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
<script>
  anchors.add();
</script>





  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  







<script id="page-data" type="application/json">{"use_headroom":false}</script>












  
  


<script src="/en/js/wowchemy.min.e8ee06ba8371980ffde659871dd593b0.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>


















</body>
</html>
