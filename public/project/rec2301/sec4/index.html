<!DOCTYPE html>
<!-- This site was created with Wowchemy. https://www.wowchemy.com -->
<!-- Last Published: July 24, 2023 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.7.0 for Hugo" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css" integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.0f229d4b7ebad1917a9a357cba2effab.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  


























  
  
  






  <meta name="author" content="Fábio Nishida" />





  

<meta name="description" content="The page provides an introduction to the dplyr package and its functions for column manipulation (select, rename, mutate), row manipulation (filter, arrange), and grouping of rows (summarize). The page also includes examples of using these functions with the Star Wars dataset. Additionally, the page discusses the use of the pipe operator (%&gt;%) and join functions for merging data frames." />



<link rel="alternate" hreflang="en-us" href="https://fhnishida.netlify.app/project/rec2301/sec4/" />
<link rel="canonical" href="https://fhnishida.netlify.app/project/rec2301/sec4/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#1565c0" />










  
  






<meta property="twitter:card" content="summary" />

  <meta property="twitter:site" content="@wowchemy" />
  <meta property="twitter:creator" content="@wowchemy" />
<meta property="twitter:image" content="https://fhnishida.netlify.app/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_512x512_fill_lanczos_center_3.png" />
<meta property="og:site_name" content="Fábio Nishida" />
<meta property="og:url" content="https://fhnishida.netlify.app/project/rec2301/sec4/" />
<meta property="og:title" content="Manipulação via dplyr | Fábio Nishida" />
<meta property="og:description" content="The page provides an introduction to the dplyr package and its functions for column manipulation (select, rename, mutate), row manipulation (filter, arrange), and grouping of rows (summarize). The page also includes examples of using these functions with the Star Wars dataset. Additionally, the page discusses the use of the pipe operator (%&gt;%) and join functions for merging data frames." /><meta property="og:image" content="https://fhnishida.netlify.app/media/icon_hu47f6d4834e8bfd33c99c8c5b57562587_11044_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />

  
    <meta property="og:updated_time" content="2018-09-09T00:00:00&#43;00:00" />
  










  
  
  

  
  
    <link rel="alternate" href="/project/rec2301/sec4/index.xml" type="application/rss+xml" title="Fábio Nishida" />
  

  


  
  <title>Manipulação via dplyr | Fábio Nishida</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="0e612f74cb55a0b1e54025c4e91b5990" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Fábio Nishida</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Fábio Nishida</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Teaching Assistance</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#featured"><span>Publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="/#contact"  aria-label="envelope">
                <i class="fas fa-envelope" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
        
          Principal
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      <ul class="nav docs-sidenav">
        <li><a href="/project/"><i class="fas fa-arrow-left pr-1"></i>Projects</a></li>
      </ul>

      
      
        
          
        
      


  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/"><i class="fas fa-book pr-1"></i>Principal</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/project/rec2301/">----------------------</a></li>



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec1/">Ferramentas do R</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec2/">Programação em R</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec3/">Manipulação de Dados</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link  active" href="/project/rec2301/sec4/">Manipulação via dplyr</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec6/">Distribuições</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec5/">Visualização de Dados</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec7/">Regressão Simples</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec8/">Regressão Múltipla</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec9/">Testes de Hipótese</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/project/rec2301/sec10/">Otimização Numérica</a>
    

    
      </div>
    

      
        </ul>
      
    

    
      </div>
    

    
  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      












      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#pacote-dplyr">Pacote <code>dplyr</code></a></li>
    <li><a href="#filtre-linhas-com-filter">Filtre linhas com <code>filter()</code></a></li>
    <li><a href="#organize-linhas-com-arrange">Organize linhas com <code>arrange()</code></a></li>
    <li><a href="#selecione-colunas-com-select">Selecione colunas com <code>select()</code></a></li>
    <li><a href="#renomeie-colunas-com-rename">Renomeie colunas com <code>rename()</code></a></li>
    <li><a href="#modifiqueadicione-colunas-com-mutate">Modifique/Adicione colunas com <code>mutate()</code></a></li>
    <li><a href="#operador-pipe-">Operador Pipe <code>%&gt;%</code></a></li>
    <li><a href="#resuma-com-summarise">Resuma com <code>summarise()</code></a></li>
    <li><a href="#agrupe-com-group_by">Agrupe com <code>group_by()</code></a></li>
    <li><a href="#resuma-em-grupos-com-group_by-e-summarise">Resuma em grupos com <code>group_by()</code> e <code>summarise()</code></a></li>
    <li><a href="#junte-bases-com-funções-_join_">Junte bases com funções <em>join</em></a></li>
  </ul>
</nav>

      











    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <div class="docs-article-container">
        
      </div>

      
      
      

      <div class="docs-article-container">
        
        <h1>Manipulação via dplyr</h1>

        <article class="article-style">

          
          

          <h2 id="pacote-dplyr">Pacote <code>dplyr</code></h2>
<ul>
<li><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html" target="_blank" rel="noopener">Vignette - Introduction to <em>dplyr</em></a></li>
<li>O pacote <code>dplyr</code> facilita a manipulação dos dados por meio de funções simples e computacionalmente eficientes</li>
<li>As funções pode, ser organizadas em três categorias:
<ul>
<li>Colunas:
<ul>
<li><code>select()</code>: seleciona (ou retira) as colunas do data frame</li>
<li><code>rename()</code>: muda os nomes das colunas</li>
<li><code>mutate()</code>: cria ou muda os valores nas colunas</li>
</ul>
</li>
<li>Linhas:
<ul>
<li><code>filter()</code>: seleciona linhas de acordo com valores das colunas</li>
<li><code>arrange()</code>: organiza a ordem das linhas</li>
</ul>
</li>
<li>Grupo de linhas:
<ul>
<li><code>summarise()</code>: colapsa um grupo em uma única linha</li>
</ul>
</li>
</ul>
</li>
<li>Nesta subseção, continuaremos utilizando a base de dados de Star Wars (<code>starwars</code>), utilizada na subseção anterior.</li>
<li>Você irá notar que, ao usar essas funções, o data frame é transformado em um <em>tibble</em> que é um formato mais eficiente para tratar dados tabulares, mas que funciona de forma igual a um data frame.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="s">&#34;dplyr&#34;</span><span class="p">)</span> <span class="c1"># Carregando pacote</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">## Attaching package: &#39;dplyr&#39;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## The following objects are masked from &#39;package:stats&#39;:
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">##     filter, lag
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## The following objects are masked from &#39;package:base&#39;:
</span></span><span class="line"><span class="cl">## 
</span></span><span class="line"><span class="cl">##     intersect, setdiff, setequal, union
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">starwars</span><span class="p">)</span> <span class="c1"># olhando primeiras linhas da base contida no pacote</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 14
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">## 2 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
</span></span><span class="line"><span class="cl">## 3 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
</span></span><span class="line"><span class="cl">## 4 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
</span></span><span class="line"><span class="cl">## 5 Leia Org…    150    49 brown      light      brown           19   fema… femin…
</span></span><span class="line"><span class="cl">## 6 Owen Lars    178   120 brown, gr… light      blue            52   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><h2 id="filtre-linhas-com-filter">Filtre linhas com <code>filter()</code></h2>
<ul>
<li>Permite selecionar um subconjunto de linhas de um data frame</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">filter(.data, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">.data</span><span class="p">:</span><span class="w"> </span><span class="l">A data frame, data frame extension (e.g. a tibble), or a lazy data frame (e.g. from dbplyr or dtplyr).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="w">	</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;data-masking&gt; Expressions that return a logical value, and are defined in terms of the variables in .data. If multiple expressions are included, they are combined with the &amp; operator. Only rows for which all conditions evaluate to TRUE are kept.</span><span class="w">
</span></span></span></code></pre></div><ul>
<li></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars1</span> <span class="o">=</span> <span class="nf">filter</span><span class="p">(</span><span class="n">starwars</span><span class="p">,</span> <span class="n">species</span> <span class="o">==</span> <span class="s">&#34;Human&#34;</span><span class="p">,</span> <span class="n">height</span> <span class="o">&gt;=</span> <span class="m">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars1</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 14
</span></span><span class="line"><span class="cl">##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">##  2 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
</span></span><span class="line"><span class="cl">##  3 Leia Or…    150    49 brown      light      brown           19   fema… femin…
</span></span><span class="line"><span class="cl">##  4 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
</span></span><span class="line"><span class="cl">##  5 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
</span></span><span class="line"><span class="cl">##  6 Biggs D…    183    84 black      light      brown           24   male  mascu…
</span></span><span class="line"><span class="cl">##  7 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
</span></span><span class="line"><span class="cl">##  8 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
</span></span><span class="line"><span class="cl">##  9 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
</span></span><span class="line"><span class="cl">## 10 Han Solo    180    80 brown      fair       brown           29   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Equivalente a:</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars[starwars</span><span class="o">$</span><span class="n">species</span> <span class="o">==</span> <span class="s">&#34;Human&#34;</span> <span class="o">&amp;</span> <span class="n">starwars</span><span class="o">$</span><span class="n">height</span> <span class="o">&gt;=</span> <span class="m">100</span><span class="p">,</span> <span class="n">]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 39 × 14
</span></span><span class="line"><span class="cl">##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">##  2 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
</span></span><span class="line"><span class="cl">##  3 Leia Or…    150    49 brown      light      brown           19   fema… femin…
</span></span><span class="line"><span class="cl">##  4 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
</span></span><span class="line"><span class="cl">##  5 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
</span></span><span class="line"><span class="cl">##  6 Biggs D…    183    84 black      light      brown           24   male  mascu…
</span></span><span class="line"><span class="cl">##  7 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
</span></span><span class="line"><span class="cl">##  8 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
</span></span><span class="line"><span class="cl">##  9 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
</span></span><span class="line"><span class="cl">## 10 Han Solo    180    80 brown      fair       brown           29   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 29 more rows
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><h2 id="organize-linhas-com-arrange">Organize linhas com <code>arrange()</code></h2>
<ul>
<li>Reordena as linhas a partir de um conjunto de nomes de coluna</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">arrange(.data, ..., .by_group = FALSE)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">.data</span><span class="p">:</span><span class="w"> </span><span class="l">A data frame, data frame extension (e.g. a tibble), or a lazy data frame (e.g. from dbplyr or dtplyr).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="l">&lt;data-masking&gt; Variables, or functions of variables. Use desc() to sort a variable in descending order.</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Se for inserido mais de um nome de variável, organiza de acordo com a 1ª variável e, em caso de ter linhas com o mesmo valor na 1ª variável, ordena estas linhas de mesmo valor de acordo com a 2ª variável</li>
<li>Para usar a ordem decrescente, temos a função <code>desc()</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars2</span> <span class="o">=</span> <span class="nf">arrange</span><span class="p">(</span><span class="n">starwars1</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="nf">desc</span><span class="p">(</span><span class="n">mass</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars2</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 14
</span></span><span class="line"><span class="cl">##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1 Leia Or…    150    49 brown      light      brown             19 fema… femin…
</span></span><span class="line"><span class="cl">##  2 Mon Mot…    150    NA auburn     fair       blue              48 fema… femin…
</span></span><span class="line"><span class="cl">##  3 Cordé       157    NA brown      light      brown             NA fema… femin…
</span></span><span class="line"><span class="cl">##  4 Shmi Sk…    163    NA black      fair       brown             72 fema… femin…
</span></span><span class="line"><span class="cl">##  5 Beru Wh…    165    75 brown      light      blue              47 fema… femin…
</span></span><span class="line"><span class="cl">##  6 Padmé A…    165    45 brown      light      brown             46 fema… femin…
</span></span><span class="line"><span class="cl">##  7 Dormé       165    NA brown      light      brown             NA fema… femin…
</span></span><span class="line"><span class="cl">##  8 Jocasta…    167    NA white      fair       blue              NA fema… femin…
</span></span><span class="line"><span class="cl">##  9 Wedge A…    170    77 brown      fair       hazel             21 male  mascu…
</span></span><span class="line"><span class="cl">## 10 Palpati…    170    75 grey       pale       yellow            82 male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><h2 id="selecione-colunas-com-select">Selecione colunas com <code>select()</code></h2>
<ul>
<li>Seleciona colunas que são de interesse.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">select(.data, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="l">variables in a data frame</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">:</span><span class="w"> </span><span class="l">for selecting a range of consecutive variables.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>!<span class="w"> </span><span class="l">for taking the complement of a set of variables.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">c() for combining selections.</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Coloca-se os nomes das colunas desejadas para selecioná-las.</li>
<li>Também é possível selecionar um intervalo de variáveis usando <code>var1:var2</code></li>
<li>Caso queira tirar apenas algumas colunas, basta informar o nome delas precedidas pelo sinal de subtração (<code>-var</code>)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars3</span> <span class="o">=</span> <span class="nf">select</span><span class="p">(</span><span class="n">starwars2</span><span class="p">,</span> <span class="n">name</span><span class="o">:</span><span class="n">eye_color</span><span class="p">,</span> <span class="n">sex</span><span class="o">:</span><span class="n">species</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># equivalente: select(starwars2, -birth_year, -c(films:starships))</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars3</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 10
</span></span><span class="line"><span class="cl">##    name      height  mass hair_color skin_color eye_color sex   gender homeworld
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    
</span></span><span class="line"><span class="cl">##  1 Leia Org…    150    49 brown      light      brown     fema… femin… Alderaan 
</span></span><span class="line"><span class="cl">##  2 Mon Moth…    150    NA auburn     fair       blue      fema… femin… Chandrila
</span></span><span class="line"><span class="cl">##  3 Cordé        157    NA brown      light      brown     fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  4 Shmi Sky…    163    NA black      fair       brown     fema… femin… Tatooine 
</span></span><span class="line"><span class="cl">##  5 Beru Whi…    165    75 brown      light      blue      fema… femin… Tatooine 
</span></span><span class="line"><span class="cl">##  6 Padmé Am…    165    45 brown      light      brown     fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  7 Dormé        165    NA brown      light      brown     fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  8 Jocasta …    167    NA white      fair       blue      fema… femin… Coruscant
</span></span><span class="line"><span class="cl">##  9 Wedge An…    170    77 brown      fair       hazel     male  mascu… Corellia 
</span></span><span class="line"><span class="cl">## 10 Palpatine    170    75 grey       pale       yellow    male  mascu… Naboo    
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 1 more variable: species &lt;chr&gt;
</span></span></code></pre></div><ul>
<li>Note que o <code>select()</code> pode não funcionar corretamente se o pacote <code>MASS</code> estiver ativo. Caso esteja, retire a seleção do pacote <code>MASS</code> no quadrante inferior/direito em &lsquo;Packages&rsquo; (ou digite <code>detach(&quot;package:MASS&quot;, unload = TRUE)</code>)</li>
<li>Uma outra forma de fazer a seleção de coluna é combinando com <code>starts_with()</code> e <code>ends_with()</code>, que resulta na seleção de colunas que se iniciam e terminam com um texto dado</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span> <span class="nf">select</span><span class="p">(</span><span class="n">starwars</span><span class="p">,</span> <span class="nf">ends_with</span><span class="p">(</span><span class="s">&#34;color&#34;</span><span class="p">))</span> <span class="p">)</span> <span class="c1"># colunas que terminam com color</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 3
</span></span><span class="line"><span class="cl">##   hair_color  skin_color  eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 blond       fair        blue     
</span></span><span class="line"><span class="cl">## 2 &lt;NA&gt;        gold        yellow   
</span></span><span class="line"><span class="cl">## 3 &lt;NA&gt;        white, blue red      
</span></span><span class="line"><span class="cl">## 4 none        white       yellow   
</span></span><span class="line"><span class="cl">## 5 brown       light       brown    
</span></span><span class="line"><span class="cl">## 6 brown, grey light       blue
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span> <span class="nf">select</span><span class="p">(</span><span class="n">starwars</span><span class="p">,</span> <span class="nf">starts_with</span><span class="p">(</span><span class="s">&#34;s&#34;</span><span class="p">))</span> <span class="p">)</span> <span class="c1"># colunas que iniciam com a letra &#34;s&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 4
</span></span><span class="line"><span class="cl">##   skin_color  sex    species starships
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;   &lt;list&gt;   
</span></span><span class="line"><span class="cl">## 1 fair        male   Human   &lt;chr [2]&gt;
</span></span><span class="line"><span class="cl">## 2 gold        none   Droid   &lt;chr [0]&gt;
</span></span><span class="line"><span class="cl">## 3 white, blue none   Droid   &lt;chr [0]&gt;
</span></span><span class="line"><span class="cl">## 4 white       male   Human   &lt;chr [1]&gt;
</span></span><span class="line"><span class="cl">## 5 light       female Human   &lt;chr [0]&gt;
</span></span><span class="line"><span class="cl">## 6 light       male   Human   &lt;chr [0]&gt;
</span></span></code></pre></div><h2 id="renomeie-colunas-com-rename">Renomeie colunas com <code>rename()</code></h2>
<ul>
<li>Renomeia colunas usando <code>novo_nome = velho_nome</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">rename(.data, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">.data</span><span class="p">:</span><span class="w"> </span><span class="l">A data frame, data frame extension (e.g. a tibble), or a lazy data frame (e.g. from dbplyr or dtplyr).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="w">	</span><span class="nt">: For rename()</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;tidy-select&gt; Use new_name = old_name to rename selected variables.</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars4</span> <span class="o">=</span> <span class="nf">rename</span><span class="p">(</span><span class="n">starwars3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">haircolor</span> <span class="o">=</span> <span class="n">hair_color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">skincolor</span> <span class="o">=</span> <span class="n">skin_color</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                <span class="n">eyecolor</span> <span class="o">=</span> <span class="n">eye_color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars4</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 10
</span></span><span class="line"><span class="cl">##    name         height  mass haircolor skincolor eyecolor sex   gender homeworld
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    
</span></span><span class="line"><span class="cl">##  1 Leia Organa     150    49 brown     light     brown    fema… femin… Alderaan 
</span></span><span class="line"><span class="cl">##  2 Mon Mothma      150    NA auburn    fair      blue     fema… femin… Chandrila
</span></span><span class="line"><span class="cl">##  3 Cordé           157    NA brown     light     brown    fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  4 Shmi Skywal…    163    NA black     fair      brown    fema… femin… Tatooine 
</span></span><span class="line"><span class="cl">##  5 Beru Whites…    165    75 brown     light     blue     fema… femin… Tatooine 
</span></span><span class="line"><span class="cl">##  6 Padmé Amida…    165    45 brown     light     brown    fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  7 Dormé           165    NA brown     light     brown    fema… femin… Naboo    
</span></span><span class="line"><span class="cl">##  8 Jocasta Nu      167    NA white     fair      blue     fema… femin… Coruscant
</span></span><span class="line"><span class="cl">##  9 Wedge Antil…    170    77 brown     fair      hazel    male  mascu… Corellia 
</span></span><span class="line"><span class="cl">## 10 Palpatine       170    75 grey      pale      yellow   male  mascu… Naboo    
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 1 more variable: species &lt;chr&gt;
</span></span></code></pre></div><h2 id="modifiqueadicione-colunas-com-mutate">Modifique/Adicione colunas com <code>mutate()</code></h2>
<ul>
<li>Modifica uma coluna se ela já existir</li>
<li>Cria uma coluna se ela não existir</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">mutate(.data, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">.data</span><span class="p">:</span><span class="w"> </span><span class="l">A data frame, data frame extension (e.g. a tibble), or a lazy data frame (e.g. from dbplyr or dtplyr).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="w">	</span><span class="p">:</span><span class="w"> </span><span class="nt">&lt;data-masking&gt; Name-value pairs. The name gives the name of the column in the output. The value can be</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">A vector of length 1, which will be recycled to the correct length.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">A vector the same length as the current group (or the whole data frame if ungrouped).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">NULL, to remove the column.</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars5</span> <span class="o">=</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">starwars4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">/</span><span class="m">100</span><span class="p">,</span> <span class="c1"># transf cm p/ metro</span>
</span></span><span class="line"><span class="cl">                <span class="n">BMI</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">/</span> <span class="n">height^2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">dummy</span> <span class="o">=</span> <span class="m">1</span> <span class="c1"># se não for vetor, tudo fica igual</span>
</span></span><span class="line"><span class="cl">                <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars5</span> <span class="o">=</span> <span class="nf">select</span><span class="p">(</span><span class="n">starwars5</span><span class="p">,</span> <span class="n">BMI</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="nf">everything</span><span class="p">())</span> <span class="c1"># facilitar</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars5</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 12
</span></span><span class="line"><span class="cl">##      BMI dummy name       height  mass haircolor skincolor eyecolor sex   gender
</span></span><span class="line"><span class="cl">##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1  21.8     1 Leia Orga…   1.5     49 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  2  NA       1 Mon Mothma   1.5     NA auburn    fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  3  NA       1 Cordé        1.57    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  4  NA       1 Shmi Skyw…   1.63    NA black     fair      brown    fema… femin…
</span></span><span class="line"><span class="cl">##  5  27.5     1 Beru Whit…   1.65    75 brown     light     blue     fema… femin…
</span></span><span class="line"><span class="cl">##  6  16.5     1 Padmé Ami…   1.65    45 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  7  NA       1 Dormé        1.65    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  8  NA       1 Jocasta Nu   1.67    NA white     fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  9  26.6     1 Wedge Ant…   1.7     77 brown     fair      hazel    male  mascu…
</span></span><span class="line"><span class="cl">## 10  26.0     1 Palpatine    1.7     75 grey      pale      yellow   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><h2 id="operador-pipe-">Operador Pipe <code>%&gt;%</code></h2>
<ul>
<li>Note que todas as funções do pacote <code>dyplr</code> anteriores têm como 1º argumento a base de dados (<code>.data</code>), e isto não é por acaso.</li>
<li>O operador pipe <code>%&gt;%</code> joga um data frame (escrito à sua esquerda) no 1º argumento da função seguinte (à sua direita).</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">filter</span><span class="p">(</span><span class="n">starwars</span><span class="p">,</span> <span class="n">species</span><span class="o">==</span><span class="s">&#34;Droid&#34;</span><span class="p">)</span> <span class="c1"># sem operador pipe</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 14
</span></span><span class="line"><span class="cl">##   name   height  mass hair_color skin_color  eye_color birth_year sex   gender  
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;   
</span></span><span class="line"><span class="cl">## 1 C-3PO     167    75 &lt;NA&gt;       gold        yellow           112 none  masculi…
</span></span><span class="line"><span class="cl">## 2 R2-D2      96    32 &lt;NA&gt;       white, blue red               33 none  masculi…
</span></span><span class="line"><span class="cl">## 3 R5-D4      97    32 &lt;NA&gt;       white, red  red               NA none  masculi…
</span></span><span class="line"><span class="cl">## 4 IG-88     200   140 none       metal       red               15 none  masculi…
</span></span><span class="line"><span class="cl">## 5 R4-P17     96    NA none       silver, red red, blue         NA none  feminine
</span></span><span class="line"><span class="cl">## 6 BB8        NA    NA none       none        black             NA none  masculi…
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">filter</span><span class="p">(</span><span class="n">species</span><span class="o">==</span><span class="s">&#34;Droid&#34;</span><span class="p">)</span> <span class="c1"># com operador pipe</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 14
</span></span><span class="line"><span class="cl">##   name   height  mass hair_color skin_color  eye_color birth_year sex   gender  
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;   
</span></span><span class="line"><span class="cl">## 1 C-3PO     167    75 &lt;NA&gt;       gold        yellow           112 none  masculi…
</span></span><span class="line"><span class="cl">## 2 R2-D2      96    32 &lt;NA&gt;       white, blue red               33 none  masculi…
</span></span><span class="line"><span class="cl">## 3 R5-D4      97    32 &lt;NA&gt;       white, red  red               NA none  masculi…
</span></span><span class="line"><span class="cl">## 4 IG-88     200   140 none       metal       red               15 none  masculi…
</span></span><span class="line"><span class="cl">## 5 R4-P17     96    NA none       silver, red red, blue         NA none  feminine
</span></span><span class="line"><span class="cl">## 6 BB8        NA    NA none       none        black             NA none  masculi…
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><ul>
<li>Observe que, ao usar o operador pipe, o 1º argumento com a base de dados não deve ser preenchida (já está sendo aplicada automaticamente via <code>%&gt;%</code>).</li>
<li>Note que, desde a subseção com a função <code>filter()</code> até <code>mutate()</code> fomos &ldquo;acumulando&rdquo; as alterações em novos data frames, ou seja, o último data frame <code>starwars5</code> é a base original <code>starwars</code> que foi alterada por <code>filter()</code>, <code>arrange()</code>, <code>select()</code>, <code>rename()</code> e <code>mutate()</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars1</span> <span class="o">=</span> <span class="nf">filter</span><span class="p">(</span><span class="n">starwars</span><span class="p">,</span> <span class="n">species</span> <span class="o">==</span> <span class="s">&#34;Human&#34;</span><span class="p">,</span> <span class="n">height</span> <span class="o">&gt;=</span> <span class="m">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars2</span> <span class="o">=</span> <span class="nf">arrange</span><span class="p">(</span><span class="n">starwars1</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="nf">desc</span><span class="p">(</span><span class="n">mass</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars3</span> <span class="o">=</span> <span class="nf">select</span><span class="p">(</span><span class="n">starwars2</span><span class="p">,</span> <span class="n">name</span><span class="o">:</span><span class="n">eye_color</span><span class="p">,</span> <span class="n">sex</span><span class="o">:</span><span class="n">species</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars4</span> <span class="o">=</span> <span class="nf">rename</span><span class="p">(</span><span class="n">starwars3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">haircolor</span> <span class="o">=</span> <span class="n">hair_color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">skincolor</span> <span class="o">=</span> <span class="n">skin_color</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                <span class="n">eyecolor</span> <span class="o">=</span> <span class="n">eye_color</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars5</span> <span class="o">=</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">starwars4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">/</span><span class="m">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">BMI</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">/</span> <span class="n">height^2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">dummy</span> <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">                <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars5</span> <span class="o">=</span> <span class="nf">select</span><span class="p">(</span><span class="n">starwars5</span><span class="p">,</span> <span class="n">BMI</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="nf">everything</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars5</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 12
</span></span><span class="line"><span class="cl">##      BMI dummy name       height  mass haircolor skincolor eyecolor sex   gender
</span></span><span class="line"><span class="cl">##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1  21.8     1 Leia Orga…   1.5     49 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  2  NA       1 Mon Mothma   1.5     NA auburn    fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  3  NA       1 Cordé        1.57    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  4  NA       1 Shmi Skyw…   1.63    NA black     fair      brown    fema… femin…
</span></span><span class="line"><span class="cl">##  5  27.5     1 Beru Whit…   1.65    75 brown     light     blue     fema… femin…
</span></span><span class="line"><span class="cl">##  6  16.5     1 Padmé Ami…   1.65    45 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  7  NA       1 Dormé        1.65    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  8  NA       1 Jocasta Nu   1.67    NA white     fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  9  26.6     1 Wedge Ant…   1.7     77 brown     fair      hazel    male  mascu…
</span></span><span class="line"><span class="cl">## 10  26.0     1 Palpatine    1.7     75 grey      pale      yellow   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><ul>
<li>Usando o operador pipe <code>%&gt;%</code> várias vezes, podemos ir pegando o output resultante da aplicação de uma função e jogar como input da função seguinte. Reescreveremos o código acima &ldquo;em única linha&rdquo; com <code>%&gt;%</code>, chegando ao mesmo data frame de <code>starwars5</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars_pipe</span> <span class="o">=</span> <span class="n">starwars</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">filter</span><span class="p">(</span><span class="n">species</span> <span class="o">==</span> <span class="s">&#34;Human&#34;</span><span class="p">,</span> <span class="n">height</span> <span class="o">&gt;=</span> <span class="m">100</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">arrange</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="nf">desc</span><span class="p">(</span><span class="n">mass</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="n">name</span><span class="o">:</span><span class="n">eye_color</span><span class="p">,</span> <span class="n">sex</span><span class="o">:</span><span class="n">species</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">rename</span><span class="p">(</span><span class="n">haircolor</span> <span class="o">=</span> <span class="n">hair_color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">skincolor</span> <span class="o">=</span> <span class="n">skin_color</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">           <span class="n">eyecolor</span> <span class="o">=</span> <span class="n">eye_color</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">/</span><span class="m">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">BMI</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">/</span> <span class="n">height^2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">dummy</span> <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">           <span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="n">BMI</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="nf">everything</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars_pipe</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 31 × 12
</span></span><span class="line"><span class="cl">##      BMI dummy name       height  mass haircolor skincolor eyecolor sex   gender
</span></span><span class="line"><span class="cl">##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">##  1  21.8     1 Leia Orga…   1.5     49 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  2  NA       1 Mon Mothma   1.5     NA auburn    fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  3  NA       1 Cordé        1.57    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  4  NA       1 Shmi Skyw…   1.63    NA black     fair      brown    fema… femin…
</span></span><span class="line"><span class="cl">##  5  27.5     1 Beru Whit…   1.65    75 brown     light     blue     fema… femin…
</span></span><span class="line"><span class="cl">##  6  16.5     1 Padmé Ami…   1.65    45 brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  7  NA       1 Dormé        1.65    NA brown     light     brown    fema… femin…
</span></span><span class="line"><span class="cl">##  8  NA       1 Jocasta Nu   1.67    NA white     fair      blue     fema… femin…
</span></span><span class="line"><span class="cl">##  9  26.6     1 Wedge Ant…   1.7     77 brown     fair      hazel    male  mascu…
</span></span><span class="line"><span class="cl">## 10  26.0     1 Palpatine    1.7     75 grey      pale      yellow   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 21 more rows
</span></span><span class="line"><span class="cl">## # ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">all</span><span class="p">(</span><span class="n">starwars_pipe</span> <span class="o">==</span> <span class="n">starwars5</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># verificando se todos elementos são iguais</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] TRUE
</span></span></code></pre></div><h2 id="resuma-com-summarise">Resuma com <code>summarise()</code></h2>
<ul>
<li>Podemos usar a função <code>summarise()</code> para gerar alguma estatística acerca de uma ou mais variáveis:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">n_obs</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="n">mean_height</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">mean_mass</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 1 × 3
</span></span><span class="line"><span class="cl">##   n_obs mean_height mean_mass
</span></span><span class="line"><span class="cl">##   &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1    87        174.      97.3
</span></span></code></pre></div><ul>
<li>No caso acima, gerou simplesmente o tamanho da amostra e as médias de altura e de massa considerando a amostra inteira de <code>starwars</code> (o que não foi muito útil).</li>
</ul>
<h2 id="agrupe-com-group_by">Agrupe com <code>group_by()</code></h2>
<ul>
<li>Diferente das outras funções do <code>dplyr</code> mostradas até agora, o output do <code>group_by</code> não altera conteúdo do data frame, apenas <strong>transforma em uma base de dados agrupada</strong> em categorias de uma dada variável</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">grouped_sw</span> <span class="o">=</span> <span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">sex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">grouped_sw</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] &#34;grouped_df&#34; &#34;tbl_df&#34;     &#34;tbl&#34;        &#34;data.frame&#34;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">starwars</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 14
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">## 2 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
</span></span><span class="line"><span class="cl">## 3 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
</span></span><span class="line"><span class="cl">## 4 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
</span></span><span class="line"><span class="cl">## 5 Leia Org…    150    49 brown      light      brown           19   fema… femin…
</span></span><span class="line"><span class="cl">## 6 Owen Lars    178   120 brown, gr… light      blue            52   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">grouped_sw</span><span class="p">)</span> <span class="c1"># agrupado por sexo</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 14
</span></span><span class="line"><span class="cl">## # Groups:   sex [3]
</span></span><span class="line"><span class="cl">##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
</span></span><span class="line"><span class="cl">## 1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
</span></span><span class="line"><span class="cl">## 2 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
</span></span><span class="line"><span class="cl">## 3 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
</span></span><span class="line"><span class="cl">## 4 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
</span></span><span class="line"><span class="cl">## 5 Leia Org…    150    49 brown      light      brown           19   fema… femin…
</span></span><span class="line"><span class="cl">## 6 Owen Lars    178   120 brown, gr… light      blue            52   male  mascu…
</span></span><span class="line"><span class="cl">## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
</span></span><span class="line"><span class="cl">## #   vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><ul>
<li>O <code>group_by()</code> prepara o data frame para operações que consideram várias linhas. Como exemplo, vamos criar uma coluna com a soma de <code>mass</code> de todas observações</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">mean_mass</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="n">mean_mass</span><span class="p">,</span> <span class="n">sex</span><span class="p">,</span> <span class="nf">everything</span><span class="p">())</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">head</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 10 × 15
</span></span><span class="line"><span class="cl">##    mean_mass sex   name  height  mass hair_color skin_color eye_color birth_year
</span></span><span class="line"><span class="cl">##        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1      97.3 male  Luke…    172    77 blond      fair       blue            19  
</span></span><span class="line"><span class="cl">##  2      97.3 none  C-3PO    167    75 &lt;NA&gt;       gold       yellow         112  
</span></span><span class="line"><span class="cl">##  3      97.3 none  R2-D2     96    32 &lt;NA&gt;       white, bl… red             33  
</span></span><span class="line"><span class="cl">##  4      97.3 male  Dart…    202   136 none       white      yellow          41.9
</span></span><span class="line"><span class="cl">##  5      97.3 fema… Leia…    150    49 brown      light      brown           19  
</span></span><span class="line"><span class="cl">##  6      97.3 male  Owen…    178   120 brown, gr… light      blue            52  
</span></span><span class="line"><span class="cl">##  7      97.3 fema… Beru…    165    75 brown      light      blue            47  
</span></span><span class="line"><span class="cl">##  8      97.3 none  R5-D4     97    32 &lt;NA&gt;       white, red red             NA  
</span></span><span class="line"><span class="cl">##  9      97.3 male  Bigg…    183    84 black      light      brown           24  
</span></span><span class="line"><span class="cl">## 10      97.3 male  Obi-…    182    77 auburn, w… fair       blue-gray       57  
</span></span><span class="line"><span class="cl">## # ℹ 6 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
</span></span><span class="line"><span class="cl">## #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><ul>
<li>Note que todos os valores de <code>mean_mass</code> são iguais. Agora, agruparemos por <code>sex</code> antes de fazer a soma:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">group_by</span><span class="p">(</span><span class="n">sex</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">mean_mass</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">ungroup</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="c1"># Lembre-se sempre de desagrupar depois!</span>
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="n">mean_mass</span><span class="p">,</span> <span class="n">sex</span><span class="p">,</span> <span class="nf">everything</span><span class="p">())</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">head</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 10 × 15
</span></span><span class="line"><span class="cl">##    mean_mass sex   name  height  mass hair_color skin_color eye_color birth_year
</span></span><span class="line"><span class="cl">##        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1      81.0 male  Luke…    172    77 blond      fair       blue            19  
</span></span><span class="line"><span class="cl">##  2      69.8 none  C-3PO    167    75 &lt;NA&gt;       gold       yellow         112  
</span></span><span class="line"><span class="cl">##  3      69.8 none  R2-D2     96    32 &lt;NA&gt;       white, bl… red             33  
</span></span><span class="line"><span class="cl">##  4      81.0 male  Dart…    202   136 none       white      yellow          41.9
</span></span><span class="line"><span class="cl">##  5      54.7 fema… Leia…    150    49 brown      light      brown           19  
</span></span><span class="line"><span class="cl">##  6      81.0 male  Owen…    178   120 brown, gr… light      blue            52  
</span></span><span class="line"><span class="cl">##  7      54.7 fema… Beru…    165    75 brown      light      blue            47  
</span></span><span class="line"><span class="cl">##  8      69.8 none  R5-D4     97    32 &lt;NA&gt;       white, red red             NA  
</span></span><span class="line"><span class="cl">##  9      81.0 male  Bigg…    183    84 black      light      brown           24  
</span></span><span class="line"><span class="cl">## 10      81.0 male  Obi-…    182    77 auburn, w… fair       blue-gray       57  
</span></span><span class="line"><span class="cl">## # ℹ 6 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
</span></span><span class="line"><span class="cl">## #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;
</span></span></code></pre></div><ul>
<li>Note que, agora, a coluna <code>mean_mass</code> tem valores diferentes de acordo com o sexo da observação.</li>
<li>Isso é útil em algumas aplicações econômicas em que consideramos variáveis a nível de grupo (e.g. domicílio) a qual uma observação (e.g. morador) pertence.</li>
</ul>
<blockquote>
<p><strong>Evite potenciais erros</strong>: Sempre que usar <code>group_by()</code>, não se esqueça de desagrupar o data frame via função <code>ungroup()</code> após realizar a operações desejadas.</p>
</blockquote>
<h2 id="resuma-em-grupos-com-group_by-e-summarise">Resuma em grupos com <code>group_by()</code> e <code>summarise()</code></h2>
<ul>
<li>A função <code>summarise()</code> é de fato útil quando combinada com a função <code>group_by()</code>, pois conseguimos obter as estatísticas de grupos:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">summary_sw</span> <span class="o">=</span> <span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">sex</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">n_obs</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">mean_height</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">mean_mass</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">summary_sw</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 5 × 4
</span></span><span class="line"><span class="cl">##   sex            n_obs mean_height mean_mass
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;          &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1 female            16        169.      54.7
</span></span><span class="line"><span class="cl">## 2 hermaphroditic     1        175     1358  
</span></span><span class="line"><span class="cl">## 3 male              60        179.      81.0
</span></span><span class="line"><span class="cl">## 4 none               6        131.      69.8
</span></span><span class="line"><span class="cl">## 5 &lt;NA&gt;               4        181.      48
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">summary_sw</span><span class="p">)</span> <span class="c1"># ao usar summary, deixa de ser agrupada</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] &#34;tbl_df&#34;     &#34;tbl&#34;        &#34;data.frame&#34;
</span></span></code></pre></div><ul>
<li>Note que, ao usar <code>summarise()</code>, o data frame resultante não é agrupado e, portanto, não é necessário usar <code>ungroup()</code> neste caso.</li>
<li>Também é possível adicionar mais de uma variável para agrupar:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">sex</span><span class="p">,</span> <span class="n">hair_color</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">n_obs</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">mean_height</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">mean_mass</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## `summarise()` has grouped output by &#39;sex&#39;. You can override using the `.groups`
</span></span><span class="line"><span class="cl">## argument.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 23 × 5
</span></span><span class="line"><span class="cl">## # Groups:   sex [5]
</span></span><span class="line"><span class="cl">##    sex            hair_color    n_obs mean_height mean_mass
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;          &lt;chr&gt;         &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1 female         auburn            1        150      NaN  
</span></span><span class="line"><span class="cl">##  2 female         black             3        166.      53.1
</span></span><span class="line"><span class="cl">##  3 female         blonde            1        168       55  
</span></span><span class="line"><span class="cl">##  4 female         brown             6        160.      56.3
</span></span><span class="line"><span class="cl">##  5 female         none              4        188.      54  
</span></span><span class="line"><span class="cl">##  6 female         white             1        167      NaN  
</span></span><span class="line"><span class="cl">##  7 hermaphroditic &lt;NA&gt;              1        175     1358  
</span></span><span class="line"><span class="cl">##  8 male           auburn, grey      1        180      NaN  
</span></span><span class="line"><span class="cl">##  9 male           auburn, white     1        182       77  
</span></span><span class="line"><span class="cl">## 10 male           black             9        176.      81.0
</span></span><span class="line"><span class="cl">## # ℹ 13 more rows
</span></span></code></pre></div><ul>
<li>Para agrupar variáveis <strong>contínuas</strong>, precisamos definir intervalos usando a função <code>cut()</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">cut(x, ...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="l">a numeric vector which is to be converted to a factor by cutting.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">breaks</span><span class="p">:</span><span class="w"> </span><span class="l">either a numeric vector of two or more unique cut points or a single number (greater than or equal to 2) giving the number of intervals into which x is to be cut.</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># breaks com um integer = qtd desejada de grupos</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="nf">cut</span><span class="p">(</span><span class="n">birth_year</span><span class="p">,</span> <span class="n">breaks</span><span class="o">=</span><span class="m">5</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">n_obs</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">mean_height</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 5 × 3
</span></span><span class="line"><span class="cl">##   `cut(birth_year, breaks = 5)` n_obs mean_height
</span></span><span class="line"><span class="cl">##   &lt;fct&gt;                         &lt;int&gt;       &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1 (7.11,186]                       40        175.
</span></span><span class="line"><span class="cl">## 2 (186,363]                         1        228 
</span></span><span class="line"><span class="cl">## 3 (541,718]                         1        175 
</span></span><span class="line"><span class="cl">## 4 (718,897]                         1         66 
</span></span><span class="line"><span class="cl">## 5 &lt;NA&gt;                             44        176.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># breaks com um vetor = quebras dos intervalos dos grupos</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">birth_year</span><span class="o">=</span><span class="nf">cut</span><span class="p">(</span><span class="n">birth_year</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                          <span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">40</span><span class="p">,</span> <span class="m">90</span><span class="p">,</span> <span class="m">200</span><span class="p">,</span> <span class="m">900</span><span class="p">)))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">summarise</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">n_obs</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">mean_height</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 5 × 3
</span></span><span class="line"><span class="cl">##   birth_year n_obs mean_height
</span></span><span class="line"><span class="cl">##   &lt;fct&gt;      &lt;int&gt;       &lt;dbl&gt;
</span></span><span class="line"><span class="cl">## 1 (0,40]        13        164.
</span></span><span class="line"><span class="cl">## 2 (40,90]       22        179.
</span></span><span class="line"><span class="cl">## 3 (90,200]       6        192.
</span></span><span class="line"><span class="cl">## 4 (200,900]      2        120.
</span></span><span class="line"><span class="cl">## 5 &lt;NA&gt;          44        176.
</span></span></code></pre></div><ul>
<li>Note que inserimos <code>birth_year=cut(birth_year, ...)</code> para que o nome da coluna ficasse <code>birth_year</code>, caso contrário a coluna ficaria com o nome <code>cut(birth_year, ...)</code>.</li>
</ul>
<h2 id="junte-bases-com-funções-_join_">Junte bases com funções <em>join</em></h2>
<ul>
<li>Vimos anteriormente que podemos usar o <code>cbind()</code> juntar um data frame com outro data frame (ou vetor), caso tenham o mesmo número de linhas</li>
<li>Para juntar linhas (considerando que as colunas possuem as mesmas classes de variáveis), podemos usar o <code>rbind</code></li>
<li>Para agrupar bases de dados a partir de variáveis-chave, usamos a função <code>merge()</code>.</li>
<li>O pacote <code>dplyr</code> fornece uma família de funções <em>join</em> que executam o mesmo comando que <code>merge()</code>, porém, ao invés de alterar o valor de um argumento, você precisa escolher uma das funções <em>join</em> que podem ser resumidas na seguinte figura:</li>
</ul>
<center><img src="../dplyr-data-join-functions.png"></center>
<ul>
<li>Todas as funções possuem a mesma sintaxe:
<ul>
<li><code>x</code>: base 1</li>
<li><code>y</code>: base 2</li>
<li><code>by</code>: vetor de variáveis-chave</li>
<li><code>suffix</code>: vetor de 2 sufixos para incluir em colunas de mesmos nomes</li>
</ul>
</li>
<li>Como exemplo, usaremos subconjuntos da base de dados <code>starwars</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">bd1</span> <span class="o">=</span> <span class="n">starwars[1</span><span class="o">:</span><span class="m">6</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">11</span><span class="p">)</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bd2</span> <span class="o">=</span> <span class="n">starwars</span><span class="nf">[c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">7</span><span class="o">:</span><span class="m">10</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span> <span class="m">6</span><span class="p">)</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bd1</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 3
</span></span><span class="line"><span class="cl">##   name            mass species
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;  
</span></span><span class="line"><span class="cl">## 1 Luke Skywalker    77 Human  
</span></span><span class="line"><span class="cl">## 2 C-3PO             75 Droid  
</span></span><span class="line"><span class="cl">## 3 R2-D2             32 Droid  
</span></span><span class="line"><span class="cl">## 4 Darth Vader      136 Human  
</span></span><span class="line"><span class="cl">## 5 Leia Organa       49 Human  
</span></span><span class="line"><span class="cl">## 6 Owen Lars        120 Human
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">bd2</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 3
</span></span><span class="line"><span class="cl">##   name               height eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;               &lt;int&gt; &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 C-3PO                 167 yellow   
</span></span><span class="line"><span class="cl">## 2 Darth Vader           202 yellow   
</span></span><span class="line"><span class="cl">## 3 Beru Whitesun lars    165 blue     
</span></span><span class="line"><span class="cl">## 4 R5-D4                  97 red      
</span></span><span class="line"><span class="cl">## 5 Biggs Darklighter     183 brown    
</span></span><span class="line"><span class="cl">## 6 Obi-Wan Kenobi        182 blue-gray
</span></span></code></pre></div><ul>
<li>Note que há 12 personagens únicos em ambas bases, mas apenas &ldquo;C-3PO&rdquo; e &ldquo;Darth Vader&rdquo; são observações comuns.</li>
<li><code>inner_join()</code>: mantém apenas ID&rsquo;s presentes simultaneamente em ambas bases</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">inner_join</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 2 × 5
</span></span><span class="line"><span class="cl">##   name         mass species height eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 C-3PO          75 Droid      167 yellow   
</span></span><span class="line"><span class="cl">## 2 Darth Vader   136 Human      202 yellow
</span></span></code></pre></div><ul>
<li><code>full_join()</code>: mantém todas ID&rsquo;s, mesmo que estejam em apenas em um das bases</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">full_join</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 10 × 5
</span></span><span class="line"><span class="cl">##    name                mass species height eye_color
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    
</span></span><span class="line"><span class="cl">##  1 Luke Skywalker        77 Human       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">##  2 C-3PO                 75 Droid      167 yellow   
</span></span><span class="line"><span class="cl">##  3 R2-D2                 32 Droid       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">##  4 Darth Vader          136 Human      202 yellow   
</span></span><span class="line"><span class="cl">##  5 Leia Organa           49 Human       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">##  6 Owen Lars            120 Human       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">##  7 Beru Whitesun lars    NA &lt;NA&gt;       165 blue     
</span></span><span class="line"><span class="cl">##  8 R5-D4                 NA &lt;NA&gt;        97 red      
</span></span><span class="line"><span class="cl">##  9 Biggs Darklighter     NA &lt;NA&gt;       183 brown    
</span></span><span class="line"><span class="cl">## 10 Obi-Wan Kenobi        NA &lt;NA&gt;       182 blue-gray
</span></span></code></pre></div><ul>
<li><code>left_join()</code>: mantém apenas ID&rsquo;s presentes na base 1 (informada como <code>x</code>)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">left_join</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 5
</span></span><span class="line"><span class="cl">##   name            mass species height eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 Luke Skywalker    77 Human       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">## 2 C-3PO             75 Droid      167 yellow   
</span></span><span class="line"><span class="cl">## 3 R2-D2             32 Droid       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">## 4 Darth Vader      136 Human      202 yellow   
</span></span><span class="line"><span class="cl">## 5 Leia Organa       49 Human       NA &lt;NA&gt;     
</span></span><span class="line"><span class="cl">## 6 Owen Lars        120 Human       NA &lt;NA&gt;
</span></span></code></pre></div><ul>
<li><code>right_join()</code>: mantém apenas ID&rsquo;s presentes na base 2 (informada como <code>y</code>)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">right_join</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 6 × 5
</span></span><span class="line"><span class="cl">##   name                mass species height eye_color
</span></span><span class="line"><span class="cl">##   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    
</span></span><span class="line"><span class="cl">## 1 C-3PO                 75 Droid      167 yellow   
</span></span><span class="line"><span class="cl">## 2 Darth Vader          136 Human      202 yellow   
</span></span><span class="line"><span class="cl">## 3 Beru Whitesun lars    NA &lt;NA&gt;       165 blue     
</span></span><span class="line"><span class="cl">## 4 R5-D4                 NA &lt;NA&gt;        97 red      
</span></span><span class="line"><span class="cl">## 5 Biggs Darklighter     NA &lt;NA&gt;       183 brown    
</span></span><span class="line"><span class="cl">## 6 Obi-Wan Kenobi        NA &lt;NA&gt;       182 blue-gray
</span></span></code></pre></div><ul>
<li>Note que podemos incluir mais de uma variável-chave para correspondência entre ID&rsquo;s de ambas bases. Primeiro, vamos construir as bases como paineis</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">bd1</span> <span class="o">=</span> <span class="n">starwars[1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bd1</span> <span class="o">=</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd1</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">year</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">2021</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span> <span class="nf">rep</span><span class="p">(</span><span class="m">2022</span><span class="p">,</span> <span class="m">5</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">           <span class="c1"># Se não for ano 2021, multiplica por um número aleatório ~ N(1, 0.025)</span>
</span></span><span class="line"><span class="cl">           <span class="n">mass</span> <span class="o">=</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">year</span> <span class="o">==</span> <span class="m">2021</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">mass</span><span class="o">*</span><span class="nf">rnorm</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.025</span><span class="p">)))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">mass</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">arrange</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">bd1</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 10 × 3
</span></span><span class="line"><span class="cl">##    name            year  mass
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1 C-3PO           2021  75  
</span></span><span class="line"><span class="cl">##  2 C-3PO           2022  75.5
</span></span><span class="line"><span class="cl">##  3 Darth Vader     2021 136  
</span></span><span class="line"><span class="cl">##  4 Darth Vader     2022 135. 
</span></span><span class="line"><span class="cl">##  5 Leia Organa     2021  49  
</span></span><span class="line"><span class="cl">##  6 Leia Organa     2022  51.3
</span></span><span class="line"><span class="cl">##  7 Luke Skywalker  2021  77  
</span></span><span class="line"><span class="cl">##  8 Luke Skywalker  2022  75.4
</span></span><span class="line"><span class="cl">##  9 R2-D2           2021  32  
</span></span><span class="line"><span class="cl">## 10 R2-D2           2022  33.8
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">bd2</span> <span class="o">=</span> <span class="n">starwars</span><span class="nf">[c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">7</span><span class="o">:</span><span class="m">9</span><span class="p">),</span> <span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bd2</span> <span class="o">=</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">bd2</span><span class="p">,</span> <span class="n">bd2</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">year</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">2021</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span> <span class="nf">rep</span><span class="p">(</span><span class="m">2022</span><span class="p">,</span> <span class="m">5</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">           <span class="c1"># Se não for ano 2021, altura cresce 2%</span>
</span></span><span class="line"><span class="cl">           <span class="n">height</span> <span class="o">=</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">year</span> <span class="o">==</span> <span class="m">2021</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">height</span><span class="o">*</span><span class="m">1.02</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">arrange</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">bd2</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 10 × 3
</span></span><span class="line"><span class="cl">##    name                year height
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;              &lt;dbl&gt;  &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1 Beru Whitesun lars  2021  165  
</span></span><span class="line"><span class="cl">##  2 Beru Whitesun lars  2022  168. 
</span></span><span class="line"><span class="cl">##  3 Biggs Darklighter   2021  183  
</span></span><span class="line"><span class="cl">##  4 Biggs Darklighter   2022  187. 
</span></span><span class="line"><span class="cl">##  5 C-3PO               2021  167  
</span></span><span class="line"><span class="cl">##  6 C-3PO               2022  170. 
</span></span><span class="line"><span class="cl">##  7 Darth Vader         2021  202  
</span></span><span class="line"><span class="cl">##  8 Darth Vader         2022  206. 
</span></span><span class="line"><span class="cl">##  9 R5-D4               2021   97  
</span></span><span class="line"><span class="cl">## 10 R5-D4               2022   98.9
</span></span></code></pre></div><ul>
<li>Note agora que, para cada personagem, temos 2 linhas que correspondem aos dois anos (2021 e 2022). Faremos um <code>full_join()</code> considerando como variáveis-chave ambos <code>name</code> e <code>year</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Juntando as bases</span>
</span></span><span class="line"><span class="cl"><span class="nf">full_join</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;year&#34;</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 16 × 4
</span></span><span class="line"><span class="cl">##    name                year  mass height
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1 C-3PO               2021  75    167  
</span></span><span class="line"><span class="cl">##  2 C-3PO               2022  75.5  170. 
</span></span><span class="line"><span class="cl">##  3 Darth Vader         2021 136    202  
</span></span><span class="line"><span class="cl">##  4 Darth Vader         2022 135.   206. 
</span></span><span class="line"><span class="cl">##  5 Leia Organa         2021  49     NA  
</span></span><span class="line"><span class="cl">##  6 Leia Organa         2022  51.3   NA  
</span></span><span class="line"><span class="cl">##  7 Luke Skywalker      2021  77     NA  
</span></span><span class="line"><span class="cl">##  8 Luke Skywalker      2022  75.4   NA  
</span></span><span class="line"><span class="cl">##  9 R2-D2               2021  32     NA  
</span></span><span class="line"><span class="cl">## 10 R2-D2               2022  33.8   NA  
</span></span><span class="line"><span class="cl">## 11 Beru Whitesun lars  2021  NA    165  
</span></span><span class="line"><span class="cl">## 12 Beru Whitesun lars  2022  NA    168. 
</span></span><span class="line"><span class="cl">## 13 Biggs Darklighter   2021  NA    183  
</span></span><span class="line"><span class="cl">## 14 Biggs Darklighter   2022  NA    187. 
</span></span><span class="line"><span class="cl">## 15 R5-D4               2021  NA     97  
</span></span><span class="line"><span class="cl">## 16 R5-D4               2022  NA     98.9
</span></span></code></pre></div><ul>
<li>Atente-se também aos nomes das variáveis, pois ao juntar bases com variáveis de mesmos nomes (que não são usadas como chave), a função acaba incluindo ambas variáveis renomeadas, por padrão, com sufixos <code>.x</code> e <code>.y</code> (sufixos podem ser alterados pelo argumento <code>suffix</code>)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">bd2</span> <span class="o">=</span> <span class="n">bd2</span> <span class="o">%&gt;%</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">mass</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">10</span><span class="p">))</span> <span class="c1"># Criando uma variável mass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">full_join</span><span class="p">(</span><span class="n">bd1</span><span class="p">,</span> <span class="n">bd2</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;year&#34;</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## # A tibble: 16 × 5
</span></span><span class="line"><span class="cl">##    name                year mass.x height mass.y
</span></span><span class="line"><span class="cl">##    &lt;chr&gt;              &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
</span></span><span class="line"><span class="cl">##  1 C-3PO               2021   75    167    1.04 
</span></span><span class="line"><span class="cl">##  2 C-3PO               2022   75.5  170.  -1.36 
</span></span><span class="line"><span class="cl">##  3 Darth Vader         2021  136    202   -0.329
</span></span><span class="line"><span class="cl">##  4 Darth Vader         2022  135.   206.   1.07 
</span></span><span class="line"><span class="cl">##  5 Leia Organa         2021   49     NA   NA    
</span></span><span class="line"><span class="cl">##  6 Leia Organa         2022   51.3   NA   NA    
</span></span><span class="line"><span class="cl">##  7 Luke Skywalker      2021   77     NA   NA    
</span></span><span class="line"><span class="cl">##  8 Luke Skywalker      2022   75.4   NA   NA    
</span></span><span class="line"><span class="cl">##  9 R2-D2               2021   32     NA   NA    
</span></span><span class="line"><span class="cl">## 10 R2-D2               2022   33.8   NA   NA    
</span></span><span class="line"><span class="cl">## 11 Beru Whitesun lars  2021   NA    165    0.248
</span></span><span class="line"><span class="cl">## 12 Beru Whitesun lars  2022   NA    168.  -0.581
</span></span><span class="line"><span class="cl">## 13 Biggs Darklighter   2021   NA    183   -0.613
</span></span><span class="line"><span class="cl">## 14 Biggs Darklighter   2022   NA    187.   0.286
</span></span><span class="line"><span class="cl">## 15 R5-D4               2021   NA     97   -0.138
</span></span><span class="line"><span class="cl">## 16 R5-D4               2022   NA     98.9  0.723
</span></span></code></pre></div>

<ul class="cta-group">
  
  <li>
    <a href="../sec5"  class="btn btn-primary px-3 py-3">👉 Seguir para Visualização de Dados</a>
  </li>
  
  
</ul>



        </article>

        





        



        
        
        <div class="article-widget">
          
<div class="post-nav">
  
  
</div>

        </div>
        
      </div>

      <div class="body-footer">
        <p>Last updated on Sep 9, 2018</p>

        




        




        


      </div>

      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2023 Me. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  


<script src="/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js"></script>




  

  
  

  









<script src="https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
<script>
  anchors.add();
</script>





  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  







<script id="page-data" type="application/json">{"use_headroom":false}</script>












  
  


<script src="/en/js/wowchemy.min.e8ee06ba8371980ffde659871dd593b0.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>


















</body>
</html>
