<div id="mqo-na-forma-matricial" class="section level2" number="0.1">
<h2><span class="header-section-number">0.1</span> MQO na forma matricial</h2>
<ul>
<li><a href="http://www.urfie.net/read/index.html#page/119">Seção 3.2 de Heiss (2020)</a></li>
</ul>
<div id="notações" class="section level3" number="0.1.1">
<h3><span class="header-section-number">0.1.1</span> Notações</h3>
<ul>
<li><p>Para mais detalhes sobre a forma matricial do MQO, ver Apêndice E de Wooldridge (2006)</p></li>
<li><p>Considere o modelo multivariado com {{<math>}}<span class="math inline">\(K\)</span>{{</math>}} regressores para a observação {{<math>}}<span class="math inline">\(i\)</span>{{</math>}}:
<span class="math display">\[ y_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + ... + \beta_K x_{iK} + \varepsilon_i, \qquad i=1, 2, ..., N \tag{E.1} \]</span>
em que {{<math>}}<span class="math inline">\(N\)</span>{{</math>}} é o número de observações.</p></li>
<li><p>Defina o vetor-coluna de parâmetros, {{<math>}}<span class="math inline">\(\boldsymbol{\beta}\)</span>{{</math>}}, e o vetor-linha de variáveis independentes da observação {{<math>}}<span class="math inline">\(i\)</span>{{</math>}}, {{<math>}}<span class="math inline">\(\boldsymbol{x}_i\)</span>{{</math>}} (minúsculo):
{{<math>}}<span class="math display">\[ \underset{1 \times K}{\boldsymbol{x}_i} = \left[ \begin{matrix} 1 &amp; x_{i1} &amp; x_{i2} &amp; \cdots &amp; x_{iK}  \end{matrix} \right]  \qquad \text{e} \qquad  \underset{(K+1) \times 1}{\boldsymbol{\beta}} = \left[ \begin{matrix} \beta_0 \\ \beta_1 \\ \beta_2 \\ \vdots \\ \beta_K \end{matrix} \right],\]</span>{{</math>}}</p></li>
<li><p>Note que o produto interno {{<math>}}<span class="math inline">\(\boldsymbol{x}_i \boldsymbol{\beta}\)</span>{{</math>}} é:</p></li>
</ul>
<p>{{<math>}}<span class="math display">\[\begin{align} \underset{1 \times 1}{\boldsymbol{x}_i \boldsymbol{\beta}} &amp;= \left[ \begin{matrix} 1 &amp; x_{i1} &amp; x_{i2} &amp; \cdots &amp; x_{iK}  \end{matrix} \right]  \left[ \begin{matrix} \beta_0 \\ \beta_1 \\ \beta_2 \\ \vdots \\ \beta_K \end{matrix} \right]\\
&amp;= 1.\beta_0 + x_{i1} \beta_1  + x_{i2} \beta_2 + \cdots + x_{iK} \beta_K, \end{align}\]</span>{{</math>}}</p>
<ul>
<li>Logo, a equação (3.1) pode ser reescrita, para {{<math>}}<span class="math inline">\(i=1, 2, ..., N\)</span>{{</math>}}, como</li>
</ul>
<p><span class="math display">\[ y_i = \underbrace{\beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + ... + \beta_K x_{iK}}_{\boldsymbol{x}_i \boldsymbol{\beta}} + \varepsilon_i = \boldsymbol{x}_i \boldsymbol{\beta} + \varepsilon_i, \tag{E.2} \]</span></p>
<ul>
<li>Considere {{<math>}}<span class="math inline">\(\boldsymbol{X}\)</span>{{</math>}} a matriz de todas {{<math>}}<span class="math inline">\(N\)</span>{{</math>}} observações para as {{<math>}}<span class="math inline">\(K+1\)</span>{{</math>}} variáveis explicativas:</li>
</ul>
<p>{{<math>}}<span class="math display">\[ \underset{N \times (K+1)}{\boldsymbol{X}} = \left[ \begin{matrix} \boldsymbol{x}_1 \\ \boldsymbol{x}_2 \\ \vdots \\ \boldsymbol{x}_N \end{matrix} \right] = \left[ \begin{matrix} 1 &amp; x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1K}   \\ 1 &amp; x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2K} \\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 1 &amp; x_{N1} &amp; x_{N2} &amp; \cdots &amp; x_{NK} \end{matrix} \right] , \]</span>{{</math>}}</p>
<ul>
<li>Agora, podemos “empilhar” as equações (3.2) para todo {{<math>}}<span class="math inline">\(i=1, 2, ..., N\)</span>{{</math>}} e obtemos:</li>
</ul>
<p>{{<math>}}<span class="math display">\[\begin{align} \boldsymbol{y} &amp;= \boldsymbol{X} \boldsymbol{\beta} + \boldsymbol{\varepsilon} \tag{E.3} \\
&amp;= \left[ \begin{matrix} 1 &amp; x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1K}   \\ 1 &amp; x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2K} \\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 1 &amp; x_{N1} &amp; x_{N2} &amp; \cdots &amp; x_{NK} \end{matrix} \right] \left[ \begin{matrix} \beta_0 \\ \beta_1 \\ \beta_2 \\ \vdots \\ \beta_K \end{matrix} \right] + \left[ \begin{matrix}\varepsilon_1 \\ \varepsilon_2 \\ \vdots \\ \varepsilon_N \end{matrix} \right]   \\
&amp;= \left[ \begin{matrix} \beta_0. 1 + \beta_1 x_{11} + \beta_2 x_{12} + ... + \beta_K x_{1K} \\ \beta_0 .1 + \beta_1 x_{21} + \beta_2 x_{22} + ... + \beta_K x_{2K} \\ \vdots \\ \beta_0. 1 + \beta_1 x_{N1} + \beta_2 x_{N2} + ... + \beta_K x_{NK} \end{matrix} \right] + \left[ \begin{matrix}\varepsilon_1 \\ \varepsilon_2 \\ \vdots \\ \varepsilon_N \end{matrix} \right]\\
&amp;= \left[ \begin{matrix} \beta_0. 1 + \beta_1 x_{11} + \beta_2 x_{12} + ... + \beta_K x_{1K} + \varepsilon_1 \\ \beta_0 .1 + \beta_1 x_{21} + \beta_2 x_{22} + ... + \beta_K x_{2K} + \varepsilon_2 \\ \vdots \\ \beta_0. 1 + \beta_1 x_{N1} + \beta_2 x_{N2} + ... + \beta_K x_{NK} + \varepsilon_N \end{matrix} \right]\\
&amp;= \left[ \begin{matrix}y_1 \\ y_2 \\ \vdots \\ y_N \end{matrix} \right] = \boldsymbol{y} \end{align}\]</span>{{</math>}}</p>
<p></br></p>
</div>
<div id="operações-matriciais-no-r" class="section level3" number="0.1.2">
<h3><span class="header-section-number">0.1.2</span> Operações matriciais no R</h3>
<ul>
<li><a href="https://www.coursera.org/learn/r-programming/lecture/nobfZ/vectorized-operations">Vectorized operations (John Hopkins/Coursera)</a></li>
<li>Ao utilizar as operações matemáticas convencionais em vetores, cada elemento é operacionalizado com o elemento na mesma posição do outro vetor</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> x <span class="co"># soma de cada elemento na mesma posição</span></span></code></pre></div>
<pre><code>## [1] 2 4 6 8</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> <span class="dv">2</span> <span class="co"># soma de de cada elemento com um mesmo escalar</span></span></code></pre></div>
<pre><code>## [1] 3 4 5 6</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">*</span> x <span class="co"># multiplicação de cada elemento na mesma posição</span></span></code></pre></div>
<pre><code>## [1]  1  4  9 16</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">/</span> x <span class="co"># divisão de cada elemento na mesma posição</span></span></code></pre></div>
<pre><code>## [1] 1 1 1 1</code></pre>
<ul>
<li>Além disso, podemos fazer
<ul>
<li><strong>Transposta de uma matriz ou vetor</strong>: função <code>t()</code></li>
<li><strong>Multiplicação matricial ou vetorial (produto interno)</strong>: operador <code>%*%</code></li>
<li><strong>Inversa de uma matriz (quadrada)</strong>: função <code>solve()</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Operações vetoriais</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%*%</span> x <span class="co"># x vetor-linha / x vetor-coluna</span></span></code></pre></div>
<pre><code>##      [,1]
## [1,]   30</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%*%</span> <span class="fu">t</span>(x) <span class="co"># x vetor-coluna / x vetor-linha (altera ambos, mas t() só no 2o)</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    2    4    6    8
## [3,]    3    6    9   12
## [4,]    4    8   12   16</code></pre>
<ul>
<li>Por padrão, o R considera que o 1º vetor é um vetor-linha e o 2º é um vetor-coluna quando fazemos uma multiplicação vetorial.</li>
<li>Dado que adotamos vetores-coluna como padrão, sugiro “forçar” um vetor em linha ou em coluna via função <code>matrix()</code>.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformando em vetor-coluna</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>x_col <span class="ot">=</span> <span class="fu">matrix</span>(x, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>x_col</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    1
## [2,]    2
## [3,]    3
## [4,]    4</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Operações vetoriais</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(x_col) <span class="sc">%*%</span> x_col <span class="co"># produto interno</span></span></code></pre></div>
<pre><code>##      [,1]
## [1,]   30</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>x_col <span class="sc">%*%</span> <span class="fu">t</span>(x_col) <span class="co"># produto externo</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    2    4    6    8
## [3,]    3    6    9   12
## [4,]    4    8   12   16</code></pre>
<p></br></p>
<ul>
<li>O mesmo é válido para matrizes:</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Como exemplo, criaremos matriz X de dimensão 4x2</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    5
## [2,]    2    6
## [3,]    3    7
## [4,]    4    8</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transposta de X (2x4)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(X)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    5    6    7    8</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Produto matricial X&#39;X (2x2)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(X) <span class="sc">%*%</span> X</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   30   70
## [2,]   70  174</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inversa de X&#39;X (2x2)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>( <span class="fu">t</span>(X) <span class="sc">%*%</span> X )</span></code></pre></div>
<pre><code>##          [,1]     [,2]
## [1,]  0.54375 -0.21875
## [2,] -0.21875  0.09375</code></pre>
<ul>
<li>Também podemos criar uma matrix identidade usando a função <code>diag()</code> e informando um número inteiro</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz identidade de dimensão 4</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>I <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">4</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>I</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    0    0    0
## [2,]    0    1    0    0
## [3,]    0    0    1    0
## [4,]    0    0    0    1</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># diag() pode alterar valores da diagonal de uma matriz existente</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(I) <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>I</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    0    0    0
## [2,]    0    2    0    0
## [3,]    0    0    3    0
## [4,]    0    0    0    4</code></pre>
<p></br></p>
</div>
</div>
<div id="estimação-mqo-multivariado" class="section level2" number="0.2">
<h2><span class="header-section-number">0.2</span> Estimação MQO multivariado</h2>
<div id="regressão-múltipla-via-lm" class="section level3" number="0.2.1">
<h3><span class="header-section-number">0.2.1</span> Regressão Múltipla via <code>lm()</code></h3>
<ul>
<li><p><a href="http://www.urfie.net/read/index.html#page/115">Seção 3.1 de Heiss (2020)</a></p></li>
<li><p>Para estimar um modelo multivariado no R, podemos usar a função <code>lm()</code>:</p>
<ul>
<li>O til (<code>~</code>) separa a a variável dependente das variáveis independentes</li>
<li>As variáveis independentes precisam ser separadas por um <code>+</code></li>
<li>O intercepto ({{<math>}}<span class="math inline">\(\beta_0\)</span>{{</math>}}) é incluído automaticamente pela função <code>lm()</code> – para retirá-lo, é preciso incluir a “variável” <code>0</code> na fórmula.</li>
</ul></li>
</ul>
<div id="exemplo-3.1-determinantes-da-nota-média-em-curso-superior-nos-eua" class="section level4" number="0.2.1.1">
<h4><span class="header-section-number">0.2.1.1</span> Exemplo 3.1: Determinantes da Nota Média em Curso Superior nos EUA</h4>
<ul>
<li>Sejam as variáveis
<ul>
<li><code>colGPA</code> (<em>college GPA</em>): a nota média em um curso superior,</li>
<li><code>hsGPA</code> (<em>high school GPA</em>): a nota médio do ensino médio, e</li>
<li><code>ACT</code> (<em>achievement test score</em>): a nota de avaliação de conhecimentos para ingresso no ensino superior.</li>
</ul></li>
<li>Usando a base <code>gpa1</code> do pacote <code>wooldridge</code>, vamos estimar o seguinte modelo:</li>
</ul>
<p><span class="math display">\[ \text{colGPA} = \beta_0 + \beta_1 \text{hsGPA} + \beta_2 \text{ACT} + u \]</span></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Acessando a base de dados gpa1</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gpa1, <span class="at">package =</span> <span class="st">&quot;wooldridge&quot;</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimando o modelo</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>GPAres <span class="ot">=</span> <span class="fu">lm</span>(colGPA <span class="sc">~</span> hsGPA <span class="sc">+</span> ACT, <span class="at">data =</span> gpa1)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>GPAres</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = colGPA ~ hsGPA + ACT, data = gpa1)
## 
## Coefficients:
## (Intercept)        hsGPA          ACT  
##    1.286328     0.453456     0.009426</code></pre>
<ul>
<li>Note que podemos ver mais detalhes da estimação usando a função <code>summary()</code> no objeto resultante da função <code>lm()</code></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GPAres)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = colGPA ~ hsGPA + ACT, data = gpa1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.85442 -0.24666 -0.02614  0.28127  0.85357 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.286328   0.340822   3.774 0.000238 ***
## hsGPA       0.453456   0.095813   4.733 5.42e-06 ***
## ACT         0.009426   0.010777   0.875 0.383297    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3403 on 138 degrees of freedom
## Multiple R-squared:  0.1764, Adjusted R-squared:  0.1645 
## F-statistic: 14.78 on 2 and 138 DF,  p-value: 1.526e-06</code></pre>
</div>
</div>
<div id="estimação-analítica-no-r-parte-1" class="section level3" number="0.2.2">
<h3><span class="header-section-number">0.2.2</span> Estimação Analítica no R (parte 1)</h3>
<div id="exemplo---determinantes-da-nota-média-em-curso-superior-nos-eua" class="section level4" number="0.2.2.1">
<h4><span class="header-section-number">0.2.2.1</span> Exemplo - Determinantes da Nota Média em Curso Superior nos EUA</h4>
<ul>
<li><p>Queremos estimar o modelo:
<span class="math display">\[ \text{colGPA} = \beta_0 + \beta_1 \text{hsGPA} + \beta_2 \text{ACT} + u \]</span></p></li>
<li><p>A partir da base de dados <code>gpa1</code>, vamos criar o vetor da variável dependente <code>y</code> e a matrix das variáveis independentes <code>X</code>:</p></li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Acessando a base de dados gpa1</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gpa1, <span class="at">package =</span> <span class="st">&quot;wooldridge&quot;</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando o vetor y</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">as.matrix</span>(gpa1[,<span class="st">&quot;colGPA&quot;</span>]) <span class="co"># transformando coluna de data frame em matriz</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(y)</span></code></pre></div>
<pre><code>##      [,1]
## [1,]  3.0
## [2,]  3.4
## [3,]  3.0
## [4,]  3.5
## [5,]  3.6
## [6,]  3.0</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a matriz de covariadas X com primeira coluna de 1&#39;s</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">cbind</span>( <span class="at">const=</span><span class="dv">1</span>, gpa1[, <span class="fu">c</span>(<span class="st">&quot;hsGPA&quot;</span>, <span class="st">&quot;ACT&quot;</span>)] ) <span class="co"># juntando 1&#39;s com as covariadas</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">as.matrix</span>(X) <span class="co"># transformando em matriz</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code></pre></div>
<pre><code>##   const hsGPA ACT
## 1     1   3.0  21
## 2     1   3.2  24
## 3     1   3.6  26
## 4     1   3.5  27
## 5     1   3.9  28
## 6     1   3.4  25</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pegando valores N e K</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">nrow</span>(gpa1)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>N</span></code></pre></div>
<pre><code>## [1] 141</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="fu">ncol</span>(X) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>K</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div id="estimativas-de-mqo-hatboldsymbolbeta" class="section level5" number="0.2.2.1.1">
<h5><span class="header-section-number">0.2.2.1.1</span> 1. Estimativas de MQO {{<math>}}<span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span>{{</math>}}</h5>
<p>{{<math>}}<span class="math display">\[ \hat{\boldsymbol{\beta}} = \left[ \begin{matrix} \hat{\beta}_0 \\ \hat{\beta}_1 \\ \hat{\beta}_2 \\ \vdots \\ \hat{\beta}_K \end{matrix} \right] = (\boldsymbol{X}&#39;\boldsymbol{X})^{-1} \boldsymbol{X}&#39; \boldsymbol{y} \tag{3.2} \]</span>{{</math>}}</p>
<p>No R:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>bhat <span class="ot">=</span> <span class="fu">solve</span>( <span class="fu">t</span>(X) <span class="sc">%*%</span> X ) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>bhat</span></code></pre></div>
<pre><code>##              [,1]
## const 1.286327767
## hsGPA 0.453455885
## ACT   0.009426012</code></pre>
</div>
<div id="valores-ajustadospreditos-hatboldsymboly" class="section level5" number="0.2.2.1.2">
<h5><span class="header-section-number">0.2.2.1.2</span> 2. Valores ajustados/preditos {{<math>}}<span class="math inline">\(\hat{\boldsymbol{y}}\)</span>{{</math>}}</h5>
<p>{{<math>}}<span class="math display">\[ \hat{\boldsymbol{y}} = \boldsymbol{X} \hat{\boldsymbol{\beta}}  \]</span>{{</math>}}</p>
<p>No R:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">=</span> X <span class="sc">%*%</span> bhat</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(yhat)</span></code></pre></div>
<pre><code>##       [,1]
## 1 2.844642
## 2 2.963611
## 3 3.163845
## 4 3.127926
## 5 3.318734
## 6 3.063728</code></pre>
</div>
<div id="resíduos-hatboldsymbolvarepsilon" class="section level5" number="0.2.2.1.3">
<h5><span class="header-section-number">0.2.2.1.3</span> 3. Resíduos {{<math>}}<span class="math inline">\(\hat{\boldsymbol{\varepsilon}}\)</span>{{</math>}}</h5>
<p>{{<math>}}<span class="math display">\[ \hat{\boldsymbol{\varepsilon}} = \boldsymbol{y} - \hat{\boldsymbol{y}} \tag{3.3}  \]</span>{{</math>}}</p>
<p>No R:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>ehat <span class="ot">=</span> y <span class="sc">-</span> yhat</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ehat)</span></code></pre></div>
<pre><code>##          [,1]
## 1  0.15535832
## 2  0.43638918
## 3 -0.16384523
## 4  0.37207430
## 5  0.28126580
## 6 -0.06372813</code></pre>
</div>
<div id="comparando-estimativas-lm-e-analítica" class="section level5" number="0.2.2.1.4">
<h5><span class="header-section-number">0.2.2.1.4</span> Comparando estimativas <code>lm()</code> e analítica</h5>
<ul>
<li>Até agora, obtivemos as estimativas {{<math>}}<span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span>{{</math>}} e seus erros-padrão {{<math>}}<span class="math inline">\(\text{se}(\hat{\boldsymbol{\beta}})\)</span>{{</math>}}:</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(bhat, GPAres<span class="sc">$</span>coef)</span></code></pre></div>
<pre><code>##              [,1]        [,2]
## const 1.286327767 1.286327767
## hsGPA 0.453455885 0.453455885
## ACT   0.009426012 0.009426012</code></pre>
<!-- - E, portanto, ainda percisamos concluir a parte de inferência da estimação por meio do cálculo da estatística _t_ e do p-valor: -->
<!-- ```{r} -->
<!-- summary(GPAres)$coef -->
<!-- ``` -->
<p></br></p>
</div>
</div>
</div>
</div>
<div id="inferência-mqo-multivariado" class="section level2" number="0.3">
<h2><span class="header-section-number">0.3</span> Inferência MQO multivariado</h2>
<div id="matriz-de-variâncias-covariâncias-dos-erros" class="section level3" number="0.3.1">
<h3><span class="header-section-number">0.3.1</span> Matriz de Variâncias-Covariâncias dos Erros</h3>
<p>A Matriz de Variâncias-Covariâncias dos Erros relaciona um termo de erro, {{<math>}}<span class="math inline">\(\varepsilon_{i}\)</span>{{</math>}}, com todos os demais termos de erro {{<math>}}<span class="math inline">\(\varepsilon_{j}\)</span>{{</math>}}, para todo {{<math>}}<span class="math inline">\(j = 1, ..., N\)</span>{{</math>}}.</p>
<p>Na matriz de covariância de erro, cada linha representa um {{<math>}}<span class="math inline">\(\varepsilon_{i}\)</span>{{</math>}} e cada coluna representa um {{<math>}}<span class="math inline">\(\varepsilon_{j}\)</span>{{</math>}}. Seus elementos representam a covariância entre
{{<math>}}<span class="math inline">\(\varepsilon_{i}\)</span>{{</math>}} e {{<math>}}<span class="math inline">\(\varepsilon_{j}\)</span>{{</math>}}, sendo que pode haver {{<math>}}<span class="math inline">\(\varepsilon_{i} = \varepsilon_{j}\)</span>{{</math>}} (que, neste caso, torna-se variância):</p>
<p>{{<math>}}<span class="math display">\[ cov(\boldsymbol{\varepsilon}) = \underset{N \times N}{\boldsymbol{\Sigma}} = 
\left[ \begin{array}{cccc}
var(\varepsilon_{1}) &amp; cov(\varepsilon_{1}, \varepsilon_{2}) &amp; \cdots &amp; cov(\varepsilon_{1}, \varepsilon_{N}) \\
cov(\varepsilon_{2}, \varepsilon_{1}) &amp; var(\varepsilon_{2}) &amp; \cdots &amp; cov(\varepsilon_{2}, \varepsilon_{N}) \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
cov(\varepsilon_{N}, \varepsilon_{1}) &amp; cov(\varepsilon_{N}, \varepsilon_{2}) &amp; \cdots &amp; var(\varepsilon_{N}) 
\end{array} \right]\]</span>{{</math>}}</p>
<p>Como assumimos amostragem aleatória, a covariância entre dois indivíduos distintos {{<math>}}(<span class="math inline">\(i \neq j\)</span>){{</math>}} é<br />
{{<math>}}<span class="math display">\[ cov(\varepsilon_{i}, \varepsilon_{j}) = 0,  \qquad \text{para todo } i \neq j.\]</span>{{</math>}}</p>
<p>Logo,
{{<math>}}<span class="math display">\[ \boldsymbol{\Sigma} = 
\left[ \begin{array}{cccc}
var(\varepsilon_{1}) &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; var(\varepsilon_{2}) &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; var(\varepsilon_{N}) 
\end{array} \right]\]</span>{{</math>}}</p>
<p>Como também assumimos homocedasticidade, {{<math>}}$ var(_i) = ^2, i${{</math>}}, então:</p>
<p>{{<math>}}<span class="math display">\[ \boldsymbol{\Sigma} = 
\left[ \begin{array}{cccc}
\sigma^2 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; \sigma^2 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; \sigma^2 
\end{array} \right] = \sigma^2 \begin{bmatrix} 1 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; 1 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; 1  \end{bmatrix} = \sigma^2 I_N \]</span>{{</math>}}</p>
<div id="variância-do-termo-de-erro-hatsigma2" class="section level5" number="0.3.1.0.1">
<h5><span class="header-section-number">0.3.1.0.1</span> 4. Variância do termo de erro {{<math>}}<span class="math inline">\(\hat{\sigma}^2\)</span>{{</math>}}</h5>
<p>{{<math>}}<span class="math display">\[ \hat{\sigma}^2 = \frac{\hat{\boldsymbol{\varepsilon}}&#39;\hat{\boldsymbol{\varepsilon}}}{N-K-1} \tag{3.4}  \]</span>{{</math>}}</p>
<p>No R, como {{<math>}}<span class="math inline">\(\hat{\sigma}^2\)</span>{{</math>}} é um escalar, é conveniente transformar a “matriz 1x1” em um número usando <code>as.numeric()</code>:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>sig2hat <span class="ot">=</span> <span class="fu">as.numeric</span>( <span class="fu">t</span>(ehat) <span class="sc">%*%</span> ehat <span class="sc">/</span> (N<span class="sc">-</span>K<span class="dv">-1</span>) )</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>sig2hat</span></code></pre></div>
<pre><code>## [1] 0.1158148</code></pre>
</div>
<div id="matriz-de-variâncias-covariâncias-do-estimador-textvhatboldsymbolbeta" class="section level5" number="0.3.1.0.2">
<h5><span class="header-section-number">0.3.1.0.2</span> 5. Matriz de Variâncias-Covariâncias do Estimador {{<math>}}<span class="math inline">\(\text{V}(\hat{\boldsymbol{\beta}})\)</span>{{</math>}}</h5>
<ul>
<li>Como MQO supõe {{<math>}}$  = ^2  ${{</math>}}, então a Matriz de Variâncias-Covariâncias do Estimador pode ser simplificado cmo:</li>
</ul>
<p>{{<math>}}<span class="math display">\[\begin{align} V(\hat{\boldsymbol{\beta}}) 
&amp;= (\boldsymbol{X}&#39;\boldsymbol{X})^{-1} \boldsymbol{X}&#39; \boldsymbol{\Sigma} \boldsymbol{X} (\boldsymbol{X}&#39;\boldsymbol{X})^{-1} \\ 
&amp;= (\boldsymbol{X}&#39;\boldsymbol{X})^{-1} \boldsymbol{X}&#39; \left[ \sigma^2 \boldsymbol{I} \right] \boldsymbol{X} (\boldsymbol{X}&#39;\boldsymbol{X})^{-1} \\
&amp;= \sigma^2 (\boldsymbol{X}&#39;\boldsymbol{X})^{-1} \boldsymbol{X}&#39; \boldsymbol{X} (\boldsymbol{X}&#39;\boldsymbol{X})^{-1} \\
&amp;= \hat{\sigma}^2 (\boldsymbol{X}&#39;\boldsymbol{X})^{-1} \end{align}\]</span>{{</math>}}</p>
<p>No R, como {{<math>}}<span class="math inline">\(\hat{\sigma}^2\)</span>{{</math>}} é um escalar, é conveniente transformar a “matriz 1x1” em um número usando <code>as.numeric()</code>:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>Vbhat <span class="ot">=</span> sig2hat <span class="sc">*</span> <span class="fu">solve</span>( <span class="fu">t</span>(X) <span class="sc">%*%</span> X )</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Vbhat</span></code></pre></div>
<pre><code>##              const         hsGPA           ACT
## const  0.116159717 -0.0226063687 -0.0015908486
## hsGPA -0.022606369  0.0091801149 -0.0003570767
## ACT   -0.001590849 -0.0003570767  0.0001161478</code></pre>
</div>
<div id="erros-padrão-do-estimador-textsehatboldsymbolbeta" class="section level5" number="0.3.1.0.3">
<h5><span class="header-section-number">0.3.1.0.3</span> 6. Erros-padrão do estimador {{<math>}}<span class="math inline">\(\text{se}(\hat{\boldsymbol{\beta}})\)</span>{{</math>}}</h5>
<p>É a raiz quadrada da diagonal principal da matriz de variância-covariância do estimador</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>se_bhat <span class="ot">=</span> <span class="fu">sqrt</span>( <span class="fu">diag</span>(Vbhat) )</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>se_bhat</span></code></pre></div>
<pre><code>##      const      hsGPA        ACT 
## 0.34082212 0.09581292 0.01077719</code></pre>
</div>
</div>
<div id="o-teste-t" class="section level3" number="0.3.2">
<h3><span class="header-section-number">0.3.2</span> O teste <em>t</em></h3>
<ul>
<li><p><a href="http://www.urfie.net/read/index.html#page/127">Seção 4.1 de Heiss (2020)</a></p></li>
<li><p>Após a estimação, é importante fazer testes de hipótese na forma
<span class="math display">\[ H_0: \ \beta_j = h_j \tag{4.1} \]</span>
tal que {{<math>}}<span class="math inline">\(a_j\)</span>{{</math>}} é uma constante, e {{<math>}}<span class="math inline">\(j\)</span>{{</math>}} é um dos {{<math>}}<span class="math inline">\(K+1\)</span>{{</math>}} parâmetros estimados.</p></li>
<li><p>A hipótese alternativa para teste bicaudal é dada por
<span class="math display">\[ H_1: \ \beta_j \neq h_j \tag{4.2} \]</span>
enquanto, para teste unicaudal, é
<span class="math display">\[ H_1: \ \beta_j &gt; h_j \qquad \text{ou} \qquad H_1: \ \beta_j &lt; h_j \tag{4.3} \]</span></p></li>
<li><p>Estas hipóteses podem ser convenientemente testas pelo test <em>t</em>:
<span class="math display">\[ t_j = \frac{\hat{\beta}_j - h_j}{\text{se}(\hat{\beta}_j)} \tag{4.4} \]</span></p></li>
<li><p><strong>[II]</strong>Frequentemente, realizamos teste bicaudal com {{<math>}}<span class="math inline">\(a_j=0\)</span>{{</math>}} para testar se a estimativa {{<math>}}<span class="math inline">\(\hat{\beta}_j\)</span>{{</math>}} é estatisticamente significante, ou seja, se a variável independente tem efeito significante sobre a variável dependente (estatisticamente diferente de zero):</p></li>
</ul>
<p>{{<math>}}<span class="math display">\[\begin{align} 
H_0: \ \beta_j=0, \qquad H_1: \ \beta_j\neq 0 \tag{4.5}\\
t_{\hat{\beta}_j} = \frac{\hat{\beta}_j}{\text{se}(\hat{\beta}_j)} \tag{4.6}
\end{align}\]</span>{{</math>}}</p>
<ul>
<li><p>Há três formas de avaliar essa hipótese.</p></li>
<li><p><strong>(i)</strong> A primeira é por meio da comparação da estatística <em>t</em> com o valor crítico <em>c</em>, dado um nível de significância {{<math>}}<span class="math inline">\(\alpha\)</span>{{</math>}}:
{{<math>}}<span class="math display">\[ \text{Rejeitamos H}_0 \text{ se:} \qquad | t_{\hat{\beta}_j} | &gt; c. \]</span>{{</math>}}</p></li>
<li><p>Normalmente, utiliza-se {{<math>}}<span class="math inline">\(\alpha = 5\%\)</span>{{</math>}} e, portanto, o valor crítico {{<math>}}<span class="math inline">\(c\)</span>{{</math>}} tende a ficar próximo de 2 para quantidades razoáveis de graus de liberdade, e se aproxima ao valor crítico de 1,96 da distribuição normal.</p></li>
</ul>
<p></br></p>
<ul>
<li><strong>(ii)</strong> Outra maneira de avaliar a hipótese nula é via p-valor, que indica o quão provável é que {{<math>}}<span class="math inline">\(\hat{\beta}_j\)</span>{{</math>}} <strong>não seja um valor extremo</strong> (ou seja, o quão provável é que a estimativa seja igual a {{<math>}}<span class="math inline">\(a_j = 0\)</span>{{</math>}}).</li>
</ul>
<p>{{<math>}}<span class="math display">\[ p_{\hat{\beta}_j} = 2.F_{t_{(N-K-1)}}(-|t_{\hat{\beta}_j}|), \tag{4.7} \]</span>{{</math>}}
em que {{<math>}}<span class="math inline">\(F_{t_{(N-K-1)}}(\cdot)\)</span>{{</math>}} é a fda de uma distribuição <em>t</em> com {{<math>}}<span class="math inline">\((N-K-1)\)</span>{{</math>}} graus de liberdade.</p>
<ul>
<li>Portanto, rejeitamos {{<math>}}<span class="math inline">\(H_0\)</span>{{</math>}} quando o p-valor (a probabilidade da estimativa ser igual a zero) for menor do que um nível de significância {{<math>}}<span class="math inline">\(\alpha\)</span>{{</math>}}:</li>
</ul>
<p>{{<math>}}<span class="math display">\[ \text{Rejeitamos H}_0 \text{ se:} \qquad p_{\hat{\beta}_j} \le \alpha \]</span>{{</math>}}</p>
<p></br></p>
<ul>
<li><strong>(iii)</strong> A terceira maneira de avaliar a hipótese nula é via cálculo do intervalo de confiança:
<span class="math display">\[ \hat{\beta}_j\ \pm\ c . \text{se}(\hat{\beta}_j) \tag{4.8} \]</span></li>
<li>Rejeitamos a hipótese nula, neste caso, quando {{<math>}}<span class="math inline">\(a_j\)</span>{{</math>}} estiver fora do intervalo de confiança.</li>
</ul>
<p></br></p>
<div id="continuação-exemplo---determinantes-da-nota-média-em-curso-superior-nos-eua" class="section level4" number="0.3.2.1">
<h4><span class="header-section-number">0.3.2.1</span> (Continuação) Exemplo - Determinantes da Nota Média em Curso Superior nos EUA</h4>
<ul>
<li>Assuma {{<math>}}<span class="math inline">\(\alpha = 5\%\)</span>{{</math>}} e teste bicaudal com {{<math>}}<span class="math inline">\(a_j = 0\)</span>{{</math>}}.</li>
</ul>
<div id="estatística-t" class="section level5" number="0.3.2.1.1">
<h5><span class="header-section-number">0.3.2.1.1</span> 7. Estatística <em>t</em></h5>
<p>{{<math>}}<span class="math display">\[ t_{\hat{\beta}_j} = \frac{\hat{\beta}_j}{\text{se}(\hat{\beta}_j)} \tag{4.6}
\]</span> {{</math>}}</p>
<p>No R:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo da estatística t</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>t_bhat <span class="ot">=</span> bhat <span class="sc">/</span> se_bhat</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>t_bhat</span></code></pre></div>
<pre><code>##            [,1]
## const 3.7741910
## hsGPA 4.7327219
## ACT   0.8746263</code></pre>
</div>
<div id="avaliando-as-hipóteses-nulas" class="section level5" number="0.3.2.1.2">
<h5><span class="header-section-number">0.3.2.1.2</span> 8. Avaliando as hipóteses nulas</h5>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definição do nível de significância</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, N<span class="sc">-</span>K<span class="dv">-1</span>) <span class="co"># valor crítico de teste bicaudal</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>c</span></code></pre></div>
<pre><code>## [1] 1.977304</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (A) Comparando estatística t com o valor crítico</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(t_bhat) <span class="sc">&gt;</span> c <span class="co"># avaliando H0</span></span></code></pre></div>
<pre><code>##        [,1]
## const  TRUE
## hsGPA  TRUE
## ACT   FALSE</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (B) Comparando p-valor com o nível de significância de 5%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>p_bhat <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(t_bhat), N<span class="sc">-</span>K<span class="dv">-1</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(p_bhat, <span class="dv">5</span>) <span class="co"># arredondando para facilitar visualização</span></span></code></pre></div>
<pre><code>##          [,1]
## const 0.00024
## hsGPA 0.00001
## ACT   0.38330</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>p_bhat <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="co"># avaliando H0</span></span></code></pre></div>
<pre><code>##        [,1]
## const  TRUE
## hsGPA  TRUE
## ACT   FALSE</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (C) Verificando se zero (0) está fora do intervalo de confiança</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">=</span> <span class="fu">cbind</span>(bhat <span class="sc">-</span> c<span class="sc">*</span>se_bhat, bhat <span class="sc">+</span> c<span class="sc">*</span>se_bhat) <span class="co"># avaliando H0</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>ci</span></code></pre></div>
<pre><code>##              [,1]       [,2]
## const  0.61241898 1.96023655
## hsGPA  0.26400467 0.64290710
## ACT   -0.01188376 0.03073578</code></pre>
</div>
<div id="comparando-estimações-via-lm-e-analítica" class="section level5" number="0.3.2.1.3">
<h5><span class="header-section-number">0.3.2.1.3</span> Comparando estimações via <code>lm()</code> e analítica</h5>
<ul>
<li>Resultados calculados analiticamente (“na mão”)</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(bhat, se_bhat, t_bhat, p_bhat) <span class="co"># coeficientes</span></span></code></pre></div>
<pre><code>##                      se_bhat                       
## const 1.286327767 0.34082212 3.7741910 2.375872e-04
## hsGPA 0.453455885 0.09581292 4.7327219 5.421580e-06
## ACT   0.009426012 0.01077719 0.8746263 3.832969e-01</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>ci <span class="co"># intervalos de confiança</span></span></code></pre></div>
<pre><code>##              [,1]       [,2]
## const  0.61241898 1.96023655
## hsGPA  0.26400467 0.64290710
## ACT   -0.01188376 0.03073578</code></pre>
<ul>
<li>Resultado via função <code>lm()</code></li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GPAres)<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##                Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 1.286327767 0.34082212 3.7741910 2.375872e-04
## hsGPA       0.453455885 0.09581292 4.7327219 5.421580e-06
## ACT         0.009426012 0.01077719 0.8746263 3.832969e-01</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(GPAres)</span></code></pre></div>
<pre><code>##                   2.5 %     97.5 %
## (Intercept)  0.61241898 1.96023655
## hsGPA        0.26400467 0.64290710
## ACT         -0.01188376 0.03073578</code></pre>
<p></br></p>
</div>
</div>
</div>
</div>
<div id="informando-os-resultados-das-regressões" class="section level2" number="0.4">
<h2><span class="header-section-number">0.4</span> Informando os Resultados das Regressões</h2>
<ul>
<li><a href="http://www.urfie.net/read/index.html#page/137">Seção 4.4 de Heiss (2020)</a></li>
<li>Aqui, vamos utilizar um exemplo para mostrar como informar os resultados de diversas regressões usando a função <code>stargazer</code> do pacote de mesmo nome.</li>
</ul>
<div id="exemplo-4.10---a-relação-salário-benefícios-de-professores" class="section level4" number="0.4.0.1">
<h4><span class="header-section-number">0.4.0.1</span> Exemplo 4.10 - A Relação Salário-Benefícios de Professores</h4>
<ul>
<li>Vamos usar a base de dados <code>meap93</code> do pacote <code>wooldridge</code> e queremos estimar o modelo</li>
</ul>
<p><span class="math display">\[ \log{\text{salary}} = \beta_0 + \beta_1. (\text{benefits/salary}) + \text{outros_fatores} + u \]</span></p>
<ul>
<li>Primeiro, vamos carregar a base de dados e criar a variável benefits/salary (<code>b_s</code>):</li>
</ul>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(meap93, <span class="at">package=</span><span class="st">&quot;wooldridge&quot;</span>) <span class="co"># carregando base de dados</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo nova variável</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>meap93<span class="sc">$</span>b_s <span class="ot">=</span> meap93<span class="sc">$</span>benefits <span class="sc">/</span> meap93<span class="sc">$</span>salary</span></code></pre></div>
<ul>
<li>Agora vamos estimar diversos modelos:
<ul>
<li>Modelo 1: apenas <code>b_s</code> como regressor</li>
<li>Modelo 2: inclui as variáveis explicativas <code>log(enroll)</code> e <code>log(staff)</code> no Modelo 1</li>
<li>Modelo 3: inclui as variáveis explicativas <code>droprate</code> e <code>gradrate</code> no Modelo 2</li>
</ul></li>
<li>Depois, vamos resumir os resultados em uma única tabela usando a função <code>stagazer()</code> pacote <code>stagazer</code>
<ul>
<li><code>type="text"</code> para retornar o resultado no próprio console (se omitir esse argumento, retorna o código em LaTeX)</li>
<li><code>keep.stat=c("n", "rsq")</code> para manter apenas os nº de observações e os {{<math>}}R<span class="math inline">\(^2\)</span>{{</math>}}</li>
<li><code>star.cutoffs=c(.05, .01, .001)</code> níveis de significância de 5%, 1% e 0,1%</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimando os três modelos</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(salary) <span class="sc">~</span> b_s, meap93)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(salary) <span class="sc">~</span> b_s <span class="sc">+</span> <span class="fu">log</span>(enroll) <span class="sc">+</span> <span class="fu">log</span>(staff), meap93)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(salary) <span class="sc">~</span> b_s <span class="sc">+</span> <span class="fu">log</span>(enroll) <span class="sc">+</span> <span class="fu">log</span>(staff) <span class="sc">+</span> droprate <span class="sc">+</span> gradrate, meap93)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumindo em uma tabela</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(<span class="fu">list</span>(model1, model2, model3), <span class="at">type=</span><span class="st">&quot;text&quot;</span>, <span class="at">keep.stat=</span><span class="fu">c</span>(<span class="st">&quot;n&quot;</span>, <span class="st">&quot;rsq&quot;</span>),</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">star.cutoffs=</span><span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">01</span>, .<span class="dv">001</span>))</span></code></pre></div>
<pre><code>## 
## ============================================
##                    Dependent variable:      
##              -------------------------------
##                        log(salary)          
##                 (1)        (2)        (3)   
## --------------------------------------------
## b_s          -0.825***  -0.605***  -0.589***
##               (0.200)    (0.165)    (0.165) 
##                                             
## log(enroll)              0.087***  0.088*** 
##                          (0.007)    (0.007) 
##                                             
## log(staff)              -0.222***  -0.218***
##                          (0.050)    (0.050) 
##                                             
## droprate                            -0.0003 
##                                     (0.002) 
##                                             
## gradrate                             0.001  
##                                     (0.001) 
##                                             
## Constant     10.523***  10.844***  10.738***
##               (0.042)    (0.252)    (0.258) 
##                                             
## --------------------------------------------
## Observations    408        408        408   
## R2             0.040      0.353      0.361  
## ============================================
## Note:          *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</code></pre>
<ul>
<li>É comum que os resultados econométricos venham acompanhados de asteriscos (<code>*</code>), pois estes indicam que as estimativas são significantes a um certo nível de significância</li>
<li>Quanto maior o nível de significância, mais asteriscos são inseridos e estes facilitam a interpretação das estimativas estatisticamente diferentes de zero.</li>
</ul>
<p></br></p>
</div>
</div>
<div id="regressores-qualitativos" class="section level2" number="0.5">
<h2><span class="header-section-number">0.5</span> Regressores Qualitativos</h2>
<ul>
<li>Muitas variáveis de interesse são qualitativas, ao invés de quantitativas.</li>
<li>Isso inclui variáveis como <em>sexo</em>, <em>raça</em>, <em>status de trabalho</em>, <em>estado civil</em>, <em>escolha de marca</em>, etc.</li>
</ul>
<div id="variáveis-dummy" class="section level3" number="0.5.1">
<h3><span class="header-section-number">0.5.1</span> Variáveis Dummy</h3>
<ul>
<li><a href="http://www.urfie.net/read/index.html#page/161">Seção 7.1 de Heiss (2020)</a></li>
<li>Se um dado qualitativo está armazenado na base como uma variável qualitativa (ou seja, seus valores são 0’s ou 1’s), então ele pode ser inserido imediatamente numa regressão linear.</li>
<li>Se uma variável dummy for usada num modelo, seu coeficiente representa a diferença do intercepto entre os grupos (Wooldridge, 2006, Seção 7.2)</li>
</ul>
<div id="exemplo-7.5---equação-do-log-do-salário-hora" class="section level5" number="0.5.1.0.1">
<h5><span class="header-section-number">0.5.1.0.1</span> Exemplo 7.5 - Equação do Log do Salário-Hora</h5>
<ul>
<li>Vamos usar a base de dados <code>wage1</code> do pacote <code>wooldridge</code></li>
<li>Vamos estimar o modelo:</li>
</ul>
<p>{{<math>}}<span class="math display">\[\begin{align}
\text{wage} = &amp;\beta_0 + \beta_1 \text{female} + \beta_2 \text{educ} + \beta_3 \text{exper} + \beta_4 \text{exper}^2 +\\
&amp;\beta_5 \text{tenure} + \beta_6 \text{tenure}^2 + u \tag{7.6} \end{align}\]</span>{{</math>}}
em que:</p>
<ul>
<li><code>wage</code>: salário médio por hora</li>
<li><code>female</code>: dummy em que (1) mulher e (0) homem</li>
<li><code>educ</code>: anos de educação</li>
<li><code>exper</code>: anos de experiência (<code>expersq</code> = anos ao quadrado)</li>
<li><code>tenure</code>: anos de trabalho no empregador atual (<code>tenursq</code> = anos ao quadrado)</li>
</ul>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carregando a base de dados necessária</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wage1, <span class="at">package=</span><span class="st">&quot;wooldridge&quot;</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimando o modelo</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>reg_7<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(wage <span class="sc">~</span> female <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> expersq <span class="sc">+</span> tenure <span class="sc">+</span> tenursq, <span class="at">data=</span>wage1)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>( <span class="fu">summary</span>(reg_7<span class="fl">.1</span>)<span class="sc">$</span>coef, <span class="dv">4</span> )</span></code></pre></div>
<pre><code>##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  -2.1097     0.7107 -2.9687   0.0031
## female       -1.7832     0.2572 -6.9327   0.0000
## educ          0.5263     0.0485 10.8412   0.0000
## exper         0.1878     0.0357  5.2557   0.0000
## expersq      -0.0038     0.0008 -4.9267   0.0000
## tenure        0.2117     0.0492  4.3050   0.0000
## tenursq      -0.0029     0.0017 -1.7473   0.0812</code></pre>
<ul>
<li>Nota-se que as mulheres (<code>female = 1</code>) recebem em média $1,78/hora a menos, em relação aos homens (<code>female = 0</code>).</li>
<li>Essa diferença é estatisticamente significane (p-valor de <code>female</code> é menor do que 5%)</li>
</ul>
</div>
</div>
<div id="variáveis-com-múltiplas-categorias" class="section level3" number="0.5.2">
<h3><span class="header-section-number">0.5.2</span> Variáveis com múltiplas categorias</h3>
<ul>
<li><a href="http://www.urfie.net/read/index.html#page/164">Seção 7.3 de Heiss (2020)</a></li>
<li>Quando temos uma variável categórica com mais de 2 categorias, não é possível simplesmente usá-la na regressão como se fosse uma <em>dummy</em>.</li>
<li>É necessário criar uma <em>dummy</em> para cada categoria</li>
<li>Quando for feita a estimação do modelo, é necessário deixar uma destas categorias de fora para evitar problema de multicolinearidade perfeita.
<ul>
<li>Conhecendo todas as <em>dummies</em> menos uma, dá para saber o valor esta última <em>dummy</em></li>
<li>Se todas outras dummies forem iguais a 0, a última dummy é igual a 1</li>
<li>Se houver outra dummy igual a 1, então última dummy é igual a 0</li>
</ul></li>
<li>Além disso, a categoria deixada de fora acaba sendo usada <strong>referência</strong> quando são estimados os parâmetros.</li>
</ul>
<div id="exemplo-efeito-do-aumento-do-salário-mínimo-sobre-o-emprego-card-e-krueger-1994" class="section level5" number="0.5.2.0.1">
<h5><span class="header-section-number">0.5.2.0.1</span> Exemplo: Efeito do aumento do salário-mínimo sobre o emprego (Card e Krueger, 1994)</h5>
<ul>
<li>Em 1992, o estado de New Jersey (NJ) aumentou o salário mínimo</li>
<li>Para avaliar se o aumento do salário mínimo teria impacto na quantidade de trabalhadores empregados, usou como comparação o estado vizinho de Pennsylvania (PA), considerado parecido com NJ.</li>
<li>Vamos estimar o seguinte modelo:</li>
</ul>
<p>{{<math>}}<span class="math display">\[
\text{diff_fte} = \beta_0 + \beta_1 \text{nj} + \beta_2 \text{chain} + \beta_3 \text{hrsopen} + u \]</span>{{</math>}}
em que:</p>
<ul>
<li><code>diff_emptot</code>: diferença de nº de empregados entre fev/1992 e nov/1992</li>
<li><code>nj</code>: dummy em que (1) New Jersey - NJ, e (0) Pennsylvania - PA</li>
<li><code>chain</code>: rede de fast food: (1) Burger King (<code>bk</code>), (2) KFC (<code>kfc</code>), (3) Roy’s (<code>roys</code>), e (4) Wendy’s (<code>wendys</code>)</li>
<li><code>hrsopen</code>: horas de funcionamento por dia</li>
</ul>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>card1994 <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://fhnishida.netlify.app/project/rec2301/card1994.csv&quot;</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(card1994) <span class="co"># olhando as 6 primeiras linhas</span></span></code></pre></div>
<pre><code>##   sheet nj chain hrsopen diff_fte
## 1    46  0     1    16.5   -16.50
## 2    49  0     2    13.0    -2.25
## 3    56  0     4    12.0   -14.00
## 4    61  0     4    12.0    11.50
## 5   445  0     1    18.0   -41.50
## 6   451  0     1    24.0    13.00</code></pre>
<ul>
<li>Note que a variável categórica <code>chain</code> possui números ao invés dos nomes das redes de fast food.</li>
<li>Isto é comum nas bases de dados, já que números consomem menos espaço de armazenamento.</li>
<li>Caso você rode a estimação com a variável <code>chain</code> desta maneira, o modelo considerará que é uma variável contínua e prejudicando a sua análise:</li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(diff_fte <span class="sc">~</span> nj <span class="sc">+</span> hrsopen <span class="sc">+</span> chain, <span class="at">data=</span>card1994)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = diff_fte ~ nj + hrsopen + chain, data = card1994)
## 
## Coefficients:
## (Intercept)           nj      hrsopen        chain  
##     0.40284      4.61869     -0.28458     -0.06462</code></pre>
<ul>
<li>Note que a interpretação é que a mudança de <code>bk</code> (1) para <code>kfc</code> (2) [ou de <code>kfc</code> (2) para <code>roys</code> (3), ou de <code>roys</code> (3) para <code>wendys</code> (4)] diminuiu a variação do nº trabalhadores – <strong>o que não faz sentido!</strong></li>
<li>Portanto, precisamos criar as <em>dummies</em> das variáveis categóricas:</li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando dummies para cada variável</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>card1994<span class="sc">$</span>bk <span class="ot">=</span> <span class="fu">ifelse</span>(card1994<span class="sc">$</span>chain<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>card1994<span class="sc">$</span>kfc <span class="ot">=</span> <span class="fu">ifelse</span>(card1994<span class="sc">$</span>chain<span class="sc">==</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>card1994<span class="sc">$</span>roys <span class="ot">=</span> <span class="fu">ifelse</span>(card1994<span class="sc">$</span>chain<span class="sc">==</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>card1994<span class="sc">$</span>wendys <span class="ot">=</span> <span class="fu">ifelse</span>(card1994<span class="sc">$</span>chain<span class="sc">==</span><span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizando as primeras linhas</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(card1994)</span></code></pre></div>
<pre><code>##   sheet nj chain hrsopen diff_fte bk kfc roys wendys
## 1    46  0     1    16.5   -16.50  1   0    0      0
## 2    49  0     2    13.0    -2.25  0   1    0      0
## 3    56  0     4    12.0   -14.00  0   0    0      1
## 4    61  0     4    12.0    11.50  0   0    0      1
## 5   445  0     1    18.0   -41.50  1   0    0      0
## 6   451  0     1    24.0    13.00  1   0    0      0</code></pre>
<ul>
<li>Também é possível criar <em>dummies</em> mais facilmente usando o pacote <code>fastDummies</code></li>
<li>Observe que, usando apenas três colunas das redes de fast food, é possível saber o valor da 4ª coluna, pois cada observação/loja só pode ser de uma dessas 4 redes de fast food e, portanto, há apenas um <code>1</code> em cada linha.</li>
<li>Portanto, caso coloquemos as 4 <em>dummies</em> quando formos rodar a regressão, haverá um problema de multicolinearidade perfeita:</li>
</ul>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(diff_fte <span class="sc">~</span> nj <span class="sc">+</span> hrsopen <span class="sc">+</span> bk <span class="sc">+</span> kfc <span class="sc">+</span> roys <span class="sc">+</span> wendys, <span class="at">data=</span>card1994)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = diff_fte ~ nj + hrsopen + bk + kfc + roys + wendys, 
##     data = card1994)
## 
## Coefficients:
## (Intercept)           nj      hrsopen           bk          kfc         roys  
##    2.097621     4.859363    -0.388792    -0.005512    -1.997213    -1.010903  
##      wendys  
##          NA</code></pre>
<ul>
<li>Por padrão, o R já retira uma das categorias para servir como referência.</li>
<li>Aqui, a categoria <code>wendys</code> serve como referência às estimativas das demais <em>dummies</em>
<ul>
<li>Em relação a <code>wendys</code>, o nº de empregados de:
<ul>
<li><code>bk</code> teve uma variação de empregados muito parecida (apenas 0,005 menor)</li>
<li><code>roys</code> teve uma diminuição (menos 1 empregado)</li>
<li><code>kfc</code> teve uma maior diminuição (menos 2 empregados)</li>
</ul></li>
</ul></li>
<li>Note que poderíamos usar como referência outra rede de fast food, deixando sua <em>dummy</em> de fora da regressão.</li>
<li>Vamos deixar de fora a <em>dummy</em> do <code>roys</code>:</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(diff_fte <span class="sc">~</span> nj <span class="sc">+</span> hrsopen <span class="sc">+</span> bk <span class="sc">+</span> kfc <span class="sc">+</span> wendys, <span class="at">data=</span>card1994)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = diff_fte ~ nj + hrsopen + bk + kfc + wendys, data = card1994)
## 
## Coefficients:
## (Intercept)           nj      hrsopen           bk          kfc       wendys  
##      1.0867       4.8594      -0.3888       1.0054      -0.9863       1.0109</code></pre>
<ul>
<li>Note agora que os parâmetros estão em relação à `roys``:
<ul>
<li>estimativa de <code>kfc</code> que tinha ficado -2, agora está “menos” negativo (-1)</li>
<li>estimativas de <code>bk</code> e de <code>wendys</code> possuem estimativas positivas (lembre-se que, em relação a <code>wendys</code>, a estimativa de <code>roys</code> foi negativo na regressão anterior)</li>
</ul></li>
</ul>
<p></br></p>
<ul>
<li><p>No R, na verdade, não é necessário criar <em>dummies</em> de uma variável categórica para rodar uma regressão, caso ela esteja como <em>texto</em> ou como <em>factor</em></p></li>
<li><p>Criando variável da classe texto:</p></li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>card1994<span class="sc">$</span>chain_txt <span class="ot">=</span> <span class="fu">as.character</span>(card1994<span class="sc">$</span>chain) <span class="co"># criando variável texto</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(card1994<span class="sc">$</span>chain_txt) <span class="co"># Visualizado os primeiros valores</span></span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;4&quot; &quot;4&quot; &quot;1&quot; &quot;1&quot;</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimando do modelo</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(diff_fte <span class="sc">~</span> nj <span class="sc">+</span> hrsopen <span class="sc">+</span> chain_txt, <span class="at">data=</span>card1994)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = diff_fte ~ nj + hrsopen + chain_txt, data = card1994)
## 
## Coefficients:
## (Intercept)           nj      hrsopen   chain_txt2   chain_txt3   chain_txt4  
##    2.092109     4.859363    -0.388792    -1.991701    -1.005391     0.005512</code></pre>
<ul>
<li>Observe que a função <code>lm()</code> retira a categoria que aparece primeiro no vetor de texto (<code>"1"</code>)</li>
<li>Usando como variável texto, não é possível selecionar facilmente qual categoria vai ser retirada da regressão</li>
<li>Para isto, podemos usar a classe de objeto <code>factor</code>:</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>card1994<span class="sc">$</span>chain_fct <span class="ot">=</span> <span class="fu">factor</span>(card1994<span class="sc">$</span>chain) <span class="co"># criando variável factor</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(card1994<span class="sc">$</span>chain_fct) <span class="co"># verificando os níveis (categorias) da variável factor</span></span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot;</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimando do modelo</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(diff_fte <span class="sc">~</span> nj <span class="sc">+</span> hrsopen <span class="sc">+</span> chain_fct, <span class="at">data=</span>card1994)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = diff_fte ~ nj + hrsopen + chain_fct, data = card1994)
## 
## Coefficients:
## (Intercept)           nj      hrsopen   chain_fct2   chain_fct3   chain_fct4  
##    2.092109     4.859363    -0.388792    -1.991701    -1.005391     0.005512</code></pre>
<ul>
<li>Note que a função <code>lm()</code> retira o primeiro nível da regressão (não necessariamente o que aparece primeiro na base de dados)</li>
<li>Podemos trocar a referência usando a função <code>relevel()</code> em uma variável <em>factor</em></li>
</ul>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>card1994<span class="sc">$</span>chain_fct <span class="ot">=</span> <span class="fu">relevel</span>(card1994<span class="sc">$</span>chain_fct, <span class="at">ref=</span><span class="st">&quot;3&quot;</span>) <span class="co"># referência roys</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(card1994<span class="sc">$</span>chain_fct) <span class="co"># verificando os níveis da variável factor</span></span></code></pre></div>
<pre><code>## [1] &quot;3&quot; &quot;1&quot; &quot;2&quot; &quot;4&quot;</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimando do modelo</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(diff_fte <span class="sc">~</span> nj <span class="sc">+</span> hrsopen <span class="sc">+</span> chain_fct, <span class="at">data=</span>card1994)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = diff_fte ~ nj + hrsopen + chain_fct, data = card1994)
## 
## Coefficients:
## (Intercept)           nj      hrsopen   chain_fct1   chain_fct2   chain_fct4  
##      1.0867       4.8594      -0.3888       1.0054      -0.9863       1.0109</code></pre>
<ul>
<li>Observe que o primeiro nível foi alterado para <code>"3"</code> e, portanto, essa categoria foi retirada na regressão</li>
</ul>
</div>
</div>
<div id="transformando-variáveis-contínuas-em-categorias" class="section level3" number="0.5.3">
<h3><span class="header-section-number">0.5.3</span> Transformando variáveis contínuas em categorias</h3>
<ul>
<li><a href="http://www.urfie.net/read/index.html#page/166">Seção 7.4 de Heiss (2020)</a></li>
<li>Usando a função <code>cut()</code>, podemos “dividir” um vetor de números em intervalos, a partir de pontos de corte</li>
</ul>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo pontos de corte</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>cutpts <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">10</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Classificando o vetor 1:10 a partir dos pontos de corte</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cut</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, cutpts)</span></code></pre></div>
<pre><code>##  [1] (0,3]  (0,3]  (0,3]  (3,6]  (3,6]  (3,6]  (6,10] (6,10] (6,10] (6,10]
## Levels: (0,3] (3,6] (6,10]</code></pre>
<div id="exemplo-7.8---efeitos-da-classificação-das-faculdade-de-direito-sobre-salários-iniciais" class="section level5" number="0.5.3.0.1">
<h5><span class="header-section-number">0.5.3.0.1</span> Exemplo 7.8 - Efeitos da Classificação das Faculdade de Direito sobre Salários Iniciais</h5>
<ul>
<li>Queremos verificar o quanto as universidades top 10 (<code>top10</code>), e as ranqueadas entre 11 e 25 (<code>r11_25</code>), entre 26 e 40 (<code>r26_40</code>), entre 41 e 60 (<code>r41_60</code>), e entre 61 e 100 (<code>r61_100</code>), impactam o log do salário (<code>log(salary)</code>) em relação às demais universidades (<code>r101_175</code>).</li>
<li>Utilizaremos como variáveis de controle: <code>LSAT</code>, <code>GPA</code>, <code>llibvol</code> e <code>lcost</code></li>
</ul>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(lawsch85, <span class="at">package=</span><span class="st">&quot;wooldridge&quot;</span>) <span class="co"># carregando base de dados necessária</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo pontos de corte</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>cutpts <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">100</span>, <span class="dv">175</span>)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando variável com a classificação</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>lawsch85<span class="sc">$</span>rankcat <span class="ot">=</span> <span class="fu">cut</span>(lawsch85<span class="sc">$</span>rank, cutpts)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizando os 6 primeiros valores de rankcat</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lawsch85<span class="sc">$</span>rankcat)</span></code></pre></div>
<pre><code>## [1] (100,175] (100,175] (25,40]   (40,60]   (60,100]  (60,100] 
## Levels: (0,10] (10,25] (25,40] (40,60] (60,100] (100,175]</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escolhendo a categoria de referência (acima de 100 até 175)</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>lawsch85<span class="sc">$</span>rankcat <span class="ot">=</span> <span class="fu">relevel</span>(lawsch85<span class="sc">$</span>rankcat, <span class="st">&#39;(100,175]&#39;</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimando o modelo</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(salary) <span class="sc">~</span> rankcat <span class="sc">+</span> LSAT <span class="sc">+</span> GPA <span class="sc">+</span> llibvol <span class="sc">+</span> lcost, <span class="at">data=</span>lawsch85)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>( <span class="fu">summary</span>(res)<span class="sc">$</span>coef, <span class="dv">5</span> )</span></code></pre></div>
<pre><code>##                 Estimate Std. Error  t value Pr(&gt;|t|)
## (Intercept)      9.16530    0.41142 22.27699  0.00000
## rankcat(0,10]    0.69957    0.05349 13.07797  0.00000
## rankcat(10,25]   0.59354    0.03944 15.04926  0.00000
## rankcat(25,40]   0.37508    0.03408 11.00536  0.00000
## rankcat(40,60]   0.26282    0.02796  9.39913  0.00000
## rankcat(60,100]  0.13159    0.02104  6.25396  0.00000
## LSAT             0.00569    0.00306  1.85793  0.06551
## GPA              0.01373    0.07419  0.18500  0.85353
## llibvol          0.03636    0.02602  1.39765  0.16467
## lcost            0.00084    0.02514  0.03347  0.97336</code></pre>
<ul>
<li>Note que, em relação às universidades em piores colocações (<code>(100,175]</code>), as melhores ranqueadas provêem salários de 13,16% a 69,96% superiores</li>
</ul>
</div>
</div>
<div id="interações-envolvendo-variáveis-dummy" class="section level3" number="0.5.4">
<h3><span class="header-section-number">0.5.4</span> Interações Envolvendo Variáveis Dummy</h3>
<div id="interações-entre-variáveis-dummy" class="section level4" number="0.5.4.1">
<h4><span class="header-section-number">0.5.4.1</span> Interações entre variáveis dummy</h4>
<ul>
<li><a href="http://www.urfie.net/read/index.html#page/154">Subseção 6.1.6 de Heiss (2020)</a></li>
<li>Seção 7. de Wooldridge (2006)</li>
<li>Adicionando um termo de interação entre duas <em>dummies</em>, é possível obter estimativas distintas de uma <em>dummy</em> (mudança no <strong>intercepto</strong>) para cada um das 2 categorias da outra <em>dummy</em> (0 e 1).</li>
</ul>
<div id="continuação-exemplo-7.5---equação-do-log-do-salário-hora" class="section level5" number="0.5.4.1.1">
<h5><span class="header-section-number">0.5.4.1.1</span> (Continuação) Exemplo 7.5 - Equação do Log do Salário-Hora</h5>
<ul>
<li><p>Retornemos à base de dados <code>wage1</code> do pacote <code>wooldridge</code></p></li>
<li><p>Agora, vamos incluir a variável <em>dummy</em> <code>married</code></p></li>
<li><p>O modelo a ser estimado é:</p></li>
</ul>
<p>{{<math>}}<span class="math display">\[\begin{align}
\log(\text{wage}) = &amp;\beta_0 + \beta_1 \text{female} + \beta_2 \text{married} + \beta_3 \text{educ} +\\
&amp;\beta_4 \text{exper} + \beta_5 \text{exper}^2 + \beta_6 \text{tenure} + \beta_7 \text{tenure}^2 + u \end{align}\]</span>{{</math>}}
em que:</p>
<ul>
<li><code>wage</code>: salário médio por hora</li>
<li><code>female</code>: dummy em que (1) mulher e (0) homem</li>
<li><code>married</code>: dummy em que (1) casado e (0) solteiro</li>
<li><code>educ</code>: anos de educação</li>
<li><code>exper</code>: anos de experiência (<code>expersq</code> = anos ao quadrado)</li>
<li><code>tenure</code>: anos de trabalho no empregador atual (<code>tenursq</code> = anos ao quadrado)</li>
</ul>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carregando a base de dados necessária</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wage1, <span class="at">package=</span><span class="st">&quot;wooldridge&quot;</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimando o modelo</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>reg_7<span class="fl">.11</span> <span class="ot">=</span> <span class="fu">lm</span>(lwage <span class="sc">~</span> female <span class="sc">+</span> married <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> expersq <span class="sc">+</span> tenure <span class="sc">+</span> tenursq, <span class="at">data=</span>wage1)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>( <span class="fu">summary</span>(reg_7<span class="fl">.11</span>)<span class="sc">$</span>coef, <span class="dv">4</span> )</span></code></pre></div>
<pre><code>##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   0.4178     0.0989  4.2257   0.0000
## female       -0.2902     0.0361 -8.0356   0.0000
## married       0.0529     0.0408  1.2985   0.1947
## educ          0.0792     0.0068 11.6399   0.0000
## exper         0.0270     0.0053  5.0609   0.0000
## expersq      -0.0005     0.0001 -4.8135   0.0000
## tenure        0.0313     0.0068  4.5700   0.0000
## tenursq      -0.0006     0.0002 -2.4475   0.0147</code></pre>
<ul>
<li>Por essa regressão, nota-se que casar-se tem efeito estatisticamente não significante e positivo de 5,29% sobre o salário.</li>
<li>O fato deste efeito não ser significante pode estar relacionado aos efeitos distintos dos casamentos sobre os homens, que têm seus salários elevados, e as mulheres, que têm seus salários diminuídos.</li>
<li>Para avaliar diferentes efeitos distintos do casamento considerando o sexo do indivíduo, podemos interagir (multiplicar) as variáveis <code>married</code> e <code>female</code> usando:
<ul>
<li><code>lwage ~ female + married + married:female</code> (o <code>:</code> cria apenas a interação), ou</li>
<li><code>lwage ~ female * married</code> (a “multiplicação” cria as dummies e a interação)</li>
</ul></li>
<li>O modelo a ser estimado agora é:
{{<math>}}<span class="math display">\[\begin{align}
\log(\text{wage}) = &amp;\beta_0 + \beta_1 \text{female} + \beta_2 \text{married} + \delta_2 \text{female*married} + \beta_3 \text{educ} + \\
&amp;\beta_4 \text{exper} + \beta_5 \text{exper}^2 + \beta_6 \text{tenure} + \beta_7 \text{tenure}^2 + u \end{align}\]</span>{{</math>}}</li>
</ul>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimando o modelo - forma (a)</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>reg_7<span class="fl">.14</span>a <span class="ot">=</span> <span class="fu">lm</span>(lwage <span class="sc">~</span> female <span class="sc">+</span> married <span class="sc">+</span> female<span class="sc">:</span>married <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> expersq <span class="sc">+</span> tenure <span class="sc">+</span> tenursq,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>wage1)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>( <span class="fu">summary</span>(reg_7<span class="fl">.14</span>a)<span class="sc">$</span>coef, <span class="dv">4</span> )</span></code></pre></div>
<pre><code>##                Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)      0.3214     0.1000  3.2135   0.0014
## female          -0.1104     0.0557 -1.9797   0.0483
## married          0.2127     0.0554  3.8419   0.0001
## educ             0.0789     0.0067 11.7873   0.0000
## exper            0.0268     0.0052  5.1118   0.0000
## expersq         -0.0005     0.0001 -4.8471   0.0000
## tenure           0.0291     0.0068  4.3016   0.0000
## tenursq         -0.0005     0.0002 -2.3056   0.0215
## female:married  -0.3006     0.0718 -4.1885   0.0000</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimando o modelo - forma (b)</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>reg_7<span class="fl">.14</span>b <span class="ot">=</span> <span class="fu">lm</span>(lwage <span class="sc">~</span> female <span class="sc">*</span> married <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> expersq <span class="sc">+</span> tenure <span class="sc">+</span> tenursq,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>wage1)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>( <span class="fu">summary</span>(reg_7<span class="fl">.14</span>b)<span class="sc">$</span>coef, <span class="dv">4</span> )</span></code></pre></div>
<pre><code>##                Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)      0.3214     0.1000  3.2135   0.0014
## female          -0.1104     0.0557 -1.9797   0.0483
## married          0.2127     0.0554  3.8419   0.0001
## educ             0.0789     0.0067 11.7873   0.0000
## exper            0.0268     0.0052  5.1118   0.0000
## expersq         -0.0005     0.0001 -4.8471   0.0000
## tenure           0.0291     0.0068  4.3016   0.0000
## tenursq         -0.0005     0.0002 -2.3056   0.0215
## female:married  -0.3006     0.0718 -4.1885   0.0000</code></pre>
<ul>
<li>Observe que, agora, o parâmetro de casado refere-se apenas aos homens (<code>married</code>) é positivo e significante de 21,27%.</li>
<li>Já, sobre as mulheres, o casamento tem o efeito de {{<math>}}<span class="math inline">\(\beta_2 + \delta_2\)</span>{{</math>}}, ou seja, é igual a -8,79% (= 0,2127 - 0,3006)</li>
<li>Uma hipótese importante é a {{<math>}}H<span class="math inline">\(_0:\ \delta_2 = 0\)</span>{{</math>}} para verificar se o retorno por mudança do estado civil (<strong>intercepto</strong>) é diferente entre mulheres e homens.</li>
<li>No output da regressão, podemos ver que o parâmetros da interação (<code>female:married</code>) é significante (p-valor bem baixo), logo, o efeito do casamento sobre a mulher é estatisticamente diferente do efeito sobre o homem.</li>
</ul>
<p></br></p>
</div>
</div>
<div id="considerando-inclinações-diferentes" class="section level4" number="0.5.4.2">
<h4><span class="header-section-number">0.5.4.2</span> Considerando inclinações diferentes</h4>
<ul>
<li>Seção 7.4 de Wooldridge (2006)</li>
<li><a href="http://www.urfie.net/read/index.html#page/168">Seção 7.5 de Heiss (2020)</a></li>
<li>Adicionando um termo de interação entre uma variável contínua e uma <em>dummy</em>, é possível obter estimativas distintas de da variável numérica (mudança na <strong>inclinação</strong>) para cada um das 2 categorias da <em>dummy</em> (0 e 1).</li>
</ul>
<div id="exemplo-7.10---equação-do-log-do-salário-hora" class="section level5" number="0.5.4.2.1">
<h5><span class="header-section-number">0.5.4.2.1</span> Exemplo 7.10 - Equação do Log do Salário-Hora</h5>
<ul>
<li>Retornemos à base de dados <code>wage1</code> do pacote <code>wooldridge</code></li>
<li>Suspeita-se que as mulheres, além de terem um intercepto distinto em relação aos homens, também tem menores retornos de salário para cada ano de educação a mais.</li>
<li>Então, incluiremos no modelo a interação entre a dummy <code>female</code> e os anos de educação (<code>educ</code>):</li>
</ul>
<p>{{<math>}}<span class="math display">\[\begin{align}
\log(\text{wage}) = &amp;\beta_0 + \beta_1 \text{female} + \beta_2 \text{educ} + \delta_2 \text{female*educ} \\
&amp;\beta_3 \text{exper} + \beta_4 \text{exper}^2 + \beta_5 \text{tenure} + \beta_6 \text{tenure}^2 + u \end{align}\]</span>{{</math>}}
em que:</p>
<ul>
<li><code>wage</code>: salário médio por hora</li>
<li><code>female</code>: dummy em que (1) mulher e (0) homem</li>
<li><code>educ</code>: anos de educação</li>
<li><code>female*educ</code>: interação entre a dummy <code>female</code> e anos de educação (<code>educ</code>)</li>
<li><code>exper</code>: anos de experiência (<code>expersq</code> = anos ao quadrado)</li>
<li><code>tenure</code>: anos de trabalho no empregador atual (<code>tenursq</code> = anos ao quadrado)</li>
</ul>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carregando a base de dados necessária</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wage1, <span class="at">package=</span><span class="st">&quot;wooldridge&quot;</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimando o modelo</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>reg_7<span class="fl">.17</span> <span class="ot">=</span> <span class="fu">lm</span>(lwage <span class="sc">~</span> female <span class="sc">+</span> educ <span class="sc">+</span> female<span class="sc">:</span>educ <span class="sc">+</span> exper <span class="sc">+</span> expersq <span class="sc">+</span> tenure <span class="sc">+</span> tenursq,</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data=</span>wage1)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>( <span class="fu">summary</span>(reg_7<span class="fl">.17</span>)<span class="sc">$</span>coef, <span class="dv">4</span> )</span></code></pre></div>
<pre><code>##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   0.3888     0.1187  3.2759   0.0011
## female       -0.2268     0.1675 -1.3536   0.1764
## educ          0.0824     0.0085  9.7249   0.0000
## exper         0.0293     0.0050  5.8860   0.0000
## expersq      -0.0006     0.0001 -5.3978   0.0000
## tenure        0.0319     0.0069  4.6470   0.0000
## tenursq      -0.0006     0.0002 -2.5089   0.0124
## female:educ  -0.0056     0.0131 -0.4260   0.6703</code></pre>
<ul>
<li>Uma hipótese importante é a {{<math>}}H<span class="math inline">\(_0:\ \delta_2 = 0\)</span>{{</math>}} para verificar se o retorno a cada ano de educação (<strong>inclinação</strong>) é diferente entre mulheres e homens.</li>
<li>Pela estimação, nota-se que o incremento no salário das mulheres para cada ano a mais de educação é 0,56% menor em relação aos homens:
<ul>
<li>Homens aumentam 8,24% (<code>educ</code>) o salário para cada ano de educação</li>
<li>Mulheres aumentam 7,58% (= 0,0824 - 0,0056) o salário para cada ano de educação</li>
</ul></li>
<li>No entanto, essa diferença é estatisticamente não-significante a 5% de significância.</li>
</ul>
<p><img src="../example_interaction.png" alt=""></p>
<p>{{&lt; cta cta_text=“👉 Proceed to Hypothesis Testing” cta_link=“../sec9” &gt;}}</p>
</div>
</div>
</div>
</div>
