---
date: "2018-09-09T00:00:00Z"
# icon: book
# icon_pack: fas
linktitle: Distributions
summary: The page also includes examples of how to use R for statistical analysis, working with probability distributions and simulations.
title: Distributions
weight: 5
output: md_document
type: book
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


- A parte de Econometria no R √© baseada no livro de Florian Heiss "Using R for Introductory Econometrics" (2¬™ edi√ß√£o, 2020)
    - Aplica no R o conte√∫do e os exemplos do livro do Wooldridge de 2019 (vers√£o em ingl√™s)
    - √â poss√≠vel ler gratuitamente a vers√£o online em: <http://www.urfie.net>
    - H√° tamb√©m uma vers√£o de Python do livro em: <http://www.upfie.net>
- A base de dados dos exemplos contidos no livro do Wooldridge podem ser obtidos por meio da instala√ß√£o e do carregamento do pacote `wooldridge`:
```r
install.packages("wooldridge")
```

</br>

## Distribui√ß√µes
- [Se√ß√£o 1.7 de Heiss (2020)](http://www.urfie.net/read/index.html#page/65)
- [Probability Distributions in R (Examples): PDF, CDF & Quantile Function (Statistics Globe)](https://statisticsglobe.com/probability-distributions-in-r)
- [Basic Probability Distributions in R (Greg Graham)](https://rstudio-pubs-static.s3.amazonaws.com/100906_8e3a32dd11c14b839468db756cee7400.html)


- As fun√ß√µes relacionadas a distribui√ß√µes s√£o dadas por `<prefixo><nome da distribui√ß√£o>`
- Existem 4 prefixos que indicam qual a√ß√£o ser√° realizada:
    - `d`: retorna uma probabilidade a partir de uma fun√ß√£o de densidade de probabilidade (pdf)
    - `p`: retorna uma probabilidade acumulada a partir de uma fun√ß√£o de distribui√ß√£o acumulada (cdf)
    - `q`: retorna uma estat√≠stica da distribui√ß√£o (quantil) dada uma probabilidade acumulada
    - `r`: gera n√∫meros aleat√≥rios dada a distribui√ß√£o
- Existem diversas distribui√ß√µes dispon√≠veis no R:
    - `norm`: Normal
    - `bern`: Bernoulli (pacote `Rlab`)
    - `binom`: Binomial
    - `pois`: Poisson
    - `chisq`: Qui-Quadrado ({{<math>}}$\chi^2${{</math>}})
    - `t`: t-Student
    - `f`: F
    - `unif`: Uniforme
    - `weibull`: Weibull
    - `gamma`: Gamma
    - `logis`: Log√≠stica
    - `exp`: Exponencial
- Seguem as principais distribui√ß√µes e suas respectivas fun√ß√µes:

| **Distribui√ß√£o**   | **Densidade de Probabilidade** | **Distribui√ß√£o Acumulada** | **Quantil**             |
|--------------------|--------------------------------|----------------------------|-------------------------|
| Normal             | `dnorm(x, mean, sd)`           | `pnorm(q, mean, sd)`       | `qnorm(p, mean, sd)`    |
| Qui-Quadrado       | `dchisq(x, df)`                | `pchisq(q, df)`            | `qchisq(p, df)`         |
| t-Student          | `dt(x, df)`                    | `pt(q, df)`                | `qt(p, df)`             |
| F                  | `df(x, df1, df2)`              | `pf(q, df1, df2)`          | `qf(p, df1, df2)`       |
| Binomial           | `dbinom(x, size, prob)`        | `pbinom(q, size, prob)`    | `qbinom(p, size, prob)` |

em que `x` e `q` s√£o estat√≠sticas de cada distribui√ß√£o (quantis), e `p` √© probabilidade.


### Distribui√ß√£o Normal
- Considere uma normal padr√£o, {{<math>}}$N(\mu=0, \sigma=1)${{</math>}}, e escores padr√£o {{<math>}}$Z=-1,96 \text{ e } 1,96${{</math>}} (para intervalo de confian√ßa de {{<math>}}$\approx 5\%${{</math>}}):

<center><img src="../standard-normal-distribution-with-critical-values.webp"></center>

- [`d`]: Densidade a partir de uma pdf, dada estat√≠stica (escore padr√£o):
```{r}
dnorm(1.96, mean=0, sd=1) # probabilidade para escore padr√£o de 1,96
dnorm(-1.96, mean=0, sd=1) # probabilidade para escore padr√£o de -1,96
```

- [`p`]: Probabilidade acumulada a partir de uma cdf, dada estat√≠stica (escore padr√£o):
```{r}
pnorm(1.96, mean=0, sd=1) # probabilidade acumulada para escore padr√£o de 1,96
pnorm(-1.96, mean=0, sd=1) # probabilidade acumulada para escore padr√£o de -1,96
```

Logo, a probabilidade de que uma vari√°vel aleat√≥ria com distribui√ß√£o normal padr√£o esteja com valor entre -1,96 e 1,96 √© de 95\%
```{r}
pnorm(1.96, mean=0, sd=1) - pnorm(-1.96, mean=0, sd=1)
```


- [`q`]: Estat√≠stica (escore padr√£o) a partir de um quantil:
```{r}
qnorm(0.975, mean=0, sd=1) # quantil dada o quantil de 97,5%
qnorm(0.025, mean=0, sd=1) # quantil dada o quantil de 2,5%
```

Podemos criar gr√°ficos usando a fun√ß√£o `curve( function(x), from, to )`, na qual inserimos uma fun√ß√£o com um `x` arbitr√°rio e seus limites m√≠nimo e m√°ximo (`from` e `to`):
```{r}
# pdf de normal padr√£o com estat√≠stica (escore padr√£o) no intervalo -3 e 3
curve(dnorm(x, mean=0, sd=1), from=-3, to=3)

# cdf de normal padr√£o com estat√≠stica (escore padr√£o) no intervalo -3 e 3
curve(pnorm(x, mean=0, sd=1), from=-3, to=3)

# quantil de normal padr√£o com probabilidade acumulada no intervalo 0 e 1
curve(qnorm(x, mean=0, sd=1), from=0, to=1)
```


### Distribui√ß√£o t-Student
- Criaremos gr√°ficos com diversos graus de liberdade
- Quanto maior os graus de liberdade, mais se aproxima de uma normal padr√£o

```{r}
curve(dnorm(x, mean=0, sd=1), from=-3, to=3, pch=".") # pdf normal padr√£o

for (n in c(1, 2, 4, 6, 10)) {
    curve(dt(x, df=n), from=-3, to=3, col=n, add=T) # pdf t-student
}
```



### Distribui√ß√£o Qui-Quadrado
- Criaremos gr√°ficos com diversos graus de liberdade

```{r}
curve(dchisq(x, df=1), from=0, to=6, col=n) # pdf qui-quadrado

for (n in c(2:5)) {
    curve(dchisq(x, df=n), from=0, to=6, col=n, add=T) # pdf qui-quadrado
}
```



### Distribui√ß√£o F
- Criaremos gr√°ficos com diversos graus de liberdade

```{r}
curve(df(x, df1=1, df2=1), from=0, to=6, col=n) # pdf F

for (n in c(2:5)) {
    curve(df(x, df1=n, df2=n), from=0, to=6, col=n, add=T) # pdf F
}
```


</br>

## Simula√ß√£o

### Gera√ß√£o de n√∫meros aleat√≥rios
- [Simulation - Random sampling (John Hopkins/Coursera)](https://www.coursera.org/learn/r-programming/lecture/ykXUb/simulation-random-sampling)
- Para gerar n√∫meros aleat√≥rios, usaremos o prefixo `r` junto de uma distribui√ß√£o.
```{r}
rnorm(5) # gerando 5 n√∫meros aleat√≥rios
```

- Para reproduzir resultados que usem n√∫meros aleat√≥rios, podemos definir "sementes" usando a fun√ß√£o `set.seed()` e informando um n√∫mero inteiro. Isso tamb√©m √© v√°lido para a fun√ß√£o `sample()`.
```{r}
# definindo seed
set.seed(2022)
rnorm(5)

# sem definir seed
rnorm(5)

# definindo seed
set.seed(2022)
rnorm(5)
```


#### Exemplo: Cria√ß√£o de observa√ß√µes x e y

Vamos criar observa√ß√µes da vari√°vel {{<math>}}$x${{</math>}} a partir de uma distribui√ß√£o uniforme no intervalo [0, 10]:
```{r}
N = 100 # n√∫mero de observa√ß√µes
x = runif(N, 0, 10) # n¬∫ aleat√≥rios a partir de U[0,10]
head(x)
```

Agora, vamos criar a vari√°vel {{<math>}}$y = 10 - 2x + \varepsilon, \ \varepsilon \sim N(0, 3^2)${{</math>}} e plotar ambas vari√°veis em um scatterplot:
```{r}
e = rnorm(N, mean=0, sd=3)
y = 10 - 2*x + e
plot(x, y) ## scatterplot entre x e y
abline(a=10, b=-2, col="red")
```

</br>

### Amostragem aleat√≥ria
- Para fazer uma amostragem a partir de um dado vetor, usamos a fun√ß√£o `sample()`
```yaml
sample(x, size, replace = FALSE, prob = NULL)

x: either a vector of one or more elements from which to choose, or a positive integer. See ‚ÄòDetails.‚Äô
n: a positive number, the number of items to choose from.
size: a non-negative integer giving the number of items to choose.
replace: should sampling be with replacement?
prob: a vector of probability weights for obtaining the elements of the vector being sampled.
```
```{r}
sample(letters, 5) # Amostragem de 5 letras

sample(1:10, 4) # Amostragem de 4 n√∫meros de 1 a 10

sample(1:10) # Permuta√ß√£o (amostra mesma qtd de elementos do vetor)

sample(1:10, replace = TRUE) # Amostragem com reposi√ß√£o
```
- Note que, por padr√£o, a fun√ß√£o `sample()` faz a amostragem sem reposi√ß√£o.


#### Exemplo: Lei dos Grandes N√∫meros (LGN)
- Podemos usar a amostragem para simular jogadas de dado n√£o-viesado.
- Vamos jogar uma vez o dado:
```{r}
sample(1:6, 1) # amostra um n√∫mero dentro do vetor 1:6
```
- Vamos jogar 1000 vezes o dado (usando fun√ß√£o `replicate()`) e verificar sua distribui√ß√£o:
```{r}
amostra = replicate(1000, expr=sample(1:6, 1))
table(amostra) # tabela com contagem das jogadas

# Gr√°fico
plot(table(amostra), type="h")
```
- Note que n√£o podemos usar a fun√ß√£o `rep()` com simula√ß√£o, pois ele sortearia um n√∫mero e replicaria esse mesmo n√∫mero 1000 vezes.
- Agora, vamos jogar 2 vezes o dado e fazer a m√©dia entre eles
```{r}
mean(sample(1:6, 2))
```
- Fazendo isso 1000 vezes, temos:
```{r}
amostra = replicate(1000, mean(sample(1:6, 2, replace=T)))
table(amostra) # tabela com contagem das m√©dias de 2 jogadas

# Gr√°fico
plot(table(amostra), type="h")
```

- Note que, ao repetir 1000 vezes, o c√°lculo da m√©dia de 2 jogadas de dado, come√ßou a dar mais peso para m√©dias pr√≥ximas √† m√©dia populacional (3,5), mas ainda tem densidade nos valores mais extremos (1 e 6)
- Foi necess√°rio usar o argumento `replace=TRUE` para ter "reposi√ß√£o" dos n√∫meros do dado
- Calculando 1000 vezes a m√©dia de {{<math>}}$N=100${{</math>}} jogadas de dado, temos:
```{r}
N = 100 # n¬∫ de observa√ß√µes
amostra = replicate(1000, mean(sample(1:6, N, replace=T)))

# Gr√°fico
plot(table(amostra), type="h", xlim=c(1,6))
```

- Note que, quanto maior {{<math>}}$N${{</math>}}, a distribui√ß√£o das m√©dias vai se degenerando, tendo maior concentra√ß√£o na proximidade da m√©dia populacional (3,5), e sendo praticamente nula em m√©dias mais distantes.



<!-- </br> -->

<!-- ## Intervalos de Confian√ßa -->
<!-- - [Subse√ß√£o 1.8.1 de Heiss (2020)](http://www.urfie.net/read/index.html#page/71) -->
<!-- - No Ap√™ndice C.5 de Wooldridge (2006, em portugu√™s), s√£o constru√≠dos intervalos de confian√ßa de 95\%. -->
<!-- - Para uma popula√ß√£o normalmente distribu√≠da com m√©dia {{<math>}}$\mu${{</math>}} e vari√¢ncia {{<math>}}$\sigma^2${{</math>}}, o intervalo de confian√ßa com signific√¢ncia de $\alpha$ √© dado por: -->

<!-- $$ \text{IC}_\alpha = \left[\bar{y} - C_{\alpha/2}.se(\bar{y}),\quad \bar{y} + C_{\alpha/2}.se(\bar{y})\right] \tag{1.2} $$ -->
<!-- em que: -->

<!-- - {{<math>}}$\bar{y}${{</math>}}: m√©dia amostral -->
<!-- - {{<math>}}$se(\bar{y}) = \frac{s}{\sqrt{n}}${{</math>}}: erro padr√£o de {{<math>}}$\bar{y}${{</math>}} -->
<!-- - {{<math>}}$s${{</math>}}: desvio padr√£o de {{<math>}}$\bar{y}${{</math>}} -->
<!-- - {{<math>}}$n${{</math>}}: tamanho da amostra -->
<!-- - {{<math>}}$C_{\alpha/2}${{</math>}}: √© o valor cr√≠tico do quantil de {{<math>}}$(1-\alpha/2)${{</math>}} da distribui√ß√£o {{<math>}}$t_{n-1}${{</math>}}. -->
<!--     - Por exemplo, para {{<math>}}$\alpha = 5\%${{</math>}}, usa-se o quantil 97,5\% ({{<math>}}$= 1 - 5\%/2${{</math>}}). -->
<!--     - Quando o n√∫mero de graus de liberdade √© grande, a distribui√ß√£o _t_ se aproxima ao de uma normal padr√£o. Logo, para um intervalo de confian√ßa de 95\%, o valor cr√≠tico √© {{<math>}}$C_{2,5\%} \approx 1,96${{</math>}} -->


<!-- #### Exemplo C.2: Efeito de subs√≠dios de treinamento corporativo sobre a produtividade do trabalhador  (Wooldridge, 2006) -->

<!-- - Holzer, Block, Cheatham e Knott (1993) estudaram os efeitos de subs√≠dios de treinamentos corporativos sobre a produtividade dos trabalhadores -->
<!-- - Para isto, avaliou-se a "taxa de refugo", isto √©, a quantidade de itens descartados a cada 100 itens produzidos. -->
<!-- - Entre 1987 e 1988, houve treinamento corporativo em 20 empresas e queremos saber se ele teve efeito sobre a taxa de refugo, ou seja, a diferen√ßa entre as m√©dias dos anos foi estatisticamente significante (diferente de 0). -->
<!-- - Comecemos criando vetores de taxa de refugos das 20 empresas para os anos de 1987 (_SR87_) e de 1988 (_SR88_): -->
<!-- ```{r} -->
<!-- SR87 = c(10, 1, 6, .45, 1.25, 1.3, 1.06, 3, 8.18, 1.67, .98, -->
<!--          1, .45, 5.03, 8, 9, 18, .28, 7, 3.97) -->
<!-- SR88 = c(3, 1, 5, .5, 1.54, 1.5, .8, 2, .67, 1.17, .51, .5,  -->
<!--          .61, 6.7, 4, 7, 19, .2, 5, 3.83) -->
<!-- ``` -->
<!-- - Criando o vetor das varia√ß√µes das taxas de refugo e extraindo estat√≠sticas: -->
<!-- ```{r} -->
<!-- Change = SR88 - SR87 # vetor de varia√ß√µes -->
<!-- n = length(Change) # quantidade de empresas/tamanho do vetor Variacao -->
<!-- avgChange = mean(Change) # m√©dia do vetor Variacao -->
<!-- sdChange = sd(Change) # desvio padr√£o do vetor Variacao -->
<!-- ``` -->
<!-- - Calculando o erro padr√£o e o valor cr√≠tico para intervalo de confian√ßa de 95\%: -->
<!-- ```{r} -->
<!-- se = sdChange / sqrt(n) # erro padr√£o -->
<!-- CV = qt(.975, n-1) # valor cr√≠tico para intervalo de confian√ßa de 95% -->
<!-- ``` -->
<!-- - Finalmente, calcula-se o intervalo de confian√ßa usando (1.2) -->
<!-- ```{r} -->
<!-- c(avgChange - CV*se, avgChange + CV*se) # limites inferior e superior do intervalo -->

<!-- # tamb√©m poder√≠amos escrever o intervalo mais sucintamente: -->
<!-- avgChange + CV * c(-se, se) -->
<!-- ``` -->
<!-- - Note que o valor 0 est√° fora do intervalo de confian√ßa de 95\% e, portanto, conclui-se que houve altera√ß√£o na taxa de refugo (houve efeito negativo estatisticamente significante). -->


<!-- </br> -->

<!-- ## Teste _t_ e p-valores -->
<!-- - [Subse√ß√µes 1.8.2 e 1.8.3 de Heiss (2020)](http://www.urfie.net/read/index.html#page/74) -->

<!-- - A estat√≠stica _t_ para testar uma hip√≥tese sobre uma vari√°vel aleat√≥ria {{<math>}}$y${{</math>}} normalmente distribu√≠da com m√©dia {{<math>}}$\bar{y}${{</math>}} √© dado pela equa√ß√£o C.35 (Wooldridge, 2006). Dada a hip√≥tese nula {{<math>}}$H_0: \bar{y} = \mu_0${{</math>}}, -->
<!-- $$ t = \frac{\bar{y} - \mu_0}{se(\bar{y})}. \tag{1.3} $$ -->

<!-- - Para rejeitarmos a hip√≥tese nula, o m√≥dulo da estat√≠stica _t_ precisa ser maior do que o valor cr√≠tico, dado um n√≠vel de signific√¢ncia {{<math>}}$\alpha${{</math>}}. -->
<!-- - Por exemplo, ao n√≠vel de signific√¢ncia {{<math>}}$\alpha = 5\%${{</math>}} e com uma grande amostra (e, portanto, a distribui√ß√£o _t_ se aproxima a de uma normal padr√£o), rejeitamos a hip√≥tese nula se -->
<!-- $$ |t| \ge 1,96 \approx \text{valor cr√≠tico ao n√≠vel de signific√¢ncia de 5%} $$ -->

<!-- - A vantagem de utilizar o p-valor √© a sua conveni√™ncia, pois pode-se compar√°-lo diretamente com o n√≠vel de signific√¢ncia. -->
<!-- - Para testes _t_ bicaudais, a f√≥rmula do p-valor √© dado por (Wooldridge, 2006, equa√ß√£o C.42): -->
<!-- $$ p = 2.Pr(T_{n-1} > |t|) = 2.[1 - F_{t_{n-1}}(|t|)] $$ -->
<!-- em que {{<math>}}$F_{t_{n-1}}(\cdot)${{</math>}} √© a cdf da distribui√ß√£o {{<math>}}$t_{n-1}${{</math>}}. -->

<!-- <center><img src="../t-student_test.png"></center> -->

<!-- - Rejeitamos a hip√≥tese nula se o p-valor for menor do que o n√≠vel de signific√¢ncia {{<math>}}$\alpha${{</math>}}. -->


<!-- #### Exemplo C.6: Efeito de subs√≠dios de treinamento corporativo sobre a produtividade do trabalhador  (Wooldridge, 2006) -->
<!-- - Continua√ß√£o do exemplo C.2 -->
<!-- - Considerando teste bicaudal (diferente dos livros), podemos calcular a estat√≠stica _t_ -->
<!-- ```{r} -->
<!-- # Estat√≠stica t para H0: mu = 0 -->
<!-- t = (avgChange - 0) / se -->
<!-- print(paste0("estat√≠stica t = ", abs(t), " > ", CV, " = valor cr√≠tico")) -->
<!-- ``` -->
<!-- - Como estat√≠stica _t_ √© maior do que o valor cr√≠tico, rejeitamos {{<math>}}$H_0${{</math>}} a n√≠vel de signific√¢ncia de 5\%. -->
<!-- - De forma equivalente, podemos calcular o p-valor: -->
<!-- ```{r} -->
<!-- p = 2 * (1 - pt(abs(t), n-1)) -->
<!-- print(paste0("p-valor = ", p, " < 0.05 = n√≠vel de signific√¢ncia")) -->
<!-- ``` -->
<!-- - Como o p-valor √© maior do que {{<math>}}$\alpha = 5\%${{</math>}}, rejeitamos {{<math>}}$H_0${{</math>}}. -->


<!-- ### C√°lculos via `t.test()` -->
<!-- ```yaml -->
<!-- t.test(x, y = NULL, -->
<!--        alternative = c("two.sided", "less", "greater"), -->
<!--        mu = 0, paired = FALSE, var.equal = FALSE, -->
<!--        conf.level = 0.95, ...) -->

<!-- - x: (non-empty) numeric vector of data values. -->
<!-- - alternative: a character string specifying the alternative hypothesis, must be one of "two.sided" (default), "greater" or "less". You can specify just the initial letter. -->
<!-- - mu: a number indicating the true value of the mean (or difference in means if you are performing a two sample test). -->
<!-- - conf.level: confidence level of the interval. -->
<!-- ``` -->
<!-- - Note que incluiremos um vetor de valor no argmento `x` e, por padr√£o, a fun√ß√£o considera um teste bicaudal, testando a {{<math>}}$H_0${{</math>}} se m√©dia verdadeira √© igual a zero e com intervalo de confian√ßa de 95\%. -->
<!-- - Retornando aos exemplos C.2 e C.6 ("Efeito de subs√≠dios de treinamento corporativo sobre a produtividade"), temos: -->
<!-- ```{r} -->
<!-- testresults = t.test(Change, mu = 0) -->
<!-- testresults -->
<!-- ``` -->
<!-- - Dentro do objeto de resultado do teste, temos as seguintes informa√ß√µes: -->
<!-- ```{r} -->
<!-- names(testresults) -->
<!-- ``` -->
<!-- - Podemos, por exemplo, acessar o p-valor usando: -->
<!-- ```{r} -->
<!-- testresults$p.value -->
<!-- ``` -->

</br>

{{< cta cta_text="üëâ Proceed to Simple Regression" cta_link="../sec7" >}}
